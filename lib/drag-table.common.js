module.exports =
/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "fae3");
/******/ })
/************************************************************************/
/******/ ({

/***/ "0599":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_TableCom_vue_vue_type_style_index_0_id_7a5dd938_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("a663");
/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_TableCom_vue_vue_type_style_index_0_id_7a5dd938_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_TableCom_vue_vue_type_style_index_0_id_7a5dd938_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0__);
/* unused harmony reexport * */
 /* unused harmony default export */ var _unused_webpack_default_export = (_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_TableCom_vue_vue_type_style_index_0_id_7a5dd938_scoped_true_lang_css___WEBPACK_IMPORTED_MODULE_0___default.a); 

/***/ }),

/***/ "1eb2":
/***/ (function(module, exports, __webpack_require__) {

// This file is imported into lib/wc client bundles.

if (typeof window !== 'undefined') {
  var i
  if ((i = window.document.currentScript) && (i = i.src.match(/(.+\/)[^/]+\.js$/))) {
    __webpack_require__.p = i[1] // eslint-disable-line
  }
}


/***/ }),

/***/ "26e6":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_TableListCom_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("9b13");
/* harmony import */ var _node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_TableListCom_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_TableListCom_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0__);
/* unused harmony reexport * */
 /* unused harmony default export */ var _unused_webpack_default_export = (_node_modules_mini_css_extract_plugin_dist_loader_js_ref_6_oneOf_1_0_node_modules_css_loader_index_js_ref_6_oneOf_1_1_node_modules_vue_loader_lib_loaders_stylePostLoader_js_node_modules_postcss_loader_lib_index_js_ref_6_oneOf_1_2_node_modules_cache_loader_dist_cjs_js_ref_0_0_node_modules_vue_loader_lib_index_js_vue_loader_options_TableListCom_vue_vue_type_style_index_0_lang_css___WEBPACK_IMPORTED_MODULE_0___default.a); 

/***/ }),

/***/ "65d9":
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/**
  * vue-class-component v6.2.0
  * (c) 2015-present Evan You
  * @license MIT
  */


Object.defineProperty(exports, '__esModule', { value: true });

function _interopDefault (ex) { return (ex && (typeof ex === 'object') && 'default' in ex) ? ex['default'] : ex; }

var Vue = _interopDefault(__webpack_require__("8bbf"));

var hasProto = { __proto__: [] } instanceof Array;
function createDecorator(factory) {
    return function (target, key, index) {
        var Ctor = typeof target === 'function'
            ? target
            : target.constructor;
        if (!Ctor.__decorators__) {
            Ctor.__decorators__ = [];
        }
        if (typeof index !== 'number') {
            index = undefined;
        }
        Ctor.__decorators__.push(function (options) { return factory(options, key, index); });
    };
}
function mixins() {
    var Ctors = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        Ctors[_i] = arguments[_i];
    }
    return Vue.extend({ mixins: Ctors });
}
function isPrimitive(value) {
    var type = typeof value;
    return value == null || (type !== "object" && type !== "function");
}
function warn(message) {
    if (typeof console !== 'undefined') {
        console.warn('[vue-class-component] ' + message);
    }
}

function collectDataFromConstructor(vm, Component) {
    // override _init to prevent to init as Vue instance
    var originalInit = Component.prototype._init;
    Component.prototype._init = function () {
        var _this = this;
        // proxy to actual vm
        var keys = Object.getOwnPropertyNames(vm);
        // 2.2.0 compat (props are no longer exposed as self properties)
        if (vm.$options.props) {
            for (var key in vm.$options.props) {
                if (!vm.hasOwnProperty(key)) {
                    keys.push(key);
                }
            }
        }
        keys.forEach(function (key) {
            if (key.charAt(0) !== '_') {
                Object.defineProperty(_this, key, {
                    get: function () { return vm[key]; },
                    set: function (value) { return vm[key] = value; },
                    configurable: true
                });
            }
        });
    };
    // should be acquired class property values
    var data = new Component();
    // restore original _init to avoid memory leak (#209)
    Component.prototype._init = originalInit;
    // create plain data object
    var plainData = {};
    Object.keys(data).forEach(function (key) {
        if (data[key] !== undefined) {
            plainData[key] = data[key];
        }
    });
    if (false) {}
    return plainData;
}

var $internalHooks = [
    'data',
    'beforeCreate',
    'created',
    'beforeMount',
    'mounted',
    'beforeDestroy',
    'destroyed',
    'beforeUpdate',
    'updated',
    'activated',
    'deactivated',
    'render',
    'errorCaptured' // 2.5
];
function componentFactory(Component, options) {
    if (options === void 0) { options = {}; }
    options.name = options.name || Component._componentTag || Component.name;
    // prototype props.
    var proto = Component.prototype;
    Object.getOwnPropertyNames(proto).forEach(function (key) {
        if (key === 'constructor') {
            return;
        }
        // hooks
        if ($internalHooks.indexOf(key) > -1) {
            options[key] = proto[key];
            return;
        }
        var descriptor = Object.getOwnPropertyDescriptor(proto, key);
        if (typeof descriptor.value === 'function') {
            // methods
            (options.methods || (options.methods = {}))[key] = descriptor.value;
        }
        else if (descriptor.get || descriptor.set) {
            // computed properties
            (options.computed || (options.computed = {}))[key] = {
                get: descriptor.get,
                set: descriptor.set
            };
        }
    });
    (options.mixins || (options.mixins = [])).push({
        data: function () {
            return collectDataFromConstructor(this, Component);
        }
    });
    // decorate options
    var decorators = Component.__decorators__;
    if (decorators) {
        decorators.forEach(function (fn) { return fn(options); });
        delete Component.__decorators__;
    }
    // find super
    var superProto = Object.getPrototypeOf(Component.prototype);
    var Super = superProto instanceof Vue
        ? superProto.constructor
        : Vue;
    var Extended = Super.extend(options);
    forwardStaticMembers(Extended, Component, Super);
    return Extended;
}
var reservedPropertyNames = [
    // Unique id
    'cid',
    // Super Vue constructor
    'super',
    // Component options that will be used by the component
    'options',
    'superOptions',
    'extendOptions',
    'sealedOptions',
    // Private assets
    'component',
    'directive',
    'filter'
];
function forwardStaticMembers(Extended, Original, Super) {
    // We have to use getOwnPropertyNames since Babel registers methods as non-enumerable
    Object.getOwnPropertyNames(Original).forEach(function (key) {
        // `prototype` should not be overwritten
        if (key === 'prototype') {
            return;
        }
        // Some browsers does not allow reconfigure built-in properties
        var extendedDescriptor = Object.getOwnPropertyDescriptor(Extended, key);
        if (extendedDescriptor && !extendedDescriptor.configurable) {
            return;
        }
        var descriptor = Object.getOwnPropertyDescriptor(Original, key);
        // If the user agent does not support `__proto__` or its family (IE <= 10),
        // the sub class properties may be inherited properties from the super class in TypeScript.
        // We need to exclude such properties to prevent to overwrite
        // the component options object which stored on the extended constructor (See #192).
        // If the value is a referenced value (object or function),
        // we can check equality of them and exclude it if they have the same reference.
        // If it is a primitive value, it will be forwarded for safety.
        if (!hasProto) {
            // Only `cid` is explicitly exluded from property forwarding
            // because we cannot detect whether it is a inherited property or not
            // on the no `__proto__` environment even though the property is reserved.
            if (key === 'cid') {
                return;
            }
            var superDescriptor = Object.getOwnPropertyDescriptor(Super, key);
            if (!isPrimitive(descriptor.value)
                && superDescriptor
                && superDescriptor.value === descriptor.value) {
                return;
            }
        }
        // Warn if the users manually declare reserved properties
        if (false) {}
        Object.defineProperty(Extended, key, descriptor);
    });
}

function Component(options) {
    if (typeof options === 'function') {
        return componentFactory(options);
    }
    return function (Component) {
        return componentFactory(Component, options);
    };
}
(function (Component) {
    function registerHooks(keys) {
        $internalHooks.push.apply($internalHooks, keys);
    }
    Component.registerHooks = registerHooks;
})(Component || (Component = {}));
var Component$1 = Component;

exports.default = Component$1;
exports.createDecorator = createDecorator;
exports.mixins = mixins;


/***/ }),

/***/ "8bbf":
/***/ (function(module, exports) {

module.exports = require("vue");

/***/ }),

/***/ "9b13":
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin

/***/ }),

/***/ "a663":
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin

/***/ }),

/***/ "fae3":
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);

// EXTERNAL MODULE: ./node_modules/@vue/cli-service/lib/commands/build/setPublicPath.js
var setPublicPath = __webpack_require__("1eb2");

// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules//.cache//vue-loader","cacheIdentifier":"2d1472b6-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--0-0!./node_modules/vue-loader/lib??vue-loader-options!./packages/drag-table2.0/views/TableCom.vue?vue&type=template&id=7a5dd938&scoped=true&
var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return (_vm.myTable)?_c('div',{staticStyle:{"position":"relative","float":"left","overflow":"hidden"},on:{"keydown":function($event){_vm.myTable.onKeyDown($event)},"keyup":function($event){_vm.myTable.onKeyUp($event)}}},[(_vm.myTable.config.hasLeftFixedTable && _vm.myTable.config.hasTopFixedTable)?_c('div',{staticClass:"fix-top-left-table"},[(_vm.myTable && _vm.myTable.rowNumber[0] && _vm.myTable.colNumber[0])?_c('table',{staticClass:"my-table left-table",attrs:{"cellspacing":"0","cellpadding":"0","border":"0"}},[_c('thead',[(_vm.myTable.config.isShowColIndex && _vm.myTable.config.isShowRowIndex)?_c('tr',[_c('th',{staticClass:"rowNumber",style:({padding:_vm.myTable.rowNumber[0].style.padding,background:_vm.myTable.rowNumber[0].style.background})},[_c('div',{style:({width:_vm.myTable.rowNumber[0].style.width, height:_vm.myTable.colNumber[0].style.height})},[_vm._v("\n              "+_vm._s(_vm.myTable.config.debugLevel === 1 ?_vm.myTable.id:'')+"\n            ")])]),_vm._l((_vm.myTable.theadLeftEntity.leafIndexList2),function(th,i){return _c('th',{staticClass:"colNumber",style:(_vm.myTable.colNumber[i].style)},[_c('div',{style:(_vm.myTable.colNumber[i].cell.style)},[_vm._v("\n              "+_vm._s(_vm.myTable.colNumber[i].cell.content)+"\n            ")])])})],2):_vm._e(),_vm._l((_vm.myTable.tableHeadTop),function(tr,i){return (_vm.myTable.config.isShowRowIndex)?_c('tr',{key:tr+i},[_c('th',{staticClass:"rowNumber",style:(_vm.myTable.rowNumber[i].style),on:{"dragover":function($event){_vm.myTable.dragOver($event)},"drop":function($event){_vm.myTable.drop($event,_vm.myTable.rowNumber[i])},"mousedown":function($event){_vm.myTable.rowNumber[i].onMouseDown($event)},"mouseout":function($event){_vm.myTable.rowNumber[i].onMouseOut($event)},"mousemove":function($event){_vm.myTable.rowNumber[i].onMouseMove($event)}}},[_c('div',{style:([_vm.myTable.rowNumber[i].cell.style]),attrs:{"title":_vm.myTable.rowNumber[i].cell.content}},[_vm._v(_vm._s(_vm.myTable.rowNumber[i].cell.content))])]),(i===0&&_vm.myTable.tableHeadLeft[0]&&_vm.myTable.tableHeadTop[0])?_c('th',{staticClass:"colNumber",staticStyle:{"border-width":"1px"},style:(_vm.myTable.tableHeadTopLeft.style),attrs:{"colspan":_vm.myTable.theadLeftEntity.side2,"rowspan":_vm.myTable.tableHeadTop.length}},[_c('div',{style:(_vm.myTable.tableHeadTopLeft.cell.style)},[_vm._v("\n              "+_vm._s(_vm.myTable.config.topleftShowTableName ? _vm.myTable.tableHeadTopLeft.cell.content:'')+"\n            ")])]):_vm._e()]):_vm._e()})],2)]):_vm._e()]):_vm._e(),(_vm.myTable.config.hasLeftFixedTable)?_c('div',{staticClass:"fix-left-table",style:(_vm.myTable.style.leftTable),domProps:{"scrollTop":_vm.myTable.style.scrollTop}},[(_vm.myTable && _vm.myTable.rowNumber[0] && _vm.myTable.colNumber[0])?_c('table',{staticClass:"my-table left-table"},[_c('thead',[(_vm.myTable.config.isShowColIndex)?_c('tr',[_c('th',{staticClass:"rowNumber",style:({padding:(_vm.myTable.rowNumber[0]||_vm.myTable.colNumber[0]||{}).style.padding,background:(_vm.myTable.rowNumber[0]||_vm.myTable.colNumber[0]||{}).style.background})},[_c('div',{style:({width:_vm.myTable.rowNumber[0].style.width,height:_vm.myTable.colNumber[0].style.height})})]),_vm._l((_vm.myTable.theadLeftEntity.leafIndexList2),function(th,i){return _c('th',{staticClass:"colNumber",style:(_vm.myTable.colNumber[i].style)},[_c('div',{style:(_vm.myTable.colNumber[i].cell.style)},[_vm._v("\n              "+_vm._s(_vm.myTable.colNumber[i].cell.content)+"\n            ")])])})],2):_vm._e(),_vm._l((_vm.myTable.rowNumber),function(th,i){return _c('tr',{key:"row"+i},[(_vm.myTable.config.isShowRowIndex)?_c('th',{staticClass:"rowNumber",style:(th.style),attrs:{"tabindex":"0"},on:{"mousedown":function($event){th.onMouseDown($event)},"mouseout":function($event){th.onMouseOut($event)},"mousemove":function($event){th.onMouseMove($event)},"click":function($event){th.onClick($event)},"dragover":function($event){_vm.myTable.dragOver($event,th)},"drop":function($event){_vm.myTable.drop($event,th)}}},[_c('div',{style:([th.cell.style]),attrs:{"title":th.cell.content}},[_vm._v(_vm._s(th.cell.content))])]):_vm._e(),(i===0&&_vm.myTable.tableHeadLeft[0])?_c('th',{staticClass:"colNumber",style:(_vm.myTable.tableHeadTopLeft.style),attrs:{"colspan":_vm.myTable.theadLeftEntity.side2,"rowspan":_vm.myTable.tableHeadTop.length}},[_c('div',{style:(_vm.myTable.tableHeadTopLeft.cell.style)},[_vm._v("\n              "+_vm._s(_vm.myTable.config.topleftShowTableName ? _vm.myTable.tableHeadTopLeft.cell.content:'')+"\n            ")])]):_vm._e(),_vm._l((_vm.myTable.tableHeadLeft[i - _vm.myTable.theadTopEntity.side2]),function(th,j){return _c('th',{key:th+j,style:([th.style]),attrs:{"tabindex":"1","draggable":th.draggable,"colspan":th.span2,"rowspan":th.span1},on:{"click":function($event){th.onClick($event)},"blur":function($event){th.onBlur($event)},"dragstart":function($event){_vm.myTable.dragStart($event,th)},"dragover":function($event){_vm.myTable.dragOver($event,th)},"drop":function($event){_vm.myTable.drop($event,th)},"dragleave":function($event){_vm.myTable.dragLeave($event,th)},"mousedown":function($event){th.onMouseDown($event)},"mousemove":function($event){th.onMouseMove($event)},"mouseout":function($event){th.onMouseOut($event)}}},[(th.cell.displayClass[th.cell.status].displayType == 'text')?_c('div',{style:([th.cell.style]),on:{"dblclick":function($event){th.cell.onDbClick()}}},[_vm._v("\n              "+_vm._s(th.cell.content)+"\n            ")]):_vm._e(),(th.cell.displayClass[th.cell.status].displayType == 'input')?_c('input',{directives:[{name:"model",rawName:"v-model",value:(th.cell.value),expression:"th.cell.value"}],staticStyle:{"background-color":"#fff"},style:([th.cell.style]),domProps:{"value":(th.cell.value)},on:{"mouseover":function($event){th.cell.onMouseOver($event)},"blur":function($event){th.cell.inputOnBlur($event,true)},"input":function($event){if($event.target.composing){ return; }_vm.$set(th.cell, "value", $event.target.value)}}}):_vm._e(),(th.cell.displayClass[th.cell.status].displayType == 'button')?_c('button',{style:([th.cell.style]),on:{"click":function($event){th.cell.click($event)}}},[_vm._v(_vm._s(th.cell.content))]):_vm._e(),(th.cell.displayClass[th.cell.status].displayType == 'select')?_c('select',{directives:[{name:"model",rawName:"v-model",value:(th.cell.value),expression:"th.cell.value"}],style:([th.cell.style]),attrs:{"tabindex":"1"},on:{"change":[function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = "_value" in o ? o._value : o.value;return val}); _vm.$set(th.cell, "value", $event.target.multiple ? $$selectedVal : $$selectedVal[0])},function($event){th.cell.onChange($event)}],"blur":function($event){th.cell.onBlur($event)}}},_vm._l((th.cell.select.optionList),function(option){return _c('option',{key:option.value,domProps:{"value":option.text}},[_vm._v(_vm._s(option.text))])})):_vm._e()])})],2)})],2)]):_vm._e()]):_vm._e(),(_vm.myTable.config.hasTopFixedTable)?_c('div',{staticClass:"fix-top-table",style:(_vm.myTable.style.topTable),domProps:{"scrollLeft":_vm.myTable.style.scrollLeft}},[(_vm.myTable && _vm.myTable.rowNumber[0] && _vm.myTable.colNumber[0])?_c('table',{staticClass:"my-table",attrs:{"cellspacing":"0","cellpadding":"0","border":"0"}},[_c('thead',[(_vm.myTable.config.isShowColIndex)?_c('tr',[(_vm.myTable.config.isShowRowIndex)?_c('th',{staticClass:"rowNumber",style:({padding:_vm.myTable.rowNumber[0].style.padding,background:_vm.myTable.rowNumber[0].style.background})},[_c('div',{style:({width:_vm.myTable.rowNumber[0].style.width,height:_vm.myTable.colNumber[0].style.height})})]):_vm._e(),_vm._l((_vm.myTable.colNumber),function(th,i){return _c('th',{key:"col"+i,staticClass:"colNumber",style:(th.style),attrs:{"tabindex":"1"},on:{"mousedown":function($event){th.onMouseDown($event)},"mouseout":function($event){th.onMouseOut($event)},"mousemove":function($event){th.onMouseMove($event)},"click":function($event){th.onClick($event)},"dragover":function($event){_vm.myTable.dragOver($event,th)},"drop":function($event){_vm.myTable.drop($event,th)}}},[_c('div',{style:(th.cell.style)},[_vm._v(_vm._s(th.cell.content))])])})],2):_vm._e(),_vm._l((_vm.myTable.tableHeadTop),function(tr,i){return _c('tr',{key:"tr"+i},[(_vm.myTable.config.isShowRowIndex)?_c('th',{staticClass:"rowNumber",style:(_vm.myTable.rowNumber[i].style)},[_c('div',{style:(_vm.myTable.rowNumber[i].cell.style)})]):_vm._e(),(i===0 && _vm.myTable.tableHeadLeft[0] && _vm.myTable.tableHeadTop[0])?_c('th',{staticClass:"colNumber",style:(_vm.myTable.tableHeadTopLeft.style),attrs:{"colspan":_vm.myTable.theadLeftEntity.side2,"rowspan":_vm.myTable.tableHeadTop.length}},[_c('div',{style:(_vm.myTable.tableHeadTopLeft.cell.style)},[_vm._v("\n              "+_vm._s(_vm.myTable.config.topleftShowTableName ? _vm.myTable.tableHeadTopLeft.cell.content:'')+"\n            ")])]):_vm._e(),_vm._l((tr),function(th,j){return _c('th',{key:th.id +j,staticClass:"top-th",style:(th.style),attrs:{"tabindex":"1","draggable":th.draggable,"colspan":th.span1,"rowspan":th.span2},on:{"blur":function($event){th.onBlur($event)},"click":function($event){th.onClick($event)},"dragstart":function($event){_vm.myTable.dragStart($event,th)},"dragend":function($event){_vm.myTable.dragEnd($event,th)},"dragover":function($event){_vm.myTable.dragOver($event,th)},"drop":function($event){_vm.myTable.drop($event,th)},"dragleave":function($event){_vm.myTable.dragLeave($event,th)},"mousedown":function($event){th.onMouseDown($event)},"mousemove":function($event){th.onMouseMove($event)},"mouseout":function($event){th.onMouseOut($event)}}},[(th.cell.displayClass[th.cell.status].displayType == 'text')?_c('div',{style:([th.cell.style]),attrs:{"title":th.cell.title},on:{"dblclick":function($event){th.cell.onDbClick()}}},[_c('i',[(th.cell.title)?_c('svg',{staticClass:"icon",style:(th.tips.style),attrs:{"t":"1546669133888","viewBox":"0 0 1024 1024","version":"1.1","xmlns":"http://www.w3.org/2000/svg","p-id":"1069"}},[_c('path',{attrs:{"d":"M512 56.888889C261.688889 56.888889 56.888889 261.688889 56.888889 512s204.8 455.111111 455.111111 455.111111 455.111111-204.8 455.111111-455.111111-204.8-455.111111-455.111111-455.111111m0 853.333333c-221.866667 0-398.222222-176.355556-398.222222-398.222222s176.355556-398.222222 398.222222-398.222222 398.222222 176.355556 398.222222 398.222222-176.355556 398.222222-398.222222 398.222222","fill":"#333333","p-id":"1070"}}),_c('path',{attrs:{"d":"M512 682.666667c-17.066667 0-28.444444 5.688889-39.822222 17.066666-11.377778 11.377778-17.066667 22.755556-17.066667 39.822223 0 17.066667 5.688889 28.444444 17.066667 39.822222 11.377778 11.377778 22.755556 17.066667 39.822222 17.066666 17.066667 0 28.444444-5.688889 39.822222-17.066666 11.377778-11.377778 17.066667-22.755556 17.066667-39.822222 0-17.066667-5.688889-28.444444-17.066667-39.822223-11.377778-11.377778-22.755556-17.066667-39.822222-17.066666z m-51.2-455.111111l17.066667 409.6h62.577777L563.2 227.555556H460.8z","fill":"#333333","p-id":"1071"}})]):_vm._e()]),_vm._v("\n\n              "+_vm._s(th.cell.content)+"\n\n            ")]):_vm._e(),(th.cell.displayClass[th.cell.status].displayType == 'input')?_c('input',{directives:[{name:"model",rawName:"v-model",value:(th.cell.value),expression:"th.cell.value"}],style:([th.cell.style]),domProps:{"value":(th.cell.value)},on:{"mouseover":function($event){th.cell.onMouseOver($event)},"blur":function($event){th.cell.inputOnBlur($event,true)},"input":function($event){if($event.target.composing){ return; }_vm.$set(th.cell, "value", $event.target.value)}}}):_vm._e(),(th.cell.displayClass[th.cell.status].displayType == 'button')?_c('button',{style:([th.cell.style]),on:{"click":function($event){th.cell.click($event)}}},[_vm._v(_vm._s(th.cell.content))]):_vm._e()])})],2)})],2)]):_vm._e()]):_vm._e(),_c('div',{staticClass:"main-table",style:(_vm.myTable.style.mainTable),attrs:{"scrollTop":_vm.myTable.style.scrollTop,"id":"div1"},on:{"scroll":function($event){_vm.myTable.onScroll($event)}}},[(_vm.myTable && _vm.myTable.rowNumber[0] && _vm.myTable.colNumber[0])?_c('table',{staticClass:"my-table",attrs:{"cellspacing":"0","cellpadding":"0","border":"0"}},[_c('thead',[(_vm.myTable.config.isShowColIndex)?_c('tr',[(_vm.myTable.config.isShowRowIndex)?_c('th',{staticClass:"rowNumber",style:({width:_vm.myTable.rowNumber[0].style.width,height:_vm.myTable.colNumber[0].style.height})},[_c('div')]):_vm._e(),_vm._l((_vm.myTable.colNumber),function(th,i){return _c('th',{key:"col"+i,staticClass:"colNumber",style:([th.style]),on:{"dragover":function($event){_vm.myTable.dragOver($event,th)},"drop":function($event){_vm.myTable.dropTopA_Z($event)},"mousedown":function($event){th.onMouseDown($event)},"mousemove":function($event){th.onMouseMove($event)},"mouseout":function($event){th.onMouseOut($event)}}},[_c('div',{style:([th.cell.style])},[_vm._v(_vm._s(th.cell.content))])])})],2):_vm._e(),_vm._l((_vm.myTable.tableHeadTop),function(tr,i){return _c('tr',{key:tr+i},[(_vm.myTable.config.isShowRowIndex)?_c('th',{staticClass:"rowNumber",on:{"mousedown":function($event){_vm.myTable.rowNumber[i].onMouseDown($event)},"mousemove":function($event){_vm.myTable.rowNumber[i].onMouseMove($event)},"mouseout":function($event){_vm.myTable.rowNumber[i].onMouseOut($event)}}},[_c('div',{style:([_vm.myTable.rowNumber[i].cell.style])},[_vm._v("\n              "+_vm._s(_vm.myTable.config.hasLeftFixedTable ?'':_vm.myTable.rowNumber[i].cell.content)+"\n            ")])]):_vm._e(),(i===0&&_vm.myTable.tableHeadLeft[0]&&_vm.myTable.tableHeadTop[0])?_c('th',{staticClass:"colNumber",style:([_vm.myTable.tableHeadTopLeft.style]),attrs:{"colspan":_vm.myTable.theadLeftEntity.side2,"rowspan":_vm.myTable.tableHeadTop.length}},[_c('div',{style:([_vm.myTable.tableHeadTopLeft.cell.style])},[_vm._v("\n              "+_vm._s(_vm.myTable.config.topleftShowTableName ? _vm.myTable.tableHeadTopLeft.cell.content:'')+"\n            ")])]):_vm._e(),_vm._l((tr),function(th,i){return _c('th',{key:th.id +i,style:([th.style]),attrs:{"colspan":th.span1,"rowspan":th.span2,"draggable":th.draggable,"tabindex":"1"},on:{"click":function($event){th.onClick($event)},"dragstart":function($event){_vm.myTable.dragStart($event,th)},"dragend":function($event){_vm.myTable.dragEnd($event,th)},"dragover":function($event){_vm.myTable.dragOver($event,th)},"drop":function($event){_vm.myTable.drop($event,th)},"dragleave":function($event){_vm.myTable.dragLeave($event,th)},"mousedown":function($event){th.onMouseDown($event)},"mousemove":function($event){th.onMouseMove($event)},"mouseout":function($event){th.onMouseOut($event)}}},[(th.cell.displayClass[th.cell.status].displayType == 'text')?_c('div',{style:([th.cell.style]),on:{"dblclick":function($event){th.cell.onDbClick($event)}}},[_vm._v(_vm._s(th.cell.content)+"\n            ")]):_vm._e(),(th.cell.displayClass[th.cell.status].displayType == 'input')?_c('div',[_c('input',{directives:[{name:"model",rawName:"v-model",value:(th.cell.value),expression:"th.cell.value"}],style:([th.cell.style]),domProps:{"value":(th.cell.value)},on:{"mouseover":function($event){th.cell.onMouseOver($event)},"blur":function($event){th.cell.inputOnBlur($event,true)},"input":function($event){if($event.target.composing){ return; }_vm.$set(th.cell, "value", $event.target.value)}}})]):_vm._e(),(th.cell.displayClass[th.cell.status].displayType == 'button')?_c('div',[_c('button',{on:{"click":function($event){th.cell.click($event)}}},[_vm._v(_vm._s(th.cell.content))])]):_vm._e(),(th.cell.displayClass[th.cell.status].displayType == 'select')?_c('select',{directives:[{name:"model",rawName:"v-model",value:(th.cell.value),expression:"th.cell.value"}],style:([th.cell.style]),attrs:{"tabindex":"1"},on:{"change":[function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = "_value" in o ? o._value : o.value;return val}); _vm.$set(th.cell, "value", $event.target.multiple ? $$selectedVal : $$selectedVal[0])},function($event){th.cell.onChange($event)}],"blur":function($event){th.cell.onBlur($event)}}},_vm._l((th.cell.select.optionList),function(option){return _c('option',{key:option.value,domProps:{"value":option.text}},[_vm._v(_vm._s(option.text))])})):_vm._e()])})],2)})],2),_c('tbody',_vm._l((_vm.myTable.tableBody),function(tr,i){return _c('tr',{key:tr+i},[(_vm.myTable.config.isShowRowIndex)?_c('th',{staticClass:"rowNumber",style:(_vm.myTable.rowNumber[i+_vm.myTable.tableHeadTop.length].style),on:{"mousedown":function($event){_vm.myTable.rowNumber[i+_vm.myTable.tableHeadTop.length].onMouseDown($event)},"mouseout":function($event){_vm.myTable.rowNumber[i+_vm.myTable.tableHeadTop.length].onMouseOut($event)},"mousemove":function($event){_vm.myTable.rowNumber[i+_vm.myTable.tableHeadTop.length].onMouseMove($event)}}},[_c('div',{style:([_vm.myTable.rowNumber[i+_vm.myTable.tableHeadTop.length].cell.style])},[_vm._v("\n              "+_vm._s(_vm.myTable.rowNumber[i+_vm.myTable.tableHeadTop.length].cell.content)+"\n            ")])]):_vm._e(),_vm._l((_vm.myTable.tableHeadLeft[i]),function(th,j){return _c('th',{key:th+j,style:([th.style]),attrs:{"tabindex":"1","draggable":th.draggable,"colspan":th.span2,"rowspan":th.span1},on:{"click":function($event){th.onClick($event)},"blur":function($event){th.onBlur($event)},"dragstart":function($event){_vm.myTable.dragStart($event,th)},"dragover":function($event){_vm.myTable.dragOver($event,th)},"drop":function($event){_vm.myTable.drop($event,th)},"dragleave":function($event){_vm.myTable.dragLeave($event,th)},"mousedown":function($event){th.onMouseDown($event)},"mousemove":function($event){th.onMouseMove($event)},"mouseout":function($event){th.onMouseOut($event)}}},[(th.cell.displayClass[th.cell.status].displayType == 'text')?_c('div',{style:([th.cell.style]),on:{"dblclick":function($event){th.cell.onDbClick()}}},[_vm._v("\n              "+_vm._s(th.cell.content)+"\n            ")]):_vm._e(),(th.cell.displayClass[th.cell.status].displayType == 'input')?_c('input',{directives:[{name:"model",rawName:"v-model",value:(th.cell.value),expression:"th.cell.value"}],staticStyle:{"background-color":"#fff"},style:([th.cell.style]),domProps:{"value":(th.cell.value)},on:{"mouseover":function($event){th.cell.onMouseOver($event)},"blur":function($event){th.cell.inputOnBlur($event,true)},"input":function($event){if($event.target.composing){ return; }_vm.$set(th.cell, "value", $event.target.value)}}}):_vm._e(),(th.cell.displayClass[th.cell.status].displayType == 'button')?_c('button',{style:([th.cell.style]),on:{"click":function($event){th.cell.click($event)}}},[_vm._v(_vm._s(th.cell.content))]):_vm._e(),(th.cell.displayClass[th.cell.status].displayType == 'select')?_c('select',{directives:[{name:"model",rawName:"v-model",value:(th.cell.value),expression:"th.cell.value"}],style:([th.cell.style]),attrs:{"tabindex":"1"},on:{"change":[function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = "_value" in o ? o._value : o.value;return val}); _vm.$set(th.cell, "value", $event.target.multiple ? $$selectedVal : $$selectedVal[0])},function($event){th.cell.onChange($event)}],"blur":function($event){th.cell.onBlur($event)}}},_vm._l((th.cell.select.optionList),function(option){return _c('option',{key:option.value,domProps:{"value":option.text}},[_vm._v(_vm._s(option.text))])})):_vm._e()])}),_vm._l((tr),function(td,j){return _c('td',{key:1 + j,style:([td.style]),attrs:{"tabindex":"1"},on:{"click":function($event){td.onClick($event)},"mousedown":function($event){td.onMouseDown($event)},"blur":function($event){td.onBlur($event)},"paste":function($event){td.onPaste($event)}}},[(td.cell.displayClass[td.cell.status].displayType == 'text')?_c('div',{style:([td.cell.style]),on:{"dblclick":function($event){td.cell.onDbClick($event)}}},[_vm._v(_vm._s(td.cell.content)+"\n            ")]):_vm._e(),(td.cell.displayClass[td.cell.status].displayType == 'input')?_c('input',{directives:[{name:"model",rawName:"v-model",value:(td.cell.value),expression:"td.cell.value"}],style:([td.cell.style]),attrs:{"type":"text"},domProps:{"value":(td.cell.value)},on:{"input":[function($event){if($event.target.composing){ return; }_vm.$set(td.cell, "value", $event.target.value)},function($event){td.cell.onInput($event)}],"mouseup":function($event){td.cell.onMouseUp($event)},"mouseover":function($event){td.cell.onMouseOver($event)},"focus":function($event){td.cell.onFocus($event)},"blur":function($event){td.cell.inputOnBlur($event,true)},"keydown":function($event){td.cell.onKeyDown($event)}}}):_vm._e(),(td.cell && td.cell.displayClass[td.cell.status].displayType == 'select')?_c('select',{directives:[{name:"model",rawName:"v-model",value:(td.cell.value),expression:"td.cell.value"}],style:([td.cell.style]),attrs:{"tabindex":"1"},on:{"blur":function($event){td.cell.onBlur($event)},"mouseover":function($event){td.cell.onMouseOver($event)},"change":[function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = "_value" in o ? o._value : o.value;return val}); _vm.$set(td.cell, "value", $event.target.multiple ? $$selectedVal : $$selectedVal[0])},function($event){td.cell.onChange($event)}]}},_vm._l((td.cell.select.optionList),function(option){return _c('option',{key:option.value,domProps:{"value":option.text}},[_vm._v(_vm._s(option.text))])})):_vm._e()])})],2)}))]):_vm._e()]),_vm._l((_vm.myTable.$selectBoxEntity.selectList),function(val,key){return _c('div',{key:key,style:({position:'absolute',top:val.fixTop?0:('-'+_vm.myTable.style.scrollTop+'px'),left:val.fixLeft?0:('-'+ _vm.myTable.style.scrollLeft+'px')})},[(val.position.table === _vm.myTable.position.table)?_c('span',[_c('div',{style:(val.topStyle)}),_c('div',{style:(val.rightStyle)}),_c('div',{style:(val.bottomStyle)}),_c('div',{style:(val.leftStyle)})]):_vm._e()])})],2):_vm._e()}
var staticRenderFns = []


// CONCATENATED MODULE: ./packages/drag-table2.0/views/TableCom.vue?vue&type=template&id=7a5dd938&scoped=true&

// EXTERNAL MODULE: external {"commonjs":"vue","commonjs2":"vue","root":"Vue"}
var external_commonjs_vue_commonjs2_vue_root_Vue_ = __webpack_require__("8bbf");
var external_commonjs_vue_commonjs2_vue_root_Vue_default = /*#__PURE__*/__webpack_require__.n(external_commonjs_vue_commonjs2_vue_root_Vue_);

// EXTERNAL MODULE: ./node_modules/vue-class-component/dist/vue-class-component.common.js
var vue_class_component_common = __webpack_require__("65d9");

// CONCATENATED MODULE: ./node_modules/vue-property-decorator/lib/vue-property-decorator.js
/** vue-property-decorator verson 7.0.0 MIT LICENSE copyright 2018 kaorun343 */




/**
 * decorator of an inject
 * @param from key
 * @return PropertyDecorator
 */
function Inject(options) {
    return Object(vue_class_component_common["createDecorator"])(function (componentOptions, key) {
        if (typeof componentOptions.inject === 'undefined') {
            componentOptions.inject = {};
        }
        if (!Array.isArray(componentOptions.inject)) {
            componentOptions.inject[key] = options || key;
        }
    });
}
/**
 * decorator of a provide
 * @param key key
 * @return PropertyDecorator | void
 */
function Provide(key) {
    return Object(vue_class_component_common["createDecorator"])(function (componentOptions, k) {
        var provide = componentOptions.provide;
        if (typeof provide !== 'function' || !provide.managed) {
            var original_1 = componentOptions.provide;
            provide = componentOptions.provide = function () {
                var rv = Object.create((typeof original_1 === 'function' ? original_1.call(this) : original_1) || null);
                for (var i in provide.managed)
                    rv[provide.managed[i]] = this[i];
                return rv;
            };
            provide.managed = {};
        }
        provide.managed[k] = key || k;
    });
}
/**
 * decorator of model
 * @param  event event name
 * @param options options
 * @return PropertyDecorator
 */
function Model(event, options) {
    if (options === void 0) { options = {}; }
    return Object(vue_class_component_common["createDecorator"])(function (componentOptions, k) {
        (componentOptions.props || (componentOptions.props = {}))[k] = options;
        componentOptions.model = { prop: k, event: event || k };
    });
}
/**
 * decorator of a prop
 * @param  options the options for the prop
 * @return PropertyDecorator | void
 */
function Prop(options) {
    if (options === void 0) { options = {}; }
    return Object(vue_class_component_common["createDecorator"])(function (componentOptions, k) {
        (componentOptions.props || (componentOptions.props = {}))[k] = options;
    });
}
/**
 * decorator of a watch function
 * @param  path the path or the expression to observe
 * @param  WatchOption
 * @return MethodDecorator
 */
function Watch(path, options) {
    if (options === void 0) { options = {}; }
    var _a = options.deep, deep = _a === void 0 ? false : _a, _b = options.immediate, immediate = _b === void 0 ? false : _b;
    return Object(vue_class_component_common["createDecorator"])(function (componentOptions, handler) {
        if (typeof componentOptions.watch !== 'object') {
            componentOptions.watch = Object.create(null);
        }
        componentOptions.watch[path] = { handler: handler, deep: deep, immediate: immediate };
    });
}
// Code copied from Vue/src/shared/util.js
var hyphenateRE = /\B([A-Z])/g;
var hyphenate = function (str) { return str.replace(hyphenateRE, '-$1').toLowerCase(); };
/**
 * decorator of an event-emitter function
 * @param  event The name of the event
 * @return MethodDecorator
 */
function Emit(event) {
    return function (target, key, descriptor) {
        key = hyphenate(key);
        var original = descriptor.value;
        descriptor.value = function emitter() {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            if (original.apply(this, args) !== false)
                this.$emit.apply(this, [event || key].concat(args));
        };
    };
}

// CONCATENATED MODULE: ./node_modules/tslib/tslib.es6.js
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
/* global Reflect, Promise */

var extendStatics = function(d, b) {
    extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return extendStatics(d, b);
};

function __extends(d, b) {
    extendStatics(d, b);
    function __() { this.constructor = d; }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}

var __assign = function() {
    __assign = Object.assign || function __assign(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
        }
        return t;
    }
    return __assign.apply(this, arguments);
}

function __rest(s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)
            t[p[i]] = s[p[i]];
    return t;
}

function __decorate(decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
}

function __param(paramIndex, decorator) {
    return function (target, key) { decorator(target, key, paramIndex); }
}

function __metadata(metadataKey, metadataValue) {
    if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(metadataKey, metadataValue);
}

function __awaiter(thisArg, _arguments, P, generator) {
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
}

function __generator(thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
}

function __exportStar(m, exports) {
    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];
}

function __values(o) {
    var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;
    if (m) return m.call(o);
    return {
        next: function () {
            if (o && i >= o.length) o = void 0;
            return { value: o && o[i++], done: !o };
        }
    };
}

function __read(o, n) {
    var m = typeof Symbol === "function" && o[Symbol.iterator];
    if (!m) return o;
    var i = m.call(o), r, ar = [], e;
    try {
        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
    }
    catch (error) { e = { error: error }; }
    finally {
        try {
            if (r && !r.done && (m = i["return"])) m.call(i);
        }
        finally { if (e) throw e.error; }
    }
    return ar;
}

function __spread() {
    for (var ar = [], i = 0; i < arguments.length; i++)
        ar = ar.concat(__read(arguments[i]));
    return ar;
}

function __await(v) {
    return this instanceof __await ? (this.v = v, this) : new __await(v);
}

function __asyncGenerator(thisArg, _arguments, generator) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var g = generator.apply(thisArg, _arguments || []), i, q = [];
    return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;
    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }
    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }
    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }
    function fulfill(value) { resume("next", value); }
    function reject(value) { resume("throw", value); }
    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }
}

function __asyncDelegator(o) {
    var i, p;
    return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;
    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === "return" } : f ? f(v) : v; } : f; }
}

function __asyncValues(o) {
    if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
    var m = o[Symbol.asyncIterator], i;
    return m ? m.call(o) : (o = typeof __values === "function" ? __values(o) : o[Symbol.iterator](), i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i);
    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }
    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }
}

function __makeTemplateObject(cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};

function __importStar(mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result.default = mod;
    return result;
}

function __importDefault(mod) {
    return (mod && mod.__esModule) ? mod : { default: mod };
}

// CONCATENATED MODULE: ./packages/drag-table2.0/utils/base/clone.ts
function baseClone(Obj, exclude, keep, withFunction) {
    exclude = exclude || [];
    keep = exclude || [];
    var buf;
    if (Obj instanceof Array) {
        buf = [];
        Obj.forEach(function (val, i) {
            buf[i] = baseClone(val, exclude, keep);
        });
        return buf;
    }
    else if (typeof Obj === 'function') {
        return Obj;
    }
    else if (Obj instanceof Object) {
        buf = {};
        var _loop_1 = function (key) {
            if ((Obj.hasOwnProperty(key) || (typeof (Obj[key]) === 'function') && withFunction)) {
                var needContinue_1 = false;
                var needKeep_1 = false;
                exclude.forEach(function (keyWord) {
                    if (key.indexOf(keyWord) !== -1) {
                        needContinue_1 = true;
                    }
                });
                keep.forEach(function (keyWord) {
                    if (key.indexOf(keyWord) !== -1) {
                        needKeep_1 = true;
                    }
                });
                if (needContinue_1) {
                    return "continue";
                }
                else {
                    if (needKeep_1) {
                        buf[key] = (Obj[key]);
                    }
                    else {
                        buf[key] = baseClone(Obj[key], exclude, keep, withFunction);
                    }
                }
            }
        };
        for (var key in Obj) {
            _loop_1(key);
        }
        return buf;
    }
    else {
        // console.log('啥都不是:' + Obj);
        return Obj;
    }
}

// CONCATENATED MODULE: ./packages/drag-table2.0/utils/myObejctClone.ts

function myObejctClone(Obj, exclude, keep, withFunction) {
    var object = Object.create({});
    var _loop_1 = function (key) {
        if (Obj.hasOwnProperty(key) || (withFunction && typeof Obj[key] === 'function')) {
            if (key === 'valueP') {
                Object.defineProperty(object, 'value', {
                    get: function () {
                        return this.valueP;
                    },
                    set: function (value) {
                        this.renderState.hasrendered = false;
                        this.valueP = value;
                    }
                });
            }
            var tmpObject = Obj[key];
            var val_1 = null;
            var needContinue_1 = false;
            var needKeep_1 = false;
            (exclude || []).forEach(function (keyWord) {
                if (key.indexOf(keyWord) !== -1) {
                    needContinue_1 = true;
                }
            });
            (keep || []).forEach(function (keyWord) {
                if (key.indexOf(keyWord) !== -1) {
                    needKeep_1 = true;
                }
            });
            if (needContinue_1) {
                return "continue";
            }
            else if (needKeep_1) {
                val_1 = Obj[key];
            }
            else if (Array.isArray(tmpObject)) {
                val_1 = [];
                tmpObject.forEach(function (item) {
                    if (item.EPI_READY && typeof item.clone === 'function') {
                        val_1.push(item.clone(exclude, keep, withFunction));
                    }
                    else {
                        val_1.push(baseClone(item, exclude, keep, withFunction));
                    }
                });
            }
            else if (typeof Obj[key] === 'object') {
                if (tmpObject && tmpObject.EPI_READY && typeof tmpObject.clone === 'function') {
                    val_1 = tmpObject.clone(exclude, keep, withFunction);
                }
                else {
                    val_1 = (baseClone(tmpObject, exclude, keep, withFunction));
                }
            }
            else {
                val_1 = Obj[key];
            }
            object[key] = val_1;
        }
    };
    for (var key in Obj) {
        _loop_1(key);
    }
    return object;
}

// CONCATENATED MODULE: ./packages/drag-table2.0/utils/base/baseSlice.ts
/**
 * The base implementation of `_.slice` without an iteratee call guard.
 *
 * @private
 * @param {Array} array The array to slice.
 * @param {number} [start=0] The start position.
 * @param {number} [end=array.length] The end position.
 * @returns {Array} Returns the slice of `array`.
 */
function baseSlice(array, start, end) {
    var index = -1;
    var length = array.length;
    start = start == null ? 0 : (+start || 0);
    if (start < 0) {
        start = -start > length ? 0 : (length + start);
    }
    end = (end === undefined || end > length) ? length : (+end || 0);
    if (end < 0) {
        end += length;
    }
    length = start > end ? 0 : ((end - start) >>> 0);
    start >>>= 0;
    var result = Array(length);
    while (++index < length) {
        result[index] = array[index + start];
    }
    return result;
}

// CONCATENATED MODULE: ./packages/drag-table2.0/utils/base/drop.ts

function drop(array, n) {
    var length = array == null ? 0 : array.length; // 数组长度
    if (!length) { // 如果为空数组，返回空数组
        return [];
    }
    n = n === undefined ? 1 : n;
    return baseSlice(array, n < 0 ? 0 : n, length); // 调用baseSlice对数组从n位置进行切割，并返回切好的数组
}

// CONCATENATED MODULE: ./packages/drag-table2.0/utils/base/dropRight.ts

function dropRight(array, n) {
    var length = array == null ? 0 : array.length; // 数组长度
    if (!length) { // 如果为空数组，返回空数组
        return [];
    }
    n = n === undefined ? 1 : n;
    n = length - n;
    return baseSlice(array, 0, n < 0 ? 0 : n); // 调用baseSlice对数组从n位置进行切割，并返回切好的数组
}

// CONCATENATED MODULE: ./packages/drag-table2.0/utils/base/first.ts
function first(array) {
    return array ? array[0] : undefined;
}

// CONCATENATED MODULE: ./packages/drag-table2.0/utils/base/last.ts
function last(array) {
    var length = array ? array.length : 0;
    return length ? array[length - 1] : undefined;
}

// CONCATENATED MODULE: ./packages/drag-table2.0/utils/base/guid.ts
function S4() {
    return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);
}
;
// Generate a pseudo-GUID by concatenating random hexadecimal.
function guid() {
    return (S4() + S4() + '-' + S4() + '-' + S4() + '-' + S4() + '-' + S4() + S4() + S4());
}
;

// CONCATENATED MODULE: ./packages/drag-table2.0/utils/base/objecSet.ts
function objectSet(targetObect, sourceObject, setType) {
    setType = setType || 'intersection';
    if (targetObect && sourceObject) {
        for (var key in sourceObject) {
            if (targetObect.hasOwnProperty(key) || (setType === 'union' && sourceObject.hasOwnProperty(key))) {
                var value = targetObect[key];
                if (typeof value === 'object' && !Array.isArray(value)) {
                    objectSet(targetObect[key], sourceObject[key], setType);
                }
                else if (sourceObject[key] !== undefined) {
                    targetObect[key] = sourceObject[key];
                }
            }
        }
    }
    return targetObect;
}

// CONCATENATED MODULE: ./packages/drag-table2.0/utils/base/replaceAll.ts
function replaceAll(targetString, oldStr, newStr) {
    var reg = new RegExp(oldStr, 'g');
    var res = targetString.replace(reg, newStr);
    return res;
}

// CONCATENATED MODULE: ./packages/drag-table2.0/utils/base/getA_Z.ts
/**
 * 将序号转换成A、B、C
 *
 * @private
 * @param {number} index
 * @returns {string}
 * @memberof DefaultTable
 */
function getA_Z(index) {
    var shang = Math.floor(index / 26);
    var yushu = index % 26;
    var res = '';
    if (shang > 0) {
        res += String.fromCharCode(shang + 65 - 1);
    }
    res += String.fromCharCode(yushu + 65);
    return res;
}

// CONCATENATED MODULE: ./packages/drag-table2.0/utils/index.ts












// CONCATENATED MODULE: ./packages/drag-table2.0/viewModule/style/Style.ts
var BaseStyle = /** @class */ (function () {
    function BaseStyle() {
    }
    BaseStyle.addBackgroundColor = function (dom, color) {
        dom.style['background-color'] = color;
    };
    BaseStyle.removeBackgroundColor = function (dom) {
        dom.style.removeProperty('background-color');
    };
    BaseStyle.addBorder = function (dom, borderBearing, width, borderColor) {
        var style = 'solid ';
        if (width) {
            style += width + 'px ';
        }
        if (borderColor) {
            style += borderColor + ' ';
        }
        dom.style['border-' + borderBearing] = style;
    };
    BaseStyle.removeBorder = function (dom) {
        dom.style.removeProperty('border-left');
        dom.style.removeProperty('border-right');
        dom.style.removeProperty('border-top');
        dom.style.removeProperty('border-bottom');
    };
    BaseStyle.checkBearing = function (ev, rule) {
        var res = 'inner';
        if (ev.currentTarget) {
            var dragoverTarget = ev.currentTarget;
            // const X1of4 = this.getOffsetLeftByBody(dragoverTarget) + dragoverTarget.offsetWidth * 0.25;
            // const X3of4 = this.getOffsetLeftByBody(dragoverTarget) + dragoverTarget.offsetWidth * 0.75;
            // const Y1of4 = this.getOffsetTopByBody(dragoverTarget) + dragoverTarget.offsetHeight * 0.25;
            // const Y3of4 = this.getOffsetTopByBody(dragoverTarget) + dragoverTarget.offsetHeight * 0.75;
            var xLeft = ev.target.offsetWidth * 0.25;
            var xright = ev.target.offsetWidth * 0.75;
            var yTop = ev.target.offsetHeight * 0.25;
            var yBottom = ev.target.offsetHeight * 0.75;
            // debugger
            if (rule) {
                xLeft = rule.left || xLeft;
                xright = ev.target.offsetWidth - rule.right || xright;
                yTop = rule.top || yTop;
                yBottom = ev.target.offsetHeight - rule.bottom || yBottom;
            }
            if (ev.offsetY < yTop) {
                res = 'top';
            }
            if (ev.offsetY > yBottom) {
                res = 'bottom';
            }
            if (ev.offsetX < xLeft) {
                res = 'left';
            }
            if (ev.offsetX > xright) {
                res = 'right';
            }
        }
        return res;
    };
    BaseStyle.getOffsetTopByBody = function (el) {
        var offsetTop = 0;
        while (el && el.tagName !== 'BODY') {
            offsetTop += el.offsetTop;
            el = el.offsetParent;
        }
        return offsetTop;
    };
    BaseStyle.getOffsetLeftByBody = function (el) {
        var offsetLeft = 0;
        while (el && el.tagName !== 'BODY') {
            offsetLeft += el.offsetLeft;
            el = el.offsetParent;
        }
        return offsetLeft;
    };
    return BaseStyle;
}());


// CONCATENATED MODULE: ./packages/drag-table2.0/module/formula/Formula.ts

var Formula_Formula = /** @class */ (function () {
    function Formula() {
    }
    // 复杂的计算方法（包含括号）
    Formula.complexEval = function (str) {
        if (str == null) {
            return '';
        }
        if (typeof str !== 'string') { // 转化成字符串
            str = str + '';
        }
        str = (str + '').replace(/[\s]/g, '');
        var reg = '[\(][^\(]*?[\)]';
        var multObj = str.match(reg); // 匹配括号
        // 不断计算最底层括号的数据
        while (null != multObj) {
            var content = multObj[0] + '';
            var result = this.simpleEval(content.substr(1, content.length - 2));
            str = str.replace(multObj[0], result);
            multObj = str.match(reg);
        }
        return this.simpleEval(str);
    };
    // 简单的计算方法，只有加减乘除
    Formula.simpleEval = function (str) {
        if (str == null) {
            return '';
        }
        if (typeof str !== 'string') { // 转化成字符串
            str = str + '';
        }
        var valueArray = new Array(); // 值的数组
        var markArray = new Array(); // 符号的数组
        var tempValue = 0;
        var ch = str.split('');
        var isOper = false;
        // debugger 
        for (var i = 0; i < ch.length; i++) {
            if (ch[i] === '+' || ch[i] === '-' || ch[i] === '*' || ch[i] === '/') { // 符号
                var dv = tempValue * 1;
                if (isOper) {
                    var value = valueArray.pop();
                    var mark = markArray.pop();
                    dv = this.simpleTwoEval(mark, value, dv);
                }
                valueArray.push(dv);
                markArray.push(ch[i]);
                tempValue = 0;
                isOper = false;
                if (ch[i] === '*' || ch[i] === '/') {
                    isOper = true;
                }
            }
            else {
                tempValue += ch[i] + '';
                if (i === ch.length - 1) { // 最后一位
                    var dv = tempValue * 1;
                    if (isOper) {
                        var dv1 = valueArray.pop();
                        var mark = markArray.pop();
                        var result = this.simpleTwoEval(mark, dv1, tempValue);
                        dv = result;
                    }
                    valueArray.push(dv);
                }
            }
        }
        valueArray = this.reverseArray(valueArray);
        markArray = this.reverseArray(markArray);
        while (valueArray.length > 1) {
            var v1 = valueArray.pop();
            var v2 = valueArray.pop();
            var mark = markArray.pop();
            valueArray.push(this.simpleTwoEval(mark, v1, v2));
        }
        return valueArray[0] || 0;
    };
    // 两个数的加减乘除
    Formula.simpleTwoEval = function (mark, value1, value2) {
        if (mark === '+') {
            return value1 + value2;
        }
        else if (mark === '-') {
            return value1 - value2;
        }
        else if (mark === '*') {
            return value1 * value2;
        }
        else if (mark === '/') {
            return value1 / value2;
        }
        return 0;
    };
    // 反转数组
    Formula.reverseArray = function (oldArray) {
        var newArray = new Array();
        var size = oldArray.length;
        for (var i = 0; i < size; i++) {
            newArray.push(oldArray.pop());
        }
        return newArray;
    };
    /**
     * name
     */
    Formula.cellStr2Position = function (cellStr) {
        var res = {
            table: (/[0-9]+(?=!)/.exec(cellStr) || [null])[0],
            colStr: (/[^!]?([A-Z])+/.exec(cellStr) || [null])[0],
            rowStr: (/[0-9]+$/.exec(cellStr) || [null])[0],
        };
        return res;
    };
    Formula.curlyBracesHandle = function (str, container) {
        var reg = '[\{][^\{]*?[\}]';
        var regObj = str.match(reg);
        while (null != regObj) {
            (regObj || []).forEach(function (item) {
                var rowNum = container.position.rowNum + '';
                if (/sr/.test(item)) {
                    var formula = item.replace(/sr/g, rowNum);
                    formula = formula.replace(/[{}]/g, '');
                    var res = Formula.complexEval(formula);
                    str = str.replace(item, res + 1);
                }
                else if (/sc/.test(item)) {
                    var selfCol = container.position.colNum + '';
                    var formula = item.replace(/sc/g, selfCol);
                    formula = formula.replace(/[{}]/g, '');
                    var res = Formula.complexEval(formula);
                    str = str.replace(item, getA_Z(res));
                }
            });
            regObj = str.match(reg);
        }
        return str;
    };
    return Formula;
}());


// CONCATENATED MODULE: ./packages/drag-table2.0/config/BaseCellConfig.ts
var BaseCellConfig = /** @class */ (function () {
    function BaseCellConfig() {
        this.style = {
            fontSize: 12,
            // padding:'0px 5px',
            color: '#000',
            textAlign: 'center',
            width: '100px',
            height: '28px',
            whiteSpace: 'nowrap',
            textOverflow: 'ellipsis',
            overflow: 'hidden',
            boxSizing: 'border-box',
            display: 'block',
            userSelect: 'none',
            backgroundColor: 'transparent',
        };
    }
    return BaseCellConfig;
}());


// CONCATENATED MODULE: ./packages/drag-table2.0/config/BaseContainerConfig.ts
var BaseContainerConfig = /** @class */ (function () {
    function BaseContainerConfig() {
        this.style = {};
    }
    return BaseContainerConfig;
}());


// CONCATENATED MODULE: ./packages/drag-table2.0/config/CellContainerConfig.ts


var CellContainerConfig_CellContainerConfig = /** @class */ (function (_super) {
    __extends(CellContainerConfig, _super);
    function CellContainerConfig() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.baseSide1 = 100; // 长边长度
        _this.baseSide2 = 28; // 短边长度
        _this.style = {
            padding: '0px 0px',
            width: '110px',
            height: '38px',
            overflow: 'hidden',
            userSelect: 'text',
            position: 'relative'
        };
        return _this;
    }
    return CellContainerConfig;
}(BaseContainerConfig));


// CONCATENATED MODULE: ./packages/drag-table2.0/config/BaseTheadConfig.ts



var BaseTheadConfig_BaseTheadConfig = /** @class */ (function (_super) {
    __extends(BaseTheadConfig, _super);
    function BaseTheadConfig() {
        var _this = _super.call(this) || this;
        _this.draggable = true; // 是否可以拖动
        var style = {
            background: '#f5f7fa',
            cursor: 'pointer',
        };
        objectSet(_this.style, style, 'union');
        return _this;
    }
    return BaseTheadConfig;
}(CellContainerConfig_CellContainerConfig));


// CONCATENATED MODULE: ./packages/drag-table2.0/config/BaseTableConfig.ts


var BaseTableConfig_BaseTableConfig = /** @class */ (function (_super) {
    __extends(BaseTableConfig, _super);
    function BaseTableConfig() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.topleftShowTableName = false; // 左上角单元格是否显示表名
        _this.tableName = ''; // 表名
        _this.debugLevel = 0; // 1为调试模式 0是正常模式
        _this.isShowColIndex = true; // 是否显示 列标识：A、B、D、C
        _this.isShowRowIndex = true; // 是否显示 行标识：1、2、3、4
        _this.isOverflow = false; // 超出宽度是否出现滚动条
        _this.canResizeWidth = false; // 是否可以拖动 控制行列宽度
        _this.hasTopFixedTable = true; // 是否有上侧固定表头
        _this.hasLeftFixedTable = true; // 是否有左侧固定表头
        _this.hasTopThead = true; // 是否有上表头
        _this.hasLeftThead = true; // 是否有左侧表头
        _this.renderEvent = ['blur', 'change', 'paste'];
        _this.maxWidth = '100%'; // 如果加滚动条 表格默认宽度
        _this.maxHeight = '200px'; // 如果加滚动条 表格默认高度
        return _this;
    }
    return BaseTableConfig;
}(BaseContainerConfig));


// CONCATENATED MODULE: ./packages/drag-table2.0/config/IndexTheadConfig.ts



var IndexTheadConfig_IndexTheadConfig = /** @class */ (function (_super) {
    __extends(IndexTheadConfig, _super);
    function IndexTheadConfig() {
        var _this = _super.call(this) || this;
        var style = {
            overflow: 'hidden',
            boxSizing: 'border-box',
            whiteSpace: 'nowrap',
            textOverflow: 'ellipsis',
            userSelect: 'none',
            background: '#fff',
            zIndex: 99
        };
        objectSet(_this.style, style, 'union');
        return _this;
    }
    return IndexTheadConfig;
}(BaseTheadConfig_BaseTheadConfig));


// CONCATENATED MODULE: ./packages/drag-table2.0/config/BaseTableListConfig.ts


var BaseTableListConfig_BaseTableListConfig = /** @class */ (function (_super) {
    __extends(BaseTableListConfig, _super);
    function BaseTableListConfig() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    return BaseTableListConfig;
}(BaseTableConfig_BaseTableConfig));


// CONCATENATED MODULE: ./packages/drag-table2.0/config/BaseTbodyConfig.ts



var BaseTbodyConfig_BaseTbodyConfig = /** @class */ (function (_super) {
    __extends(BaseTbodyConfig, _super);
    function BaseTbodyConfig() {
        var _this = _super.call(this) || this;
        var style = {
            background: '#fff',
        };
        objectSet(_this.style, style, 'union');
        return _this;
    }
    return BaseTbodyConfig;
}(CellContainerConfig_CellContainerConfig));


// CONCATENATED MODULE: ./packages/drag-table2.0/config/TheadContainerConfig.ts



var TheadContainerConfig_TheadContainerConfig = /** @class */ (function (_super) {
    __extends(TheadContainerConfig, _super);
    function TheadContainerConfig() {
        var _this = _super.call(this) || this;
        _this.span1 = 1;
        _this.span2 = 1;
        var style = {
            overflow: 'hidden',
            boxSizing: 'border-box',
            whiteSpace: 'nowrap',
            textOverflow: 'ellipsis',
            background: '#fff',
        };
        objectSet(_this.style, style, 'union');
        return _this;
    }
    return TheadContainerConfig;
}(BaseTheadConfig_BaseTheadConfig));


// CONCATENATED MODULE: ./packages/drag-table2.0/config/DefaultConfig.ts









var DefaultConfig_DefaultConfig = /** @class */ (function () {
    function DefaultConfig() {
        this.tableList = new BaseTableListConfig_BaseTableListConfig(); // BaseTable类配置
        this.table = new BaseTableConfig_BaseTableConfig(); // BaseTable类配置
        this.topThead = new BaseTheadConfig_BaseTheadConfig(); // 上表头theadTopEntity配置
        this.leftThead = new BaseTheadConfig_BaseTheadConfig(); // 左表头theadLeftEntity配置
        this.topIndexThead = new IndexTheadConfig_IndexTheadConfig(); // 上表头theadTopEntity配置
        this.leftIndexThead = new IndexTheadConfig_IndexTheadConfig(); // 左表头theadLeftEntity配置
        this.baseTbody = new BaseTbodyConfig_BaseTbodyConfig(); // tbody配置
        this.baseCell = new BaseCellConfig(); // Cell配置
        this.cellContainer = new CellContainerConfig_CellContainerConfig(); // 基础Cell容器
        this.baseContainer = new BaseContainerConfig(); // 基础容器
        this.theadContainer = new TheadContainerConfig_TheadContainerConfig(); // 基础容器
        this.leftIndexThead.style.width = '80px';
    }
    /**
     * getInstance
     */
    DefaultConfig.getInstance = function (id) {
        var res;
        if (this.instances.hasOwnProperty(id)) {
            res = this.instances[id];
        }
        else {
            res = this.instances[id] = new DefaultConfig();
        }
        return res;
    };
    DefaultConfig.instances = {};
    return DefaultConfig;
}());


// CONCATENATED MODULE: ./packages/drag-table2.0/viewModule/cell/BaseCell.ts




var BaseCell_BaseCell = /** @class */ (function () {
    // constructor($value: any, parent?: CellContainer) {
    //     this.$value = $value || '';
    //     this.$parent = parent;
    //     this.setConfig();
    // }
    function BaseCell(param) {
        this.content = ''; // 内容
        this.selectionStart = 0;
        this.oldValue = '';
        this.title = '';
        this.status = 'normal';
        this.readonly = false;
        this.displayType = 'text';
        this.EPI_READY = true; // 是否拥有clone和setData的 开盒即用标识
        // 用户自定义
        this.userData = {};
        // 展示类
        this.displayClass = {
            normal: {
                displayType: 'text',
            },
            dbclick: {
                displayType: 'input',
                select: {
                    optionList: [],
                },
            },
            readonly: {
                displayType: 'text'
            }
        };
        this.$defConfigId = 'defConfig';
        // 公式
        this.formula = {
            hasFormula: false,
            tmpValue: '',
            canClickAdd: true,
        };
        // 样式
        this.style = {};
        // 验证
        this.verification = {
            state: true,
            hasVerification: false,
            vTypes: [],
            message: {
                integer: '必须输入整型',
                notNull: '该项是必填项',
                number: '您好请输入数字类型:例如 123|32|3.5....',
                date: '您好请输入正确时间:例如 2019-01-01',
                decimal: '您好请输入正确数字'
            }
        };
        // 选择框
        this.select = {
            selectOption: null,
            optionList: [],
        };
        // 配置文件
        this.config = new BaseCellConfig();
        this.warningMessage = [];
        // 渲染状态
        this.renderState = {
            inRender: false,
            hasrendered: false,
        };
        this.$ICObject = {}; // index-Container-对应;
        this.value = param.value || '';
        this.$parent = param.$parent;
        this.$defConfigId = param.$defConfigId || this.$defConfigId;
        this.$defaultConfig = DefaultConfig_DefaultConfig.getInstance(this.$defConfigId);
        this.setConfig(this.$defaultConfig.baseCell);
        if (param.config) {
            this.setConfig(param.config);
        }
    }
    Object.defineProperty(BaseCell.prototype, "value", {
        get: function () {
            return this.$value;
        },
        set: function (value) {
            this.renderState.hasrendered = false;
            this.$value = value;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 通用设置配置
     *
     * @param {*} config
     * @memberof BaseCellInterface
     */
    BaseCell.prototype.setConfig = function (config) {
        var configCopy = baseClone(config);
        try {
            if (configCopy) {
                objectSet(this.config, configCopy, 'union');
                objectSet(this.style, configCopy.style, 'union');
                objectSet(this, this.config); // 不加union
            }
        }
        catch (error) {
            console.error(error);
        }
    };
    /**
     * doVerify
     */
    BaseCell.prototype.doVerify = function (repair) {
        var _this = this;
        this.warningMessage = [];
        var res = true;
        this.verification.state = true;
        var content = this.content + '';
        if (this.verification.hasVerification) {
            this.verification.vTypes.forEach(function (vType) {
                res = true;
                if (vType === 'number' && content) {
                    res = !isNaN(content);
                }
                else if (vType === 'date' && content) {
                    var reg = /((?!0000)[0-9]{4}-((0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-8])|(0[13-9]|1[0-2])-(29|30)|(0[13578]|1[02])-31)|([0-9]{2}(0[48]|[2468][048]|[13579][26])|(0[48]|[2468][048]|[13579][26])00)-02-29)/;
                    res = reg.test(content);
                }
                else if (vType === 'integer' && content) {
                    var reg = /^[+]{0,1}(\d+)$/;
                    res = res && (reg.test(content));
                }
                else if (vType.indexOf('decimal') !== -1 && content) {
                    // debugger
                    var mathObj = vType.match(/%[0-9]+/);
                    var num = 0;
                    if (mathObj !== null) {
                        num = Number(mathObj[0].replace('%', ''));
                    }
                    var reg = void 0;
                    if (num === 0) {
                        reg = /^\d+(\.\d+)*$/;
                    }
                    else {
                        reg = new RegExp('^\\d+(\\.\\d{1,' + num + '})?$');
                    }
                    res = res && reg.test(content);
                    if (res) {
                        var dotIndex = content.indexOf('.');
                        var zeroCount = 0;
                        if (dotIndex !== -1) {
                            var nowBit = content.split('.')[1].length;
                            zeroCount = num - nowBit;
                        }
                        else {
                            content += num === 0 ? '' : '.';
                            zeroCount = num;
                        }
                        content += new Array(zeroCount).fill(0).join('');
                    }
                    var ex = '';
                    for (var i = 0; i < num; i++) {
                        ex += '1';
                    }
                    _this.verification.message[vType] = _this.verification.message[vType] || '您好请输入最多' + num + '位小数:例如 3.' + ex;
                }
                else if (vType === 'notNull') {
                    res = (content !== '' && content !== undefined && content !== null);
                }
                if (!res) {
                    _this.warningMessage.push(vType);
                }
                if (repair) {
                    if (vType === 'date' && !res) {
                        _this.$value = content = '1990-01-01';
                    }
                    _this.content = content;
                }
                _this.verification.state = _this.verification.state && res;
            });
        }
        return res;
    };
    /**
     * 设置数据
     *
     * @param {BaseCellInterface} cellData
     * @memberof BaseCell
     */
    BaseCell.prototype.setCellData = function (cellData) {
        var self = this;
        for (var key in cellData) {
            // 2018/11/23将 if (containerData.hasOwnProperty(key))修改为 if (this.hasOwnProperty(key))
            if (this.hasOwnProperty(key) || key === 'value') {
                var $value = cellData[key];
                if (key.indexOf('$') !== -1 || $value === undefined) {
                    continue;
                }
                else if (key === 'displayClass') {
                    objectSet(this.displayClass, $value, 'union');
                    objectSet(this, this.displayClass[this.status]);
                }
                else if (typeof $value === 'object' && !Array.isArray($value)) {
                    objectSet(self[key], $value, 'union');
                }
                else {
                    this.setProperty(key, $value);
                }
            }
        }
    };
    /**
     * 设置属性
     *
     * @param {string} key
     * @param {*} val
     * @returns
     * @memberof BaseCell
     */
    BaseCell.prototype.setProperty = function (key, val) {
        if (val === undefined) {
            return;
        }
        this[key] = val;
        this.renderState.hasrendered = false;
    };
    BaseCell.prototype.getProperty = function (key) {
        return this[key];
    };
    BaseCell.prototype.clone = function (exclude, keep, withFunction) {
        return myObejctClone(this, exclude, keep, withFunction);
    };
    /**
     * onFocus
     */
    BaseCell.prototype.onFocus = function (ev) {
        var res = this.checkHasFormula();
        this.checkLastCharStatus(ev);
    };
    /**
     * onMouseOver
     */
    BaseCell.prototype.onMouseOver = function (ev) {
        switch (this.displayType) {
            case 'input':
                ev.srcElement.focus();
                break;
        }
    };
    /**
     * onMouseUp
     */
    BaseCell.prototype.onMouseUp = function (ev) {
        this.checkLastCharStatus(ev);
    };
    /**
     * check
     */
    BaseCell.prototype.checkLastCharStatus = function (ev) {
        this.selectionStart = ev.target.selectionStart;
        var lastCharIndex = this.selectionStart - 1;
        var char = (this.$value + '').substr(lastCharIndex, 1);
        var parentContainer = this.$parent;
        console.log('char:' + char);
        if (/^[\+\-\*\/\=]$/.test(char)) {
            // debugger
            this.formula.canClickAdd = true;
            parentContainer.$positionManager.canFocus = false;
            parentContainer.$positionManager.$editContainer = parentContainer;
            this.formula.tmpValue = this.$value;
        }
        else {
            this.formula.canClickAdd = false;
            parentContainer.$positionManager.canFocus = true;
            parentContainer.$positionManager.$editContainer = null;
        }
    };
    /**
     * onInput
     */
    BaseCell.prototype.onInput = function (ev) {
        this.checkLastCharStatus(ev);
    };
    /**
     * checkHasFormula
     */
    BaseCell.prototype.checkHasFormula = function () {
        if (this.$parent) {
            var regStart = /^=/;
            if (regStart.test(this.$value)) {
                this.formula.hasFormula = true;
                var regEnd = /[A-Z]+[0-9]+$/g;
                if (regEnd.test(this.$value)) {
                    this.formula.canClickAdd = true;
                }
                else {
                    this.formula.canClickAdd = false;
                }
                this.formula.canClickAdd = true;
            }
            else {
                this.formula.hasFormula = false;
            }
        }
        return this.formula.hasFormula;
    };
    /**
     * click
     */
    BaseCell.prototype.click = function (ev) {
        ev.stopPropagation();
        var displayType = this.displayClass[this.status].displayType;
        switch (displayType) {
            case 'button':
                if (this.$parent) {
                    this.$parent.rootParentSendMsg({
                        ev_type: 'click',
                        event: ev,
                        data: {
                            objectName: 'button',
                            object: this,
                        },
                    });
                }
                break;
        }
    };
    BaseCell.prototype.onDbClick = function (ev) {
        if (!this.readonly) {
            this.status = 'dbclick';
            objectSet(this, this.displayClass[this.status], 'union');
        }
        var parentContainer = this.$parent;
        if (parentContainer) {
            parentContainer.rootParentSendMsg({
                ev_type: 'dbclick',
                event: ev,
                data: {
                    objectName: 'Cell',
                    object: this,
                },
            });
        }
        // ev.target.focus();
    };
    /**
     * onBlur
     */
    BaseCell.prototype.inputOnBlur = function (ev, update) {
        var _this = this;
        this.status = 'normal';
        this.onBlur(ev);
        var parentContainer = this.$parent;
        this.render();
        if (!this.verification.state) {
            this.warningMessage.forEach(function (vType) {
                _this.warning(_this.verification.message[vType]);
            });
        }
        if (parentContainer) {
            if (update) {
                var sourceContainer = parentContainer.getContainer(parentContainer.position);
                sourceContainer.setCell(this);
                sourceContainer.cell.render();
                parentContainer.$positionManager.canFocus = true;
                parentContainer.$positionManager.$editContainer = null;
            }
            parentContainer.rootParentSendMsg({
                ev_type: 'blur',
                event: ev,
                data: {
                    objectName: 'Cell',
                    object: this,
                },
            });
        }
    };
    /**
     * onBlur
     */
    BaseCell.prototype.onBlur = function (ev) {
        if (!this.readonly) {
            this.status = 'normal';
            this.oldValue = this.$value;
            objectSet(this, this.displayClass[this.status]);
        }
    };
    /**
     * warning
     */
    BaseCell.prototype.warning = function (msg) {
        alert(msg);
        // this.style.backgroundColor = 'red';
        // setTimeout(() => {
        //     this.style.backgroundColor = 'transparent';
        // }, 3 * 1000);
    };
    /**
     * onKeyDown
     * 回车失去焦点
     */
    BaseCell.prototype.onKeyDown = function (ev) {
        // debugger
        if (ev.key === 'Enter') {
            ev.target.blur();
        }
        else if (ev.key === 'Escape') {
            this.$value = this.oldValue;
            ev.target.blur();
        }
    };
    /**
     * onChange事件
     *
     * @param {*} e
     * @memberof BaseCell
     */
    BaseCell.prototype.onChange = function (ev) {
        if (!this.readonly) {
            this.status = 'normal';
        }
        this.renderState.hasrendered = false;
        switch (this.displayType) {
            case 'select':
                var selectedIndex = ev.target.selectedIndex;
                this.select.selectOption = this.select.optionList[selectedIndex];
                break;
        }
        var parentContainer = this.$parent;
        if (parentContainer) {
            parentContainer.rootParentSendMsg({
                ev_type: 'change',
                event: ev,
                data: {
                    objectName: 'Cell',
                    object: this,
                },
            });
        }
    };
    /**
     * checkStatus
     */
    BaseCell.prototype.checkStatus = function () {
        var parnetContainer = this.$parent;
        if (this.config.readonly !== undefined) {
            this.readonly = this.config.readonly;
        }
        else if (parnetContainer) {
            var rootParent = parnetContainer.$rootParent;
            if (parnetContainer.config.readonly !== undefined) {
                this.readonly = parnetContainer.config.readonly;
            }
            else if (rootParent) {
                if (rootParent.config.readonly !== undefined) {
                    this.readonly = rootParent.config.readonly;
                }
            }
        }
        if (this.readonly === true) {
            this.status = 'readonly';
        }
        else {
            this.status = 'normal';
        }
    };
    /**
     * render
     * 渲染
     */
    BaseCell.prototype.render = function () {
        var _this = this;
        var parentContainer = this.$parent;
        if (parentContainer) {
            this.style.width = parentContainer.style.width;
            this.style.height = parentContainer.style.height;
            this.style.lineHeight = parentContainer.style.height;
        }
        if (this.renderState.hasrendered && !this.formula.hasFormula) {
            // debugger;
            return;
        }
        else if (this.renderState.inRender) {
            this.content = 0;
            var position = parentContainer.position;
            console.error('重复引用:table' + position.table + '!' + position.colStr + position.rowStr);
        }
        else {
            this.renderState.inRender = true;
            this.checkHasFormula();
            if (parentContainer && this.formula.hasFormula) {
                var posiitonReg = /(table[0-9]+!)?[A-Z]+[0-9]+/g;
                var formulaContent_1 = this.$value.replace(/^=/, ''); // 拷贝一份用于计算
                var valueBack_1 = this.$value; // 拷贝一份用于替换
                formulaContent_1 = Formula_Formula.curlyBracesHandle(formulaContent_1, parentContainer);
                var ICObject_1 = {}; // 新建一个对象存储对应信息
                // console.log(formulaContent);
                var regObj = formulaContent_1.match(posiitonReg);
                (regObj || []).forEach(function (item) {
                    // 获得position 如果没有table则默认为同表操作
                    var position = Formula_Formula.cellStr2Position(item);
                    position.table = position.table || parentContainer.position.table;
                    // console.log(this.$ICObject);
                    var result;
                    if (_this.$ICObject.hasOwnProperty(item)) {
                        result = _this.$ICObject[item];
                        if (result) {
                            var newPositonStr = (position.table === parentContainer.position.table ? '' : 'table' + result.position.table + '!') + result.position.colStr + result.position.rowStr;
                            ICObject_1[newPositonStr] = result;
                            valueBack_1 = replaceAll(valueBack_1, newPositonStr, 'back_' + newPositonStr);
                            if (valueBack_1.search('back_' + item) !== -1) {
                                valueBack_1 = replaceAll(valueBack_1, 'back_' + item, newPositonStr);
                            }
                            else {
                                valueBack_1 = replaceAll(valueBack_1, item, newPositonStr);
                            }
                        }
                        else {
                            console.error('cell:render() result为空');
                        }
                    }
                    else {
                        result = parentContainer.getContainer(position);
                        _this.$ICObject[item] = result;
                        ICObject_1[item] = result;
                    }
                    if (result && result.cell) {
                        result.cell.render();
                        formulaContent_1 = formulaContent_1.replace(item, result.cell.content || 0);
                        // console.log(formulaContent);
                    }
                });
                this.$value = valueBack_1;
                this.$ICObject = ICObject_1;
                // console.log(formulaContent);
                formulaContent_1 = Formula_Formula.complexEval(formulaContent_1);
                // console.log(formulaContent);
                this.content = formulaContent_1;
            }
            else {
                this.content = (this.$value || '');
            }
            this.renderState.inRender = false;
        }
        // this.renderState.hasrendered = true;
        this.doVerify(true);
        this.checkStatus();
        // debugger
        // 
    };
    return BaseCell;
}());


// CONCATENATED MODULE: ./packages/drag-table2.0/module/positionManager/PositionManager.ts

var PositionManager_PositionManager = /** @class */ (function () {
    function PositionManager(type) {
        this.positionMap = {};
        this.tableList = [];
        this.$editContainer = null;
        this.canFocus = true; // 是否可以获得焦点
        this.type = type;
    }
    /**
     * getInstance
     */
    PositionManager.getInstance = function (type) {
        var instance = this.instances[type];
        if (!instance) {
            this.instances[type] = instance = new PositionManager(type);
        }
        return instance;
    };
    /**
     * add
     */
    PositionManager.prototype.add = function (table) {
        var hasTable = false;
        var insertIndex = 0;
        this.tableList.forEach(function (tmpTable, index) {
            if (tmpTable.id === table.id) {
                hasTable = true;
                insertIndex = index;
            }
        });
        if (!hasTable) {
            table.position.table = this.tableList.length;
            this.tableList.push(table);
        }
        else {
            this.tableList.splice(insertIndex, 1, table);
            table.position.table = insertIndex;
        }
    };
    /**
     * render
     */
    PositionManager.prototype.render = function () {
        this.tableList.forEach(function (tmpTable) {
            tmpTable.render();
        });
    };
    /**
     * getContainer
     */
    PositionManager.prototype.getContainer = function (position, type) {
        var res = null;
        try {
            if (position) {
                type = type || 'source';
                var copyPosition = baseClone(position);
                copyPosition.table = copyPosition.table + type;
                var tableObj = this.positionMap[copyPosition.table];
                if (tableObj) {
                    var colObj = tableObj[copyPosition.colStr];
                    if (colObj) {
                        res = colObj[copyPosition.rowStr];
                    }
                }
            }
        }
        catch (error) {
            console.error('getContainer发生错误');
            console.log(error);
        }
        return res;
    };
    PositionManager.prototype.getTopIndexContainer = function (position, type) {
        type = type || 'source';
        var cloneP = baseClone(position);
        cloneP.rowStr = 0;
        return this.getContainer(cloneP, type);
    };
    PositionManager.prototype.getLeftIndexContainer = function (position, type) {
        type = type || 'source';
        var cloneP = baseClone(position);
        cloneP.colStr = '@';
        return this.getContainer(cloneP, type);
    };
    /**
     * getColObj
     */
    PositionManager.prototype.getColObj = function (position, type) {
        type = type || 'source';
        var copyPosition = baseClone(position);
        copyPosition.table = copyPosition.table + type;
        var res = null;
        var tableObj = this.positionMap[copyPosition.table];
        if (tableObj) {
            var colObj = tableObj[copyPosition.colStr];
            res = colObj;
        }
        return res;
    };
    /**
     * getRowObj
     */
    PositionManager.prototype.getRowObj = function (position, type) {
        type = type || 'source';
        var copyPosition = baseClone(position);
        copyPosition.table = copyPosition.table + type;
        var res = null;
        var tableObj = this.positionMap[copyPosition.table];
        if (tableObj) {
            res = {};
            for (var colStr in tableObj) {
                if (tableObj.hasOwnProperty(colStr)) {
                    var colObj = tableObj[colStr];
                    res[colStr] = colObj[copyPosition.rowStr];
                }
            }
        }
        return res;
    };
    /**
     * setPositionMap
     */
    PositionManager.prototype.setPositionMap = function (position, container, type) {
        type = type || 'source';
        var copyPosition = baseClone(position);
        copyPosition.table = copyPosition.table + type;
        if (!this.positionMap.hasOwnProperty(copyPosition.table)) {
            this.positionMap[copyPosition.table] = {};
        }
        var tableObj = this.positionMap[copyPosition.table];
        if (!tableObj.hasOwnProperty(copyPosition.colStr)) {
            tableObj[copyPosition.colStr] = {};
        }
        var colObj = tableObj[copyPosition.colStr];
        colObj[copyPosition.rowStr] = container;
    };
    /**
     * saveLastPositionMap
     */
    PositionManager.prototype.saveLastPositionMap = function (position) {
        var copyPosition = baseClone(position);
        var tableClone = this.positionMap[copyPosition.table + 'source'];
        for (var colStr in tableClone) {
            if (tableClone.hasOwnProperty(colStr)) {
                var colObj = tableClone[colStr];
                for (var rowStr in colObj) {
                    if (colObj.hasOwnProperty(rowStr)) {
                        var container = colObj[rowStr];
                        var lastPosition = baseClone(copyPosition);
                        lastPosition.colStr = colStr;
                        lastPosition.rowStr = rowStr;
                        this.setPositionMap(lastPosition, container.clone([], ['$', 'userData']), 'last');
                    }
                }
            }
        }
        return this.positionMap[copyPosition.table + 'last'];
    };
    PositionManager.instances = {};
    return PositionManager;
}());


// CONCATENATED MODULE: ./packages/drag-table2.0/viewModule/container/BaseContainer.ts



// 只有对于容器来说才有相对位置
var BaseContainer_BaseContainer = /** @class */ (function () {
    function BaseContainer(param) {
        this.id = null;
        this.EPI_READY = true; // 是否可以快速导出和恢复
        this.config = {};
        this.style = {};
        this.position = {
            table: 0,
            colNum: 0,
            rowNum: 0,
        };
        this.userData = {};
        this.$defConfigId = 'defConfig';
        this.$positionManagerId = 'single-table';
        this.id = param.id;
        this.$defConfigId = param.$defConfigId || this.$defConfigId;
        this.$positionManagerId = param.$positionManagerId || this.$positionManagerId;
        this.$defaultConfig = DefaultConfig_DefaultConfig.getInstance(param.$defConfigId);
        // this.setConfig(this.$defaultConfig.baseContainer);
        // 设置positionManager
        this.$positionManager = PositionManager_PositionManager.getInstance(param.$positionManagerId);
    }
    /**
     * 通用设置配置
     *
     * @param {*} config
     * @memberof BaseContainer
     */
    BaseContainer.prototype.setConfig = function (config) {
        var configCopy = baseClone(config);
        try {
            if (configCopy) {
                objectSet(this.config, configCopy, 'union');
                objectSet(this.style, configCopy.style, 'union');
                objectSet(this, this.config); // 不加union
            }
        }
        catch (error) {
            console.error(error);
        }
    };
    /**
     * 设置属性
     *
     * @param {string} key
     * @param {*} val
     * @returns
     * @memberof BaseContainer
     */
    BaseContainer.prototype.setProperty = function (key, val) {
        if (val === undefined) {
            return;
        }
        this[key] = val;
    };
    BaseContainer.prototype.onClick = function (ev) {
        // console.log('click');
    };
    /** 获得容器
     * getContainer
     */
    BaseContainer.prototype.getContainer = function (position, type) {
        return this.$positionManager.getContainer(position, type);
    };
    /**
     * getTopIndexContainer
     */
    BaseContainer.prototype.getTopIndexContainer = function (position, type) {
        return this.$positionManager.getTopIndexContainer(position, type);
    };
    /**
     * getTopIndexContainer
     */
    BaseContainer.prototype.getLeftIndexContainer = function (position, type) {
        return this.$positionManager.getLeftIndexContainer(position, type);
    };
    /**
     * getTopIndexContainer
     */
    BaseContainer.prototype.getRowObj = function (position, type) {
        return this.$positionManager.getRowObj(position, type);
    };
    /**
     * getColObj
     */
    BaseContainer.prototype.getColObj = function (position, type) {
        return this.$positionManager.getColObj(position, type);
    };
    /**
     * saveLastPositionMap
     */
    BaseContainer.prototype.saveLastPositionMap = function (position) {
        return this.$positionManager.saveLastPositionMap(position);
    };
    return BaseContainer;
}());


// CONCATENATED MODULE: ./packages/drag-table2.0/viewModule/container/CellContainer.ts




// 只有对于容器来说才有相对位置
var CellContainer_CellContainer = /** @class */ (function (_super) {
    __extends(CellContainer, _super);
    function CellContainer(param) {
        var _this = _super.call(this, param) || this;
        _this.cell = new BaseCell_BaseCell({ $parent: _this });
        _this.isRootParent = false;
        _this.span1 = 1; // 横表头 为colspan 纵表头为rowspan
        _this.span2 = 1; // 横表头 为rowspan 纵表头为colspan
        _this.widthNum = 0;
        _this.heightNum = 0;
        _this.widthChildNum = 0;
        _this.heightChildNum = 0;
        _this.tips = {
            style: {
                width: '12px',
                height: '12px',
                // position: 'absolute',
                marginTop: '-6px',
                top: '50%',
                right: '2px',
            }
        };
        _this.type = param.type;
        _this.side1 = param.side1 == null ? 1 : param.side1;
        _this.side2 = param.side2 == null ? 1 : param.side2;
        if (_this.side1 === 0 && _this.side2 === 0) {
            _this.isRootParent = true;
        }
        _this.$rootTable = param.$rootTable;
        _this.$rootParent = param.$rootParent;
        if (!_this.isRootParent) {
            // debugger
            _super.prototype.setConfig.call(_this, _this.$defaultConfig.cellContainer);
            _this.setConfig(param.config);
        }
        return _this;
    }
    /**
     *
     * 设置Cell
     * @param {BaseCell} cell
     * @memberof CellContainer
     */
    CellContainer.prototype.setCell = function (cell) {
        this.cell = cell;
    };
    /**
     * 点击事件
     *
     * @param {*} ev
     * @memberof CellContainer
     */
    CellContainer.prototype.onClick = function (ev) {
        this.rootParentSendMsg({
            ev_type: 'click',
            event: ev,
            data: {
                objectName: 'CellContainer',
                object: this,
            },
        });
    };
    /**
     * onBlur
     */
    CellContainer.prototype.onBlur = function (ev) {
        // this.rootParentSendMsg({
        //     ev_type: 'blur',
        //     event: ev,
        //     data: {
        //         objectName: 'CellContainer',
        //         object: this,
        //     },
        // });
    };
    /**
     * clone
     */
    CellContainer.prototype.clone = function (exclude, keep, withFunction) {
        return myObejctClone(this, exclude, keep, withFunction);
    };
    /**
     * onMouseDown
     */
    CellContainer.prototype.onMouseDown = function (ev) {
        // console.log(1111);
        // debugger;
        var msg = {
            ev_type: 'mouseDown',
            event: ev,
            data: {
                objectName: 'CellContainer',
                object: this,
            },
        };
        if (ev.which === 3) {
            msg.ev_type = 'rightClick';
            // // 屏蔽右键
            // document.oncontextmenu = () => {
            //     return false;
            // };
            this.rootParentSendMsg(msg);
        }
        else if (ev.which === 2) {
            msg.ev_type = 'middleClick';
            this.rootParentSendMsg(msg);
        }
        if (!this.$positionManager.canFocus && this.$positionManager.$editContainer !== this) {
            // debugger
            // 现代浏览器阻止默认事件
            if (ev && ev.preventDefault) {
                ev.preventDefault();
            }
            else {
                // 阻止IE
                window.event.returnValue = false;
            }
            return false;
        }
    };
    /**
     * clearCell
     */
    CellContainer.prototype.clearCell = function () {
        if (this.cell) {
            var nowCell = this.cell;
            this.cell = new BaseCell_BaseCell({ $parent: this });
        }
    };
    /**
     * delThisRow
     */
    CellContainer.prototype.delThisRow = function (delType) {
        this.$rootTable.delOneRowCol(delType, this);
    };
    /**
     * 粘贴事件
     *
     * @param {*} e
     * @param {*} container
     * @memberof BaseTable
     */
    CellContainer.prototype.onPaste = function (ev) {
        var pastedText;
        if (ev.clipboardData && ev.clipboardData.getData) { // IE
            pastedText = ev.clipboardData.getData('Text');
        }
        else {
            pastedText = ev.originalEvent.clipboardData.getData('Text'); // e.clipboardData.getData('text/plain');
        }
        if (this.cell) {
            // this.cell.setProperty('value', pastedText);
            this.cell.value = pastedText;
            var msg = {
                ev_type: 'paste',
                event: ev,
                data: {
                    objectName: 'CellContainer',
                    object: this,
                },
            };
            if (this.$rootParent) {
                this.rootParentSendMsg(msg);
            }
        }
        return pastedText;
    };
    /**
     * subjectSend
     */
    CellContainer.prototype.rootParentSendMsg = function (msg) {
        if (this.$rootParent) {
            this.$rootParent.subjectSend(msg);
        }
    };
    return CellContainer;
}(BaseContainer_BaseContainer));


// CONCATENATED MODULE: ./packages/drag-table2.0/viewModule/container/TheadContainer.ts





// 只有对于容器来说才有相对位置
var TheadContainer_TheadContainer = /** @class */ (function (_super) {
    __extends(TheadContainer, _super);
    function TheadContainer(param) {
        var _this = _super.call(this, param) || this;
        _this.canSum = false; // 是否可以合计
        _this.canExpand = false; // 是否可以展开
        _this.canDragResize = false; // 是否可以拖拽重塑
        _this.dragType = 0; // 是否可以拖拽重塑
        _this.draggable = true; // 是否可以拖动
        _this.positionCheck = true; // 是否需要位置检查
        _this.childrenShow = true; // 子节点是否隐藏
        _this.children = []; // 子容器
        _this.mergeList = []; // 合并单元格list
        _this.theadPosition = new Array(); // 相对于根节点的职位
        _this.side2Name = 'height';
        _this.side1Name = 'width';
        _this.tbodyConfig = {
            weight: {
                cell: {
                    displayClass: {
                        normal: 100,
                        dbclick: 100,
                    },
                },
            },
            container: {},
        };
        if (/^top/.test(_this.type)) {
            _this.side1Name = 'width';
            _this.side2Name = 'height';
        }
        else if (/^left/.test(_this.type)) {
            _this.side1Name = 'height';
            _this.side2Name = 'width';
        }
        if (!_this.isRootParent) {
            _super.prototype.setConfig.call(_this, _this.$defaultConfig.theadContainer);
            _this.setConfig(param.config);
        }
        // debugger
        _this.span1 = param.span1 == undefined ? 1 : param.span1;
        _this.span2 = param.span2 == undefined ? 1 : param.span1;
        return _this;
    }
    /**
     * 设置父级容器 截止2018-10-9暂未使用
     *
     * @param {TheadContainer} parent
     * @memberof TheadContainer
     */
    TheadContainer.prototype.setParent = function (parent) {
        this.$parent = parent;
    };
    /**
     * 设置Cell属性
     *
     * @param {BaseCell} cell
     * @memberof TheadContainer
     */
    TheadContainer.prototype.setCell = function (cell) {
        this.cell = cell;
    };
    /**
     * 设置container属性 部分属性特殊处理
     *
     * @param {ContainerInterface} containerData
     * @memberof TheadContainer
     */
    TheadContainer.prototype.setContainerData = function (containerData) {
        var _this = this;
        var self = this;
        var _loop_1 = function (key) {
            // 2018/11/23将 if (containerData.hasOwnProperty(key))修改为 if (this.hasOwnProperty(key))
            if (self.hasOwnProperty(key)) {
                var value = containerData[key];
                if (key === 'userData') {
                    // debugger
                }
                if (key === 'children') {
                    var children_1 = Array();
                    value.forEach(function (item) {
                        if (item && item.EPI_READY) {
                            var tmpTheadContainer = _this.createContain(item);
                            children_1.push(tmpTheadContainer);
                        }
                    });
                    this_1.setProperty(key, children_1);
                }
                else if (key === 'tbodyConfig' && value) {
                    this_1.setProperty(key, value);
                }
                else if (key === 'cell' && value) {
                    var cell = new BaseCell_BaseCell({ $parent: this_1 });
                    cell.setCellData(value);
                    this_1.setProperty(key, cell);
                }
                else if (typeof value === 'object' && !Array.isArray(value) && key.indexOf('$') === -1) {
                    objectSet(self[key], value, 'union');
                }
                else {
                    this_1.setProperty(key, value);
                }
            }
        };
        var this_1 = this;
        for (var key in containerData) {
            _loop_1(key);
        }
    };
    /**
     * 自动递归计算容器长宽，以及span、theadPosition等属性值
     *
     * @param {any[]} [leafIndexList]
     * @memberof TheadContainer
     */
    TheadContainer.prototype.resize = function (leafIndexList, leafIndexList2) {
        var _this = this;
        // debugger
        //    if(this.id ==='')
        this.resetByIndexContainer();
        var selfStyleSide2 = Number(this.style[this.side2Name].replace('px', ''));
        this[this.side2Name + 'Num'] = Number(this.style[this.side2Name].replace('px', ''));
        this[this.side1Name + 'Num'] = Number(this.style[this.side1Name].replace('px', ''));
        this.span2 = 1;
        this.side2 = 1;
        if (this.style.display === 'none') {
            this.span1 = 1;
            this.span2 = 0;
            this.side1 = 1;
            this.side2 = 0;
            this[this.side2Name + 'Num'] = 0;
            selfStyleSide2 = 0;
        }
        if (this.isRootParent) {
            this.span1 = 0;
            this.span2 = 0;
            this.side1 = 0;
            this.side2 = 0;
            selfStyleSide2 = 0;
        }
        var span1 = 0;
        var maxGridSide2 = 0; // 孩子的最大高度
        var sumStyleSide1 = 0;
        var maxStyleSide2 = 0;
        if (this.children.length !== 0) {
            // const deep = this.theadPosition.length - 1;
            // if (leafIndexList2 && deep >= 0 && this.cell && this.span2 === 1) {
            //     leafIndexList2[deep] = this;
            // }
            this.children.forEach(function (child, i) {
                var childPosition = _this.theadPosition.concat(i);
                child.theadPosition = childPosition;
                if (_this.childrenShow === false) {
                    child.style.display = 'none';
                    child.childrenShow = false;
                }
                else {
                    delete child.style.display;
                }
                child.resize(leafIndexList, leafIndexList2);
                span1 += child.side1;
                maxGridSide2 = child.side2 > maxGridSide2 ? child.side2 : maxGridSide2;
                sumStyleSide1 += child[_this.side1Name + 'Num'];
                maxStyleSide2 = child[_this.side2Name + 'Num'] > maxStyleSide2 ? child[_this.side2Name + 'Num'] : maxStyleSide2;
            });
            this.side1 = span1;
            this[this.side1Name + 'Num'] = sumStyleSide1;
            this.span1 = span1;
            this.style[this.side1Name] = sumStyleSide1 + 'px';
            {
                this[this.side2Name + 'ChildNum'] = maxStyleSide2;
            }
            {
                this.side2 = maxGridSide2 + this.side2; // 孩子最大高度加上自己高度
                this[this.side2Name + 'Num'] = maxStyleSide2 + selfStyleSide2;
            }
            this.makeChildrenSameSide2(maxGridSide2, maxStyleSide2);
        }
        else if (this.mergeList.length !== 0) {
            // do notihng
        }
        else {
            if (leafIndexList && !this.isRootParent) {
                leafIndexList.push(this);
            }
            // 为了获得span2 === 1的侧边 叶子节点 算法今后可以优化
            {
                var deep = this.theadPosition.length - 1;
                if (leafIndexList2 && deep >= 0 && this.side2 !== 0 && this.span2 === 1) {
                    var lastTHC = leafIndexList2[deep];
                    if (!lastTHC || (this.theadPosition.length > lastTHC.theadPosition.length)) {
                        leafIndexList2[deep] = this;
                    }
                }
            }
        }
        // 为什么要Render?
        if (this.cell) {
            this.cell.render();
        }
    };
    /**
     * resetByIndexContainer
     */
    TheadContainer.prototype.resetByIndexContainer = function () {
        // if(this.id === '模块编码'){
        //     debugger
        // }
        var topIndexContainer = this.$positionManager.getTopIndexContainer(this.position, 'last');
        if (topIndexContainer) {
            // debugger
            this.style.width = topIndexContainer.widthNum + 'px';
        }
        var leftIndexContainer = this.$positionManager.getLeftIndexContainer(this.position, 'last');
        if (leftIndexContainer) {
            this.style.height = leftIndexContainer.heightNum + 'px';
        }
    };
    /**
     * addChild
     * 备注：添加子节点
     * @param child: BaseCell 要添加的子节点
     * @param targetIndex?: number 添加的位置
     */
    TheadContainer.prototype.addChild = function (child, targetIndex) {
        targetIndex = (targetIndex === undefined || targetIndex === null) ? this.children.length : targetIndex;
        if (!child.id) {
            child.id = 'def_' + guid();
        }
        this.children.splice(targetIndex, 0, child);
        return child.id;
    };
    /**
     * deletChild
     * 备注：删除子节点
     * @param count: number 要删除的个数 默认为1
     * @param targetIndex?: number 删除的位置
     * @param needDeleteItChildren?: boolean 是否连同该被 要删除的节点A 和A的子节点都删除
     */
    TheadContainer.prototype.deletChild = function (targetIndex, count, needDeleteItChildren) {
        var _this = this;
        count = count == null ? 1 : count;
        if (needDeleteItChildren) {
            this.children.splice(targetIndex, count);
        }
        else {
            var childrenList = []; // 临时存被删除BaseTheadCell的孩子们
            var childrenStartIndex_1 = targetIndex + count;
            for (var index = targetIndex; index < targetIndex + count; index++) {
                this.children[index].children.forEach(function (child, i) {
                    _this.addChild(child, childrenStartIndex_1);
                    childrenStartIndex_1++;
                });
            }
            this.children.splice(targetIndex, count);
            // this.children = this.children.concat(childrenList);
        }
    };
    /**
     * replaceChild
     * 备注：替换子节点
     * @param count: number 要删除的个数 默认为1
     * @param targetIndex?: number 删除的位置
     * @param needDeleteItChildren?: boolean 是否连同该被 要删除的节点A 和A的子节点都删除
     */
    TheadContainer.prototype.replaceChild = function (newChild, targetIndex, needDeleteItChildren) {
        if (!newChild.id) {
            newChild.id = 'def_' + guid();
        }
        if (needDeleteItChildren) {
            this.children.splice(targetIndex, 1, newChild);
        }
        else {
            var childrenList_1 = []; // 临时存被删除BaseTheadCell的孩子们
            this.children[targetIndex].children.forEach(function (child, i) {
                childrenList_1.push(child);
            });
            this.children.splice(targetIndex, 1, newChild);
            newChild.children = newChild.children.concat(childrenList_1);
        }
    };
    /**
     * getTopList
     * 备注：顶部表头转换为view数组函数
     * @param list?: any[]
     */
    TheadContainer.prototype.getTopList = function (list, p) {
        var _this = this;
        try {
            this.position = baseClone(p);
            this.position.colStr = getA_Z(p.colNum);
            this.position.rowStr = p.rowNum + 1;
            var container = this.clone([], ['$', 'userData'], true); // 之前为什么要拷贝？因为要区分该源container与页面上显示的Container
            this.$positionManager.setPositionMap(this.position, this, 'source');
            this.$positionManager.setPositionMap(this.position, container, 'clone');
            list[0].push(container);
            var cloneP_1 = baseClone(p);
            if (this.children.length !== 0) {
                this.children.forEach(function (child) {
                    var tmpP = baseClone(p);
                    tmpP.rowNum = p.rowNum + _this.span2;
                    tmpP.colNum = cloneP_1.colNum;
                    child.getTopList(drop(list), tmpP);
                    cloneP_1.colNum += child.side1;
                });
            }
        }
        catch (error) {
            // do nothing
        }
    };
    /**
     * getLeftList
     * 备注：左侧表头转换为view数组函数
     * @param parentList?: any[]
     */
    TheadContainer.prototype.getLeftList = function (parentList, p) {
        var _this = this;
        this.position = baseClone(p);
        this.position.colStr = getA_Z(p.colNum);
        this.position.rowStr = p.rowNum + 1;
        // console.log(this.id + this.position.colStr + this.position.rowStr);
        var container = this.clone([], ['$', 'userData'], true);
        this.$positionManager.setPositionMap(this.position, this, 'source');
        this.$positionManager.setPositionMap(this.position, container, 'clone');
        var childrenList = [[]];
        if (last(this.theadPosition) === 0) {
            parentList[0].push(container);
        }
        else {
            childrenList[0].push(container);
        }
        var cloneP = baseClone(p);
        this.children.forEach(function (child, i) {
            var tmpList;
            var tmpP = baseClone(cloneP);
            tmpP.colNum = p.colNum + _this.span2;
            tmpP.rowNum = cloneP.rowNum;
            tmpList = child.getLeftList(childrenList[0].length > 0 ? childrenList : parentList, tmpP);
            try {
                childrenList = JSON.stringify(childrenList) === '[[]]' ? [] : childrenList;
            }
            catch (error) {
                try {
                    tmpList = JSON.stringify(tmpList) === '[[]]' ? [] : tmpList;
                }
                catch (error) {
                    // do nothing
                }
            }
            childrenList = childrenList.concat(tmpList);
            cloneP.rowNum += child.side1;
        });
        return childrenList;
    };
    /**
     * 创建容器
     *
     * @private
     * @param {ContainerInterface} data
     * @returns
     * @memberof BaseThead
     */
    TheadContainer.prototype.createContain = function (data) {
        var $positionManagerId = this.$positionManagerId;
        var $defConfigId = this.$defConfigId;
        var container = new TheadContainer({
            type: this.type,
            side1: 1,
            side2: 1,
            $rootTable: this.$rootTable,
            $rootParent: this.$rootParent,
            $positionManagerId: $positionManagerId,
            $defConfigId: $defConfigId,
            config: this.$rootParent.config
        });
        // container.setConfig(this.$rootParent.config);
        if (data) {
            container.setContainerData(data);
        }
        if (!container.cell) {
            var cell = new BaseCell_BaseCell({ $parent: this });
            container.setCell(cell);
        }
        return container;
    };
    /**
     * onMouseMove
     */
    TheadContainer.prototype.onMouseMove = function (ev) {
        if (this.$rootTable.config.canResizeWidth && this.dragType === 0 && this.side1 === 1) {
            BaseStyle.removeBorder(ev.currentTarget);
            var bear = BaseStyle.checkBearing(ev, { bottom: 10, right: 10 });
            if (bear === 'right' && this.type !== 'left-index') {
                ev.srcElement.style.cursor = 'e-resize';
                BaseStyle.addBorder(ev.currentTarget, bear);
                this.canDragResize = true;
                this.draggable = false;
            }
            else if (bear === 'bottom' && this.type !== 'top-index') {
                ev.srcElement.style.cursor = 's-resize';
                BaseStyle.addBorder(ev.currentTarget, bear);
                this.canDragResize = true;
                this.draggable = false;
            }
            else {
                ev.srcElement.style.cursor = 'auto';
            }
        }
    };
    /**
     * 当鼠标划出单元格 取消边框和鼠标样子
     *
     * @param {*} ev
     * @param {*} th
     * @memberof BaseTable
     */
    TheadContainer.prototype.onMouseOut = function (ev) {
        ev.currentTarget.style.cursor = 'auto';
        BaseStyle.removeBorder(ev.currentTarget);
        this.canDragResize = false;
        this.draggable = true;
    };
    /**
     * 当鼠标按下时 开始拖拽控制大小
     *
     * @param {*} ev
     * @param {*} th
     * @memberof BaseTable
     */
    TheadContainer.prototype.onMouseDown = function (ev) {
        var _this = this;
        if (ev.which === 1 && this.$rootTable.config.canResizeWidth && this.canDragResize) {
            this.dragType = ev.srcElement.style.cursor === 'e-resize' ? 1 : 2;
            this.draggable = false;
            this.$rootTable.$selectBoxEntity.clear();
            var targetDom_1 = {};
            targetDom_1.initMouseLeftX = ev.pageX; // 鼠标起始X位置
            targetDom_1.initMouseTopY = ev.pageY; // 鼠标起始Y位置
            targetDom_1.initWidth = ev.target.clientWidth; // dom原来的宽度
            targetDom_1.initHeight = ev.target.clientHeight; // dom原来的高度
            targetDom_1.initLeft = ev.pageX - targetDom_1.initWidth;
            targetDom_1.initTop = ev.pageY - targetDom_1.initHeight;
            targetDom_1.x = targetDom_1.initLeft;
            targetDom_1.y = targetDom_1.initTop;
            var delSide1_1 = 0;
            var oneColRowObj_1;
            var sideName_1 = this.dragType === 1 ? 'width' : 'height';
            // console.log(sideName);
            var mousemove_1 = function (e) {
                // debugger
                var x = (e.pageX - targetDom_1.initMouseLeftX);
                if (x * -1 > _this.style.minWidth) {
                    return;
                }
                var y = (e.pageY - targetDom_1.initMouseTopY);
                if (y * -1 > targetDom_1.initHeight) {
                    return;
                }
                if (_this.dragType === 1) {
                    delSide1_1 = x;
                    oneColRowObj_1 = _this.getColObj(_this.position, 'clone');
                }
                else if (_this.dragType === 2) {
                    // debugger
                    delSide1_1 = y;
                    oneColRowObj_1 = _this.getRowObj(_this.position, 'clone');
                }
                for (var key in oneColRowObj_1) {
                    if (oneColRowObj_1.hasOwnProperty(key)) {
                        var container = oneColRowObj_1[key];
                        if (container) {
                            // debugger
                            var oldSide = container[sideName_1 + 'Num'] - container[sideName_1 + 'ChildNum'];
                            container.style[sideName_1] = (oldSide + delSide1_1) + 'px';
                            container.cell.style[sideName_1] = (oldSide + delSide1_1) + 'px';
                            if (sideName_1 === 'height') {
                                container.cell.style.lineHeight = oldSide + delSide1_1 + 'px';
                            }
                        }
                    }
                }
            };
            var mouseup_1 = function (e) {
                // debugger;
                document.removeEventListener('mouseup', mouseup_1);
                document.removeEventListener('mousemove', mousemove_1);
                if (_this.dragType === 1) {
                    oneColRowObj_1 = _this.getColObj(_this.position, 'source');
                }
                else if (_this.dragType === 2) {
                    oneColRowObj_1 = _this.getRowObj(_this.position, 'source');
                }
                for (var key in oneColRowObj_1) {
                    if (oneColRowObj_1.hasOwnProperty(key)) {
                        var container = oneColRowObj_1[key];
                        if (container) {
                            var oldSide = container[sideName_1 + 'Num'];
                            if (/index/.test(container.type)) {
                                var theadContainer = container.$theadContainer;
                                if (theadContainer) {
                                    oldSide = theadContainer[sideName_1 + 'Num'] - theadContainer[sideName_1 + 'ChildNum'];
                                    theadContainer.style[sideName_1] = (oldSide + delSide1_1) + 'px';
                                    theadContainer.cell.style[sideName_1] = (oldSide + delSide1_1) + 'px';
                                }
                            }
                            container.style[sideName_1] = (oldSide + delSide1_1) + 'px';
                            container[sideName_1 + 'Num'] = (oldSide + delSide1_1);
                        }
                    }
                }
                _this.$positionManager.saveLastPositionMap(_this.position);
                _this.$positionManager.render();
                _this.draggable = true;
                _this.dragType = 0;
                ev.srcElement.style.cursor = 'auto';
            };
            document.addEventListener('mousemove', mousemove_1);
            document.addEventListener('mouseup', mouseup_1);
        }
        _super.prototype.onMouseDown.call(this, ev);
    };
    /**
     * increaseTheLastChildHeight
     * 备注：增加叶子节点BaseTheadCell的高度
     * @param diff: number 需要增加的高度
     */
    TheadContainer.prototype.increaseTheLeafChildHeight = function (diffGrid, diffStyle) {
        // debugger
        if (this.children.length !== 0 && this.childrenShow) {
            this.children.forEach(function (child) {
                child.increaseTheLeafChildHeight(diffGrid, diffStyle);
            });
            this.side2 += diffGrid;
        }
        else if (this.side2 !== 0) {
            var selfStyleSide2 = Number(this.style[this.side2Name].replace('px', ''));
            this.style[this.side2Name] = selfStyleSide2 + diffStyle + 'px';
            this[this.side2Name + 'Num'] = selfStyleSide2 + diffStyle;
            this.span2 += diffGrid;
            this.cell.render();
            this.side2 += diffGrid;
        }
        // const selfStyleSide2 = Number(this.style[this.side2Name].replace('px', ''));
        // this.style[this.side2Name] = selfStyleSide2 + diffStyle + 'px';
    };
    /**
     * makeChildrenSameHeight
     * 备注：使所有自己的孩子BaseTheadCell 高度一致
     * @param maxHeight: number 孩子中最大高度
     */
    TheadContainer.prototype.makeChildrenSameSide2 = function (maxGridSide2, maxStyleSide2) {
        var _this = this;
        this.children.forEach(function (child) {
            var diffGrid = maxGridSide2 - child.side2;
            var diffStyle = maxStyleSide2 - child[child.side2Name + 'Num'];
            if (diffGrid > 0 || diffStyle > 0) {
                child.increaseTheLeafChildHeight(diffGrid, diffStyle);
            }
            else {
                // debugger
                var deep = child.theadPosition.length - 1;
                if (_this.$rootParent.leafIndexList2 && deep >= 0 && child.span2 === 1) {
                    _this.$rootParent.leafIndexList2[deep] = child;
                }
            }
        });
    };
    return TheadContainer;
}(CellContainer_CellContainer));


// CONCATENATED MODULE: ./packages/drag-table2.0/communication/Subject.ts
var Subject = /** @class */ (function () {
    function Subject() {
        this.callbackList = new Array();
    }
    Subject.prototype.subscribe = function (callback, self) {
        this.callbackList.push({
            fun: callback,
            arg: self,
        });
    };
    Subject.prototype.unsubscribe = function (callback, self) {
        var index = -1;
        this.callbackList.forEach(function (item, i) {
            if (item === {
                fun: callback,
                arg: self,
            }) {
                index = i;
            }
        });
        // const index = this.callbackList.indexOf(callback);
        if (index > -1) {
            this.callbackList.splice(index, 1);
        }
    };
    Subject.prototype.sendMsg = function (msg) {
        this.notify(msg);
    };
    Subject.prototype.notify = function (msg) {
        this.callbackList.forEach(function (obj) {
            obj.fun.call(obj.arg, msg);
        });
    };
    return Subject;
}());


// CONCATENATED MODULE: ./packages/drag-table2.0/viewModule/thead/BaseThead.ts





var BaseThead_BaseThead = /** @class */ (function (_super) {
    __extends(BaseThead, _super);
    function BaseThead(param) {
        var _this = _super.call(this, param) || this;
        _this.cell = null;
        _this.config = {};
        _this.leafIndexList = []; // 叶子节点顺序列表
        _this.leafIndexList2 = []; // 叶子节点顺序列表
        _this.dragStartData = null;
        //  表头变化
        _this.theadSubject = new Subject();
        if (param.id) {
            _super.prototype.setConfig.call(_this, _this.$defaultConfig[param.id]);
            _this.setConfig(param.config);
        }
        _this.$rootParent = _this;
        return _this;
    }
    /**
     * setConfig
     */
    BaseThead.prototype.setConfig = function (config) {
        try {
            _super.prototype.setConfig.call(this, config);
            switch (this.type) {
                case 'top':
                    break;
                case 'left':
                    var tmpSide = this.config.baseSide1;
                    this.config.baseSide1 = this.config.baseSide2;
                    this.config.baseSide2 = tmpSide;
                    break;
            }
        }
        catch (error) {
            console.error('CellContainer error');
            console.error(error);
        }
    };
    /**
     * subjectSend
     */
    BaseThead.prototype.subjectSend = function (msg) {
        this.theadSubject.sendMsg(msg);
    };
    /**
     * 通用dragStart
     *
     * @param {*} ev
     * @param {CellContainer} target
     * @memberof BaseThead
     */
    BaseThead.prototype.dragStart = function (ev, dragStartData) {
        if (this.draggable) {
            this.dragStartData = dragStartData;
            ev.dataTransfer.setData('dragStartData', JSON.stringify(baseClone(this.dragStartData, ['$'])));
            this.subjectSend({
                ev_type: 'dragStart',
                event: ev,
                data: {
                    object: dragStartData,
                    objectName: 'dragStartData',
                },
            });
        }
    };
    /**
     * 通用dragover
     *
     * @param {*} ev
     * @param {target} th
     * @memberof BaseThead
     */
    BaseThead.prototype.dragOver = function (ev, th) {
        if (this.draggable) {
            var targetDom = ev.currentTarget;
            this.resetDragOverStyle(targetDom, th);
            if (th.positionCheck) {
                var bearing = BaseStyle.checkBearing(ev);
                BaseStyle.addBorder(targetDom, bearing, 3, '#000');
                if (bearing === 'inner') {
                    BaseStyle.addBackgroundColor(targetDom, 'red');
                }
            }
            ev.preventDefault();
        }
    };
    BaseThead.prototype.dragLeave = function (ev, th) {
        if (this.draggable) {
            var targetDom = ev.currentTarget;
            BaseStyle.addBackgroundColor(targetDom, this.style.background);
            this.resetDragOverStyle(targetDom, th);
        }
    };
    /**
     * 横表专用drop
     *
     * @param {*} ev
     * @param {CellContainer} item
     * @memberof BaseThead
     */
    BaseThead.prototype.drop = function (ev, th) {
        try {
            var stringData = ev.dataTransfer.getData('dragStartData');
            var dragStartData = this.dragStartData ? this.dragStartData : JSON.parse(stringData || '{}');
            var dragTsData = void 0;
            var targetContainer = this;
            if (th.positionCheck) {
                var bear = BaseStyle.checkBearing(ev);
                targetContainer = this.getContainerByTheadPosition(th.theadPosition);
                dragTsData = {
                    target: {
                        containerData: targetContainer
                    },
                    targetBearing: bear,
                    source: {
                        containerData: dragStartData.containerData,
                    },
                    operationType: dragStartData.operationType
                };
            }
            else {
                dragTsData = {
                    target: {
                        containerData: targetContainer
                    },
                    targetBearing: 'other',
                    source: {
                        containerData: dragStartData.containerData,
                    },
                    operationType: dragStartData.operationType
                };
            }
            var targetDom = ev.currentTarget;
            this.resetDragOverStyle(targetDom, th);
            this.subjectSend({
                ev_type: 'drop',
                event: ev,
                data: {
                    object: dragTsData,
                    objectName: 'DragTsData',
                },
            });
            this.dragStartData = null;
            targetDom = null;
        }
        catch (error) {
            console.error(error);
        }
    };
    /**
     * 拖拽删除函数
     *
     * @param {TheadContainer} th
     * @memberof BaseThead
     */
    BaseThead.prototype.dragDel = function (ev, th) {
        var parentContainer = this.getParentConatiner(th.theadPosition);
        parentContainer.deletChild(last(th.theadPosition), 1, true);
        this.subjectSend({
            ev_type: 'drop-del',
            event: ev,
            data: {
                object: th,
                objectName: 'TheadContainer',
            },
        });
    };
    /**
     * getContainerByTheadPosition
     * 备注：获得子容器
     * @param position: Position 相对于根容器的位置
     *
     */
    BaseThead.prototype.getContainerByTheadPosition = function (position) {
        var res = this;
        (position || []).forEach(function (index) {
            res = res.children[index];
        });
        return res;
    };
    /**
     * resize
     */
    BaseThead.prototype.resize = function () {
        this.leafIndexList = [];
        this.leafIndexList2 = [];
        _super.prototype.resize.call(this, this.leafIndexList, this.leafIndexList2);
    };
    /**
     *
     * 备注：容器转换横表
     * @param position: Position 相对于根容器的位置
     *
     */
    BaseThead.prototype.convert2TheadTopList = function (basePosition) {
        this.leafIndexList = [];
        this.resize(); // 如果list需要是源container(非克隆体) 解除注释
        var list = [];
        for (var i = 0; i < this.side2; i++) {
            list.push([]);
        }
        var p = baseClone(basePosition);
        this.children.forEach(function (child) {
            child.getTopList(list, p);
            p.rowNum = p.rowNum;
            p.colNum = p.colNum + child.side1;
        });
        return list;
    };
    // 转换成纵表
    BaseThead.prototype.convert2TheadLeftList = function (basePosition) {
        this.leafIndexList = [];
        this.resize();
        var list = [];
        var p = baseClone(basePosition);
        this.children.forEach(function (child, i) {
            if (i === 0) {
                list.push([]);
            }
            var tmpList = child.getLeftList(list, p);
            try {
                tmpList = JSON.stringify(tmpList) === '[[]]' ? [] : tmpList;
            }
            catch (error) {
                // do nothing
            }
            list = list.concat(tmpList);
            p.rowNum = p.rowNum + child.side1;
            p.colNum = p.colNum;
        });
        return list;
    };
    /**
     * merge
     */
    BaseThead.prototype.merge = function (targetContainerCopy) {
        var _this = this;
        var targetContainer = this.getContainerByTheadPosition(targetContainerCopy.theadPosition || []);
        targetContainer.mergeList = targetContainerCopy.mergeList;
        targetContainer.mergeList.forEach(function (th) {
            if (targetContainer.cell && th.cell) {
                var sourceContainer = _this.getContainerByTheadPosition(th.theadPosition);
                sourceContainer.style.display = 'none';
            }
        });
    };
    /**
     * disMerge
     */
    BaseThead.prototype.disMerge = function (targetContainerCopy) {
        var _this = this;
        var targetContainer = this.getContainerByTheadPosition(targetContainerCopy.theadPosition || []);
        targetContainer.mergeList = targetContainerCopy.mergeList;
        targetContainer.mergeList.forEach(function (th) {
            if (targetContainer.cell && th.cell) {
                var sourceContainer = _this.getContainerByTheadPosition(th.theadPosition);
                sourceContainer.style.display = 'table-cell';
            }
        });
    };
    BaseThead.prototype.getParentConatiner = function (positon) {
        var parentPostion = dropRight(positon, 1);
        return this.getContainerByTheadPosition(parentPostion);
    };
    BaseThead.prototype.resetDragOverStyle = function (targetDom, th) {
        BaseStyle.removeBorder(targetDom);
        BaseStyle.removeBackgroundColor(targetDom);
        BaseStyle.addBackgroundColor(targetDom, th.style.background);
    };
    return BaseThead;
}(TheadContainer_TheadContainer));


// CONCATENATED MODULE: ./packages/drag-table2.0/viewModule/container/TbodyContainer.ts



// 只有对于容器来说才有相对位置
var TbodyContainer_TbodyContainer = /** @class */ (function (_super) {
    __extends(TbodyContainer, _super);
    function TbodyContainer() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.children = new Array(); // 子容器
        _this.renderByThead = true;
        return _this;
    }
    /**
     * 设置tbody属性 部分特殊处理
     *
     * @param {ContainerInterface} containerData
     * @memberof TbodyContainer
     */
    TbodyContainer.prototype.setContainerData = function (containerData, containerData2, weight1, weight2) {
        for (var key in this) {
            if (this.hasOwnProperty(key)) {
                var value = this.getDataByWeight(key, containerData, containerData2, weight1, weight2);
                if (value === undefined) {
                    continue;
                }
                if (key === 'cell' && value) {
                    this.cell.setCellData(value);
                }
                else if (typeof value === 'object' && !Array.isArray(value) && key.indexOf('$') === -1) {
                    objectSet(this[key], value, 'union');
                }
                else {
                    this.setProperty(key, value);
                }
            }
        }
    };
    /**
     * parpare
     */
    TbodyContainer.prototype.getDataByWeight = function (key, data1, data2, weight1, weight2) {
        var dk1 = data1 ? (data1[key] || undefined) : undefined;
        var dk2 = data2 ? data2[key] || undefined : undefined;
        var wk1 = weight1 ? weight1[key] || undefined : undefined;
        var wk2 = weight2 ? weight2[key] || undefined : undefined;
        var resData;
        if (dk1 && dk2) {
            if (wk1 && wk2) {
                if (!isNaN(wk1) && !isNaN(wk2)) {
                    resData = wk1 > wk2 ? dk1 : dk2;
                }
                else if (!isNaN(wk1) && isNaN(wk1)) {
                    resData = dk1;
                }
                else if (isNaN(wk1) && !isNaN(wk1)) {
                    resData = dk2;
                }
                else if (typeof wk1 === 'object' && typeof wk2 === 'object') {
                    resData = {};
                    for (var sonKey in dk1) {
                        if (dk1.hasOwnProperty(sonKey) && !resData.hasOwnProperty(sonKey)) {
                            var sonValue = this.getDataByWeight(sonKey, dk1, dk2, wk1, wk2);
                            resData[sonKey] = sonValue;
                        }
                    }
                    for (var sonKey in dk2) {
                        if (dk2.hasOwnProperty(sonKey) && !resData.hasOwnProperty(sonKey)) {
                            var sonValue = this.getDataByWeight(sonKey, dk1, dk2, wk1, wk2);
                            resData[sonKey] = sonValue;
                        }
                    }
                }
            }
            else if (wk1 && !wk2) {
                resData = dk1;
            }
            else if (!wk1 && wk2) {
                resData = dk2;
            }
            else if (!wk1 && !wk2) {
                resData = dk1;
            }
        }
        else if (dk1 === undefined && dk2) {
            resData = dk2;
        }
        else if (dk1 && dk2 === undefined) {
            resData = dk1;
        }
        else if (dk1 === undefined && dk2 === undefined) {
            //
        }
        return resData;
    };
    return TbodyContainer;
}(CellContainer_CellContainer));


// CONCATENATED MODULE: ./packages/drag-table2.0/viewModule/tbody/BaseTbody.ts




var BaseTbody_BaseTbody = /** @class */ (function (_super) {
    __extends(BaseTbody, _super);
    // constructor(type?: any, root?: any) {
    //     super(type, 0, 0, root);
    //     this.$rootParent = this;
    // }
    function BaseTbody(param) {
        var _this = _super.call(this, param) || this;
        _this.topIndexList = new Array();
        _this.leftIndexList = new Array();
        _this.bodyData = {};
        //  表头变化
        _this.tbodySubject = new Subject();
        _this.$rootParent = _this;
        _this.cell = null;
        if (param.id) {
            _super.prototype.setConfig.call(_this, _this.$defaultConfig[param.id]);
            _this.setConfig(param.config);
        }
        return _this;
    }
    /**
     * subjectSend
     */
    BaseTbody.prototype.subjectSend = function (msg) {
        this.tbodySubject.sendMsg(msg);
    };
    /**
     * 添加一行数据
     *
     * @param {any[]} rowData
     * @returns
     * @memberof BaseTbody
     */
    BaseTbody.prototype.setRowData = function (leftId, rowData) {
        var _this = this;
        try {
            // console.log(this.topIndexList);
            leftId = leftId ? leftId : 'tbody_' + guid();
            var item = rowData || {};
            if (Array.isArray(item)) {
                item.forEach(function (value, j) {
                    var container = _this.createContain();
                    if (['string', 'number'].indexOf(typeof value) !== -1) {
                        container.cell.value = value;
                    }
                    else if (typeof value === 'object') {
                        container.setContainerData(value);
                    }
                    var topId = _this.topIndexList[j].id;
                    _this.setData(leftId, topId, container);
                });
            }
            else if (typeof item === 'object') {
                for (var topId in item) {
                    if (item.hasOwnProperty(topId)) {
                        var value = item[topId];
                        var container = this.createContain();
                        if (['string', 'number'].indexOf(typeof value) !== -1) {
                            container.cell.value = value;
                        }
                        else if (typeof value === 'object') {
                            container.setContainerData(value);
                        }
                        this.setData(leftId, topId, container);
                    }
                }
            }
            return leftId;
        }
        catch (error) {
            console.error('setRowData数据有误');
            console.error(error);
            return null;
        }
    };
    /**
     * addCol
     */
    BaseTbody.prototype.setColData = function (topId, colData) {
        var _this = this;
        try {
            topId = topId ? topId : 'tbody_' + guid();
            var item = colData || {};
            if (Array.isArray(item)) {
                item.forEach(function (value, j) {
                    var container = _this.createContain();
                    if (['string', 'number'].indexOf(typeof value) !== -1) {
                        container.cell.value = value;
                    }
                    else if (typeof value === 'object') {
                        container = value;
                    }
                    if (!_this.leftIndexList[j]) {
                        return;
                    }
                    var leftId = _this.leftIndexList[j].id;
                    _this.setData(leftId, topId, container);
                });
            }
            else if (typeof item === 'object') {
                for (var leftId in item) {
                    if (item.hasOwnProperty(leftId)) {
                        var value = item[leftId];
                        var container = this.createContain();
                        if (['string', 'number'].indexOf(typeof value) !== -1) {
                            container.cell.value = value;
                        }
                        else if (typeof value === 'object') {
                            container = value;
                        }
                        this.setData(leftId, topId, container);
                    }
                }
            }
            return topId;
        }
        catch (error) {
            console.error('setColData');
            console.error(error);
            return null;
        }
    };
    /**
     * setContainer
     */
    BaseTbody.prototype.setData = function (leftId, topId, containerData) {
        var container;
        try {
            var tmpTr = this.bodyData[leftId];
            if (!tmpTr) {
                this.bodyData[leftId] = tmpTr = {};
            }
            if (tmpTr[topId]) {
                tmpTr[topId].setContainerData(containerData);
            }
            else {
                tmpTr[topId] = this.createContain(containerData);
            }
            container = tmpTr[topId];
        }
        catch (error) {
            console.error(error);
        }
        return container;
    };
    /**
     * 设置tbody属性 部分特殊处理
     *
     * @param {CellContainerInterface} containerData
     * @memberof TbodyContainer
     */
    BaseTbody.prototype.setContainerData = function (containerData) {
        // debugger
        for (var key in containerData) {
            if (containerData.hasOwnProperty(key)) {
                var value = containerData[key];
                if (key === 'bodyData') {
                    for (var leftThId in value) {
                        if (value.hasOwnProperty(leftThId)) {
                            var rowData = value[leftThId];
                            this.setRowData(leftThId, rowData);
                        }
                    }
                }
                else if (typeof value === 'object' && !Array.isArray(value) && key.indexOf('$') === -1) {
                    objectSet(this[key], value, 'union');
                }
                else {
                    this.setProperty(key, value);
                }
            }
        }
    };
    /**
     * resize
     */
    BaseTbody.prototype.resize = function () {
        this.side1 = this.topIndexList.length;
        this.side2 = this.leftIndexList.length;
    };
    BaseTbody.prototype.initData = function (col, row) {
        // this.bodyData = [];
        for (var i = 0; i < row; i++) {
            this.setRowData();
        }
    };
    /**
     * 创建容器
     *
     * @private
     * @param {CellContainerInterface} data
     * @returns
     * @memberof BaseThead
     */
    BaseTbody.prototype.createContain = function (data) {
        var $positionManagerId = this.$positionManagerId;
        var $defConfigId = this.$defConfigId;
        var container = new TbodyContainer_TbodyContainer({
            type: 'tbody',
            side1: 1,
            side2: 1,
            $rootTable: this.$rootTable,
            $rootParent: this,
            $positionManagerId: $positionManagerId,
            $defConfigId: $defConfigId,
            config: this.$rootParent.config
        });
        if (data) {
            container.setContainerData(data);
        }
        return container;
    };
    /**
     * render
     */
    BaseTbody.prototype.render = function () {
        var _this = this;
        var leftIndexList = this.leftIndexList;
        var topIndexList = this.topIndexList;
        this.resize();
        leftIndexList.forEach(function (leftIndexTh) {
            var tmpTr = {};
            if (_this.bodyData.hasOwnProperty(leftIndexTh.id)) {
                tmpTr = _this.bodyData[leftIndexTh.id];
            }
            topIndexList.forEach(function (topIndexTh) {
                var container = _this.createContain();
                if (!tmpTr.hasOwnProperty(topIndexTh.id)) {
                    tmpTr[topIndexTh.id] = container;
                }
                else {
                    container = tmpTr[topIndexTh.id];
                }
                container.position = {
                    table: _this.$rootTable.position.table,
                    colNum: topIndexTh.theadPosition[0],
                    rowNum: leftIndexTh.theadPosition[0],
                    colStr: getA_Z(topIndexTh.theadPosition[0]),
                    rowStr: leftIndexTh.theadPosition[0] + 1,
                };
                container.id = [leftIndexTh.id, topIndexTh.id];
                _this.$positionManager.setPositionMap(container.position, container, 'source');
                var leftThead = leftIndexTh.$theadContainer;
                var topThead = topIndexTh.$theadContainer;
                var leftThTbdoyConfig = leftIndexTh.tbodyConfig.container;
                var topThTbdoyConfig = topIndexTh.tbodyConfig.container;
                // debugger
                var sumContainer;
                if (/sum/.test(leftIndexTh.id)) {
                    topThTbdoyConfig = null;
                    sumContainer = leftThead;
                }
                else if (/sum/.test(topIndexTh.id)) {
                    leftThTbdoyConfig = null;
                    sumContainer = topThead;
                }
                if ((/sum/.test(topIndexTh.id) || /sum/.test(leftIndexTh.id)) && ((leftIndexTh.canSum || topThead === undefined) && (topIndexTh.canSum || leftThead === undefined))) {
                    // const sumContainer = leftIndexTh.id.indexOf('sum') !== -1 ? leftIndexTh.$theadContainer : topIndexTh.$theadContainer;
                    var parentContainer = sumContainer.$rootParent.getContainerByTheadPosition(dropRight(sumContainer.theadPosition));
                    var containerList = new Array();
                    var count = 0;
                    for (var i = 0; i < last(sumContainer.theadPosition); i++) {
                        count += parentContainer.children[i].side1;
                    }
                    for (var i = 0; i < count; i++) {
                        if (sumContainer.type === 'top' && i) {
                            var stringPosition = getA_Z(sumContainer.position.colNum - (i) - 1) + container.position.rowStr;
                            containerList.push(stringPosition);
                        }
                        else {
                            var stringPosition = container.position.colStr + (sumContainer.position.rowNum - i);
                            containerList.push(stringPosition);
                        }
                    }
                    if (container.renderByThead) {
                        // container.cell.setProperty('value', ('=' + containerList.join('+')));
                        container.cell.value = ('=' + containerList.join('+'));
                    }
                }
                if (container.renderByThead == true) {
                    container.setContainerData(leftThTbdoyConfig, topThTbdoyConfig, leftIndexTh.tbodyConfig.weight, topIndexTh.tbodyConfig.weight);
                }
                // console.log(container.position.colStr + '' + container.position.rowStr + ':' + container.renderByThead);
                container.style.width = topIndexTh.style.width;
                container.style.height = leftIndexTh.style.height;
                container.cell.render();
                container.widthNum = Number(container.style.width.replace('px', ''));
                container.heightNum = Number(container.style.height.replace('px', ''));
            });
            _this.bodyData[leftIndexTh.id] = tmpTr;
        });
    };
    /**
     * getContainerById
     */
    BaseTbody.prototype.getContainerById = function (position) {
        var res = null;
        try {
            var leftId = position[0];
            var topId = position[1];
            if (this.bodyData.hasOwnProperty(leftId)) {
                var tmpTr = this.bodyData[leftId];
                if (tmpTr.hasOwnProperty(topId)) {
                    res = tmpTr[topId];
                }
            }
        }
        catch (error) {
            console.error('发生错误');
        }
        return res;
    };
    BaseTbody.prototype.convert = function () {
        var _this = this;
        var bodyData = new Array();
        this.leftIndexList.forEach(function (leftIndexTh) {
            if (_this.bodyData.hasOwnProperty(leftIndexTh.id)) {
                var tmpTr_1 = _this.bodyData[leftIndexTh.id];
                var trData_1 = new Array();
                _this.topIndexList.forEach(function (topIndexTh) {
                    if (tmpTr_1.hasOwnProperty(topIndexTh.id)) {
                        var td = tmpTr_1[topIndexTh.id];
                        trData_1.push(td);
                        _this.$positionManager.setPositionMap(td.position, td, 'clone');
                    }
                });
                bodyData.push(trData_1);
            }
        });
        return bodyData;
    };
    /**
     * 普通 list套object的输出
     *
     * @returns
     * @memberof BaseTbody
     */
    BaseTbody.prototype.output = function () {
        var _this = this;
        var res = new Array();
        this.leftIndexList.forEach(function (leftIndexTh) {
            if (_this.bodyData.hasOwnProperty(leftIndexTh.id)) {
                var tmpTr_2 = _this.bodyData[leftIndexTh.id];
                var trData_2 = {};
                _this.topIndexList.forEach(function (topIndexTh) {
                    if (tmpTr_2.hasOwnProperty(topIndexTh.id)) {
                        trData_2[topIndexTh.id] = (tmpTr_2[topIndexTh.id].cell.content);
                    }
                });
                res.push(trData_2);
            }
        });
        return res;
    };
    /**
     * 用于序列化中的导出
     *
     * @returns
     * @memberof BaseTbody
     */
    BaseTbody.prototype.output2 = function () {
        var _this = this;
        var res = {};
        this.leftIndexList.forEach(function (leftIndexTh) {
            if (_this.bodyData.hasOwnProperty(leftIndexTh.id)) {
                var tmpTr_3 = _this.bodyData[leftIndexTh.id];
                var trData_3 = {};
                _this.topIndexList.forEach(function (topIndexTh) {
                    if (tmpTr_3.hasOwnProperty(topIndexTh.id)) {
                        trData_3[topIndexTh.id] = tmpTr_3[topIndexTh.id].clone(['$']);
                    }
                });
                res[leftIndexTh.id] = (trData_3);
            }
        });
        return res;
    };
    /**
     *   重写 clone
     */
    BaseTbody.prototype.clone = function (exclude, keep, withFunction) {
        var object = {};
        exclude = exclude || [];
        exclude.push('bodyData');
        object = _super.prototype.clone.call(this, exclude, keep, withFunction);
        object.bodyData = this.output2();
        return object;
    };
    return BaseTbody;
}(TbodyContainer_TbodyContainer));


// CONCATENATED MODULE: ./packages/drag-table2.0/viewModule/container/IndexContainer.ts


var IndexContainer_IndexContainer = /** @class */ (function (_super) {
    __extends(IndexContainer, _super);
    function IndexContainer(param) {
        var _this = _super.call(this, param) || this;
        _this.positionCheck = false;
        _this.canSum = true;
        return _this;
    }
    /**
     * setSystemData
     */
    IndexContainer.prototype.update = function (th) {
        this.tbodyConfig = th.tbodyConfig;
        this.canSum = th.canSum;
        this.id = th.id || this.id;
        this.$theadContainer = th;
        // debugger;
        if (/left/.test(this.type)) {
            this.style.height = th.style.height;
        }
        else if (/top/.test(this.type)) {
            // debugger;
            this.style.width = th.style.width;
        }
    };
    return IndexContainer;
}(TheadContainer_TheadContainer));


// CONCATENATED MODULE: ./packages/drag-table2.0/viewModule/thead/IndexThead.ts





var IndexThead_IndexThead = /** @class */ (function (_super) {
    __extends(IndexThead, _super);
    function IndexThead(param) {
        var _this = _super.call(this, param) || this;
        _this.children = new Array();
        _this.indexTheadSubject = new Subject();
        _this.leafIndexList = []; // 叶子节点顺序列表
        _this.leafIndexList2 = []; // 叶子节点顺序列表
        if (param.id) {
            _super.prototype.setConfig.call(_this, _this.$defaultConfig[param.id]);
            _this.setConfig(param.config);
        }
        _this.$rootParent = _this;
        _this.cell = null;
        return _this;
    }
    /**
     * getContainerByTheadPosition
     * 备注：获得子容器
     * @param position: Position 相对于根容器的位置
     *
     */
    IndexThead.prototype.getContainerByTheadPosition = function (position) {
        var res = this;
        (position || []).forEach(function (index) {
            res = res.children[index];
        });
        return res;
    };
    /**
     * subjectSend
     */
    IndexThead.prototype.subjectSend = function (msg) {
        this.indexTheadSubject.sendMsg(msg);
    };
    /**
     * render
     */
    IndexThead.prototype.render = function () {
        var _this = this;
        this.resize();
        this.children.forEach(function (th, i) {
            th.position.table = _this.$rootTable.position.table;
            if (!th.id
            // || (th.id && th.id.indexOf('def_'))
            ) {
                th.id = 'def2.0_' + i;
            }
            if (th.cell) {
                if (th.type.indexOf('top') !== -1) {
                    th.position.colNum = i;
                    th.position.colStr = getA_Z(i);
                    th.position.rowStr = 0;
                    // th.cell.setProperty('value', _.getA_Z(i));
                    th.cell.value = getA_Z(i);
                }
                else if (th.type.indexOf('left') !== -1) {
                    // debugger
                    th.position.colStr = '@';
                    th.position.rowNum = i;
                    th.position.rowStr = i + 1;
                    // th.cell.setProperty('value', i + 1);
                    th.cell.value = i + 1;
                }
                if (_this.$rootTable.config.debugLevel === 1) {
                    // th.cell.setProperty('value', th.id);
                    th.cell.value = th.id;
                }
                else if (_this.$rootTable.config.debugLevel === 0) {
                    //
                }
                _this.$positionManager.setPositionMap(th.position, th, 'source');
                th.cell.render();
            }
        });
    };
    /**
     * 创建容器
     *
     * @private
     * @param {DragStartData} data
     * @returns
     * @memberof BaseThead
     */
    IndexThead.prototype.createContain = function (data) {
        // 此处是 IndexContainer 区别与TheadContaner;
        var $positionManagerId = this.$positionManagerId;
        var $defConfigId = this.$defConfigId;
        var container = new IndexContainer_IndexContainer({
            type: this.type, side1: 1, side2: 1,
            $rootParent: this.$rootParent,
            config: this.$rootParent.config,
            $rootTable: this.$rootTable,
            $defConfigId: $defConfigId,
            $positionManagerId: $positionManagerId,
        });
        // container.setConfig(this.$rootParent.config);
        if (data) {
            container.setContainerData(data);
        }
        if (!container.cell) {
            var cell = new BaseCell_BaseCell({ $parent: container });
            container.setCell(cell);
        }
        return container;
    };
    IndexThead.prototype.fastAddChild = function () {
        var container = this.createContain();
        this.addChild(container);
    };
    /**
     * convert
     */
    IndexThead.prototype.convert = function () {
        var _this = this;
        var res = new Array();
        this.children.forEach(function (th) {
            var copyTh = th.clone([], ['$'], true);
            _this.$positionManager.setPositionMap(copyTh.position, copyTh, 'clone');
            res.push(copyTh);
        });
        return res;
    };
    return IndexThead;
}(IndexContainer_IndexContainer));


// CONCATENATED MODULE: ./packages/drag-table2.0/viewModule/selectBox/SelectBox.ts
var SelectBox = /** @class */ (function () {
    function SelectBox(type, $TableContainer) {
        this.selectSet = new Set();
        this.selectList = new Array();
        this.size = 0;
        this.stlye = {
            position: 'absolute',
            zIndex: 98,
        };
        this.type = type;
        this.$TableContainer = $TableContainer;
    }
    /**
     * getInstance
     */
    SelectBox.getInstance = function (type, baseTable) {
        var instance = this.instances[type];
        if (!instance) {
            this.instances[type] = instance = new SelectBox(type, baseTable);
        }
        return instance;
    };
    /**
     * createSelectCell
     */
    SelectBox.prototype.createSelectContainer = function (dom, cellContainer) {
        var container = cellContainer.clone([], ['$', 'userData'], true);
        var zIndex = 98;
        switch (cellContainer.type) {
            case 'top':
                zIndex = 100;
                container.fixTop = true;
                break;
            case 'left':
                zIndex = 100;
                container.fixLeft = true;
                break;
            case 'tbody':
                zIndex = 96;
                break;
        }
        console.log('zIndex:' + zIndex);
        container.topStyle = {
            position: 'absolute',
            left: dom.offsetLeft + 'px',
            top: dom.offsetTop + 'px',
            width: dom.offsetWidth + 'px',
            borderBottom: '2px solid blue',
            boxSizing: 'border-box',
            zIndex: zIndex,
        };
        container.bottomStyle = {
            position: 'absolute',
            left: dom.offsetLeft + 'px',
            top: dom.offsetTop + dom.clientHeight + 'px',
            width: dom.offsetWidth + 'px',
            boxSizing: 'border-box',
            borderTop: '2px solid blue',
            zIndex: zIndex,
        };
        container.leftStyle = {
            position: 'absolute',
            left: dom.offsetLeft + 'px',
            top: dom.offsetTop + 'px',
            height: dom.offsetHeight + 'px',
            borderLeft: '2px solid blue',
            boxSizing: 'border-box',
            zIndex: zIndex,
        };
        container.rightStyle = {
            position: 'absolute',
            left: dom.offsetLeft + dom.clientWidth + 'px',
            top: dom.offsetTop + 'px',
            height: dom.offsetHeight + 'px',
            borderLeft: '2px solid blue',
            boxSizing: 'border-box',
            zIndex: zIndex,
        };
        var style = container.style;
        style.position = 'absolute';
        style.zIndex = zIndex;
        style.width = dom.offsetWidth + 'px';
        style.height = dom.offsetHeight + 'px';
        style.left = dom.offsetLeft + 'px';
        style.top = dom.offsetTop + 'px';
        return container;
    };
    /**
     * add
     */
    SelectBox.prototype.add = function (container) {
        this.currentCotanier = container;
        var res = this.selectSet.add(container);
        this.render();
        return res;
    };
    /**
     * has
     */
    SelectBox.prototype.has = function (container) {
        var hasSet = false;
        this.selectList.forEach(function (sc) {
            if (JSON.stringify(sc.id) === JSON.stringify(container.id)) {
                hasSet = true;
            }
        });
        return hasSet;
    };
    /**
     * delete
     */
    SelectBox.prototype.delete = function (container) {
        var res = this.selectSet.delete(container);
        this.render();
        return res;
    };
    SelectBox.prototype.clear = function () {
        this.currentCotanier = null;
        var res = this.selectSet.clear();
        this.render();
        return res;
    };
    /**
     * forEach
     */
    SelectBox.prototype.forEach = function (callbackfn, thisArg) {
        this.selectSet.forEach(callbackfn, thisArg);
    };
    /**
     * render
     */
    SelectBox.prototype.render = function () {
        this.selectList = Array.from(this.selectSet);
        this.size = this.selectList.length;
        // console.log( this.size );
    };
    /**
     * convert
     */
    SelectBox.prototype.convert = function () {
        return this.selectList;
    };
    SelectBox.instances = {};
    return SelectBox;
}());


// CONCATENATED MODULE: ./packages/drag-table2.0/viewModule/container/TableContainer.ts




var TableContainer_TableContainer = /** @class */ (function (_super) {
    __extends(TableContainer, _super);
    function TableContainer(param) {
        var _this = _super.call(this, param) || this;
        _this.$selectBoxId = param.$selectBoxId;
        _this.$selectBoxEntity = SelectBox.getInstance(_this.$selectBoxId, _this);
        return _this;
    }
    /**
     * 设置默认设置
     *
     * @public
     * @param {*} config
     * @memberof BaseTable
     */
    TableContainer.prototype.setDefaultConfig = function (config) {
        try {
            objectSet(this.$defaultConfig, config, 'union');
        }
        catch (error) {
            console.error('initDefaultConfig error');
        }
    };
    TableContainer.prototype.setConfig = function (config) {
        _super.prototype.setConfig.call(this, config);
        this.$selectBoxEntity.clear();
    };
    TableContainer.prototype.renderAll = function () {
        this.$positionManager.render();
    };
    return TableContainer;
}(BaseContainer_BaseContainer));


// CONCATENATED MODULE: ./packages/drag-table2.0/viewModule/table/BaseTable.ts









var BaseTable_BaseTable = /** @class */ (function (_super) {
    __extends(BaseTable, _super);
    function BaseTable(id, config) {
        var _this = _super.call(this, {
            id: id,
            $selectBoxId: (config && config.tableGroupId) ? config.tableGroupId : id,
            $defConfigId: (config && config.tableGroupId) ? config.tableGroupId : id,
            $positionManagerId: (config && config.tableGroupId) ? config.tableGroupId : id,
        }) || this;
        _this.position = {
            table: 0,
            colNum: 0,
            rowNum: 0,
        }; // 位置
        // 表格的总体样式
        _this.style = {
            scrollTop: 0,
            scrollLeft: 0,
            mainTable: {},
            topTable: {},
            leftTable: {}
        };
        _this.tableSubject = new Subject(); //  表格事件
        _this.tableName = ''; // 表表格名称名
        _this.showType = 0; // 表名显示类型
        _this.colNumber = new Array(); //  列标识：最上面'A', 'B', 'C', 'D'.....
        _this.rowNumber = new Array(); // 行标识: 最左边面1, 2, 3, 4, 5.....
        _this.tableHeadTop = new Array(); // 用于显示的上侧表头 直接用于上表头的渲染
        _this.tableHeadLeft = new Array(); // 用于显示的左侧表头 直接用于左表头的渲染
        _this.tableBody = new Array(); // 用于显示的表内容
        _this.tableHeadTopLeft = new TheadContainer_TheadContainer({ side1: 1, side2: 1, $rootTable: _this }); // 左上角空白单元格长宽
        _this.keyDownSet = new Set(); // 键盘按键按下状态的Set
        _this.$positionManager.add(_this);
        _this.setConfig(_this.$defaultConfig.table);
        _this.setConfig(config);
        _this.initial();
        return _this;
    }
    BaseTable.prototype.initial = function () {
        var $defConfigId = this.$defConfigId;
        var $positionManagerId = this.$positionManagerId;
        this.theadTopEntity = new BaseThead_BaseThead({ id: 'topThead', type: 'top', $defConfigId: $defConfigId, $positionManagerId: $positionManagerId, $rootTable: this, side1: 0, side2: 0 });
        this.theadLeftEntity = new BaseThead_BaseThead({ id: 'leftThead', type: 'left', $defConfigId: $defConfigId, $positionManagerId: $positionManagerId, $rootTable: this, side1: 0, side2: 0 });
        this.theadTopIndexEntity = new IndexThead_IndexThead({ id: 'topIndexThead', type: 'top-index', $defConfigId: $defConfigId, $positionManagerId: $positionManagerId, $rootTable: this, side1: 0, side2: 0 });
        this.theadLeftIndexEntity = new IndexThead_IndexThead({ id: 'leftIndexThead', type: 'left-index', $defConfigId: $defConfigId, $positionManagerId: $positionManagerId, $rootTable: this, side1: 0, side2: 0 });
        this.tbodyEntity = new BaseTbody_BaseTbody({ id: 'baseTbody', type: 'tbody', $defConfigId: $defConfigId, $positionManagerId: $positionManagerId, $rootTable: this, side1: 0, side2: 0 });
        var topLeftPositon = {
            table: this.position.table,
            colStr: 'A',
            rowStr: 1,
        };
        this.tableHeadTopLeft.position = topLeftPositon;
        this.initSubject(this);
    };
    /**
     * onDestroy
     */
    BaseTable.prototype.onDestroy = function () {
        var self = this;
        self.theadTopEntity.theadSubject.unsubscribe(self.onReceiveMsg, self);
        self.theadLeftEntity.theadSubject.subscribe(self.onReceiveMsg, self);
        self.tbodyEntity.tbodySubject.subscribe(self.onReceiveMsg, self);
    };
    /**
     * 初始化订阅事件 订阅表头变化
     *
     * @param {*} self
     * @memberof BaseTable
     */
    BaseTable.prototype.initSubject = function (self) {
        self = self || this;
        if (self.theadTopEntity) {
            self.theadTopEntity.theadSubject.subscribe(self.onReceiveMsg, self);
        }
        if (self.theadLeftEntity) {
            self.theadLeftEntity.theadSubject.subscribe(self.onReceiveMsg, self);
        }
        if (self.tbodyEntity) {
            self.tbodyEntity.tbodySubject.subscribe(self.onReceiveMsg, self);
        }
    };
    /**
     * subjectSend
     */
    BaseTable.prototype.subjectSend = function (msg) {
        this.tableSubject.sendMsg(msg);
    };
    /**
     * setConfig
     */
    BaseTable.prototype.setConfig = function (tableConfig) {
        _super.prototype.setConfig.call(this, tableConfig);
        var style = {
            // 主表样式
            mainTable: {
                overflow: this.config.isOverflow ? 'auto' : 'visible',
                maxWidth: !this.config.isOverflow ? 'auto' : this.config.maxWidth,
                maxHeight: !this.config.isOverflow ? 'auto' : this.config.maxHeight,
            },
            leftTable: {
                overflow: this.config.isOverflow ? 'hidden' : 'visible',
                height: !this.config.isOverflow ? 'auto' : 'calc(' + this.config.maxHeight + ' - 17px)',
            },
            // 上侧表头
            topTable: {
                overflow: this.config.isOverflow ? 'hidden' : 'visible',
                maxWidth: !this.config.isOverflow ? 'auto' : 'calc(' + this.config.maxWidth + ' - 17px)',
            },
        };
        objectSet(this.style, style, 'union');
    };
    /**
     * setConfig
     */
    BaseTable.prototype.setDefaultConfig = function (defConfig) {
        _super.prototype.setDefaultConfig.call(this, defConfig);
        this.setConfig(this.$defaultConfig.table);
        this.theadTopEntity.setConfig(this.$defaultConfig.topThead);
        this.theadLeftEntity.setConfig(this.$defaultConfig.leftThead);
        this.theadTopIndexEntity.setConfig(this.$defaultConfig.topIndexThead);
        this.theadLeftIndexEntity.setConfig(this.$defaultConfig.leftIndexThead);
        this.tbodyEntity.setConfig(this.$defaultConfig.baseTbody);
        this.render();
    };
    /**
     * initTable 初始化表格
     *
     * @param {number} width
     * @memberof BaseTable
     */
    BaseTable.prototype.initTable = function (width, height) {
        for (var colIndex = 0; colIndex < width; colIndex++) {
            this.theadTopIndexEntity.fastAddChild();
            this.theadAdd({
                type: 'top',
                targetParentPosition: [],
            });
        }
        height = height === undefined ? 1 : height;
        for (var i = 0; i < height; i++) {
            this.addOneRow();
        }
        this.renderAll();
        // this.render();
    };
    /**
     * addOneRow 添加一行数据
     *
     * @param {*} [rowData]
     * @memberof BaseTable
     */
    BaseTable.prototype.addOneRow = function (rowData, param) {
        var id = null;
        var needAddThead = false;
        var paramTheadAdd;
        var lastSelectContainer = this.$selectBoxEntity.currentCotanier;
        if (param) {
            paramTheadAdd = {
                type: 'left',
                targetParentPosition: param.targetParentPosition,
                insertIndex: param.insertIndex,
                sourceContainerData: param.sourceContainerData,
            };
            needAddThead = true;
        }
        else if (this.tableHeadLeft.length !== 0) {
            needAddThead = true;
        }
        if (lastSelectContainer) {
            var lastSCParam = void 0;
            if (/^left$/.test(lastSelectContainer.type)) {
                lastSCParam = {
                    type: 'left',
                    targetParentPosition: dropRight(lastSelectContainer.theadPosition),
                    insertIndex: last(lastSelectContainer.theadPosition) + 1
                };
            }
            else {
                var leftIndexContainer = this.getLeftIndexContainer(lastSelectContainer.position);
                if (leftIndexContainer && leftIndexContainer.$theadContainer) {
                    var leftContainer = leftIndexContainer.$theadContainer;
                    lastSCParam = {
                        type: 'left',
                        targetParentPosition: dropRight(leftContainer.theadPosition),
                        insertIndex: last(leftContainer.theadPosition) + 1
                    };
                }
            }
            paramTheadAdd = objectSet(lastSCParam, paramTheadAdd, 'union');
        }
        else {
            var defParam = {
                type: 'left',
                targetParentPosition: [],
            };
            paramTheadAdd = objectSet(defParam, paramTheadAdd, 'union');
        }
        // addTbody
        if (needAddThead) {
            id = this.theadAdd(paramTheadAdd);
        }
        var container = this.theadLeftIndexEntity.createContain();
        this.theadLeftIndexEntity.addChild(container);
        id = this.tbodyEntity.setRowData(id, rowData || {});
        container.id = id;
        this.renderAll();
        return id;
    };
    /**
     * addOneCol 添加一列数据
     *
     * @param {*} [rowData]
     * @memberof BaseTable
     */
    BaseTable.prototype.addOneCol = function (colData, param) {
        var id = null;
        var needAddThead = false;
        var paramTheadAdd;
        var lastSelectContainer = this.$selectBoxEntity.currentCotanier;
        if (param) {
            paramTheadAdd = {
                type: 'top',
                targetParentPosition: param.targetParentPosition,
                insertIndex: param.insertIndex,
                sourceContainerData: param.sourceContainerData,
            };
            needAddThead = true;
        }
        else if (this.tableHeadTop.length !== 0) {
            needAddThead = true;
        }
        if (lastSelectContainer) {
            var lastSCParam = void 0;
            if (/^top$/.test(lastSelectContainer.type)) {
                lastSCParam = {
                    type: 'top',
                    targetParentPosition: dropRight(lastSelectContainer.theadPosition),
                    insertIndex: last(lastSelectContainer.theadPosition) + 1
                };
            }
            else if (/^tbody$/.test(lastSelectContainer.type)) {
                var topIndexContainer = this.getTopIndexContainer(lastSelectContainer.position);
                if (topIndexContainer && topIndexContainer.$theadContainer) {
                    var topContainer = topIndexContainer.$theadContainer;
                    lastSCParam = {
                        type: 'top',
                        targetParentPosition: dropRight(topContainer.theadPosition),
                        insertIndex: last(topContainer.theadPosition) + 1
                    };
                }
            }
            paramTheadAdd = objectSet(lastSCParam, paramTheadAdd, 'union');
        }
        else {
            var defParam = {
                type: 'top',
                targetParentPosition: [],
            };
            paramTheadAdd = objectSet(defParam, paramTheadAdd, 'union');
        }
        if (needAddThead) {
            id = this.theadAdd(paramTheadAdd);
        }
        var container = this.theadTopIndexEntity.createContain();
        id = this.tbodyEntity.setColData(id, colData || {});
        container.id = id;
        this.theadTopIndexEntity.addChild(container);
        this.renderAll();
        return id;
    };
    /**
     * setTBodyData
     */
    BaseTable.prototype.setTbodyData = function (data) {
        var _this = this;
        try {
            if (Array.isArray(data)) {
                data.forEach(function (rowData, i) {
                    var leftId = _this.tbodyEntity.leftIndexList[i].id;
                    _this.tbodyEntity.setRowData(leftId, rowData);
                });
            }
            else if (typeof data === 'object') {
                for (var leftId in data) {
                    if (data.hasOwnProperty(leftId)) {
                        this.tbodyEntity.setRowData(leftId, data[leftId]);
                    }
                }
            }
        }
        catch (error) {
            console.error(error);
            console.error('输入数据格式有误');
        }
        this.renderAll();
    };
    /**
     * 表头添加并替换
     *
     * @param {ParamTheadAddReplace} param
     * @memberof BaseTable
     */
    BaseTable.prototype.theadAddPlace = function (param, sendMsg) {
        var targetContainerPosition = param.targetContainerPosition;
        var targetThead = this.getEntity(param.type);
        var targetIndexPosition = last(targetContainerPosition);
        var targetParentPosition = dropRight(targetContainerPosition);
        var targetParentContainer = targetThead.getContainerByTheadPosition(targetParentPosition);
        if (param.sourceContainerData) {
            var tmpContainer = targetThead.createContain(param.sourceContainerData);
            targetParentContainer.replaceChild(tmpContainer, targetIndexPosition, param.withChildren);
        }
        if (sendMsg !== false) {
            this.onReceiveMsg({
                ev_type: 'theadAddPlace',
                event: null,
                data: {
                    objectName: 'ParamTheadAddReplace',
                    object: param
                }
            });
        }
    };
    /**
     * 表头添加
     *
     * @param {ParamTheadAdd} param
     * @memberof BaseTable
     */
    BaseTable.prototype.theadAdd = function (param, sendMsg) {
        var id = null;
        try {
            if (!param.sourceContainerData) {
                param.sourceContainerData = {
                    cell: {
                        value: '',
                    },
                };
            }
            var targetThead = this.getEntity(param.type);
            var targetParentContainer = targetThead.getContainerByTheadPosition(param.targetParentPosition);
            var tmpContainer = targetThead.createContain(param.sourceContainerData);
            id = targetParentContainer.addChild(tmpContainer, param.insertIndex);
            targetThead.resize();
            if (sendMsg !== false) {
                this.onReceiveMsg({
                    ev_type: 'theadAdd',
                    event: null,
                    data: {
                        objectName: 'ParamTheadAdd',
                        object: param
                    }
                });
            }
        }
        catch (error) {
            console.error(error);
            this.onReceiveMsg({
                ev_type: 'error',
                event: null,
                data: {
                    objectName: 'error',
                    object: error
                }
            });
        }
        return id;
    };
    /**
     * 表头移动
     *
     * @param {ParamTheadMove} param
     * @memberof BaseTable
     */
    BaseTable.prototype.theadMove = function (param, sendMsg) {
        try {
            var souceIndexPosition = last(param.sourceContainerData.theadPosition);
            var souceParentPosition = dropRight(param.sourceContainerData.theadPosition);
            if (param.sourceContainerData) {
                var targetThead = this.getEntity(param.type);
                var targetParentContainer = targetThead.getContainerByTheadPosition(param.targetParentPosition);
                var sourceThead = this.getEntity(param.sourceContainerData.type);
                var sourceParentContainer = sourceThead.getContainerByTheadPosition(souceParentPosition);
                // const tmpContainer = sourceThead.createContain(param.sourceContainerData);
                var sourceContainer = sourceThead.getContainerByTheadPosition(param.sourceContainerData.theadPosition);
                if (JSON.stringify(souceParentPosition) === JSON.stringify(param.targetParentPosition) && souceIndexPosition > param.insertIndex) {
                    // 如果目标容器和源容器在同一个父级容器下，且源容器index小于目标容器index 则先删除源容器 再添加源容器的拷贝
                    sourceParentContainer.deletChild(souceIndexPosition, 1, param.withChildren);
                    targetParentContainer.addChild(sourceContainer, param.insertIndex);
                }
                else {
                    // 反之先添加源容器的拷贝 再删除除源容器
                    targetParentContainer.addChild(sourceContainer, param.insertIndex);
                    sourceParentContainer.deletChild(souceIndexPosition, 1, param.withChildren);
                }
                if (!param.withChildren) {
                    sourceContainer.children = new Array();
                }
                targetThead.resize();
                sourceThead.resize();
            }
            if (sendMsg !== false) {
                this.onReceiveMsg({
                    ev_type: 'theadMove',
                    event: null,
                    data: {
                        objectName: 'ParamTheadMove',
                        object: param
                    }
                });
            }
        }
        catch (error) {
            this.onReceiveMsg({
                ev_type: 'error',
                event: null,
                data: {
                    objectName: 'theadMove',
                    object: error
                }
            });
        }
    };
    /**
     * 表头删除
     *
     * @param {ParamTheadDelete} param
     * @memberof BaseTable
     */
    BaseTable.prototype.theadDelete = function (param, sendMsg) {
        try {
            var targetContainerPosition = void 0;
            var targetIndexPosition = void 0;
            var targetParentPosition = void 0;
            var theadType = void 0;
            var withChildren = false;
            var canDel = false;
            var lastSelectContainer = this.$selectBoxEntity.currentCotanier;
            if (param) {
                targetIndexPosition = last(param.targetContainerPosition);
                targetParentPosition = dropRight(param.targetContainerPosition);
                targetContainerPosition = param.targetContainerPosition;
                theadType = param.type;
                withChildren = param.withChildren;
                canDel = true;
            }
            if (lastSelectContainer) {
                targetIndexPosition = targetIndexPosition !== undefined ? targetIndexPosition : last(lastSelectContainer.theadPosition);
                targetParentPosition = targetParentPosition !== undefined ? targetParentPosition : dropRight(lastSelectContainer.theadPosition);
                targetContainerPosition = targetContainerPosition !== undefined ? targetContainerPosition : lastSelectContainer.theadPosition;
                theadType = theadType || lastSelectContainer.type;
                canDel = true;
            }
            // addTbody
            if (canDel) {
                var targetThead = this.getEntity(theadType);
                var deleteContainer = targetThead.getContainerByTheadPosition(targetContainerPosition);
                var targetParentContainer = targetThead.getContainerByTheadPosition(targetParentPosition);
                targetParentContainer.deletChild(targetIndexPosition, 1, withChildren);
                targetThead.resize();
                if (sendMsg !== false) {
                    this.onReceiveMsg({
                        ev_type: 'theadDelete',
                        event: null,
                        data: {
                            objectName: 'ParamTheadDelete',
                            object: param
                        }
                    });
                }
            }
            else {
                console.error('theadDelete 未传入参数');
            }
        }
        catch (error) {
            this.onReceiveMsg({
                ev_type: 'error',
                event: null,
                data: {
                    objectName: 'theadDelete',
                    object: error
                }
            });
        }
    };
    /**
     * 表头移动并覆盖
     *
     * @param {ParamTheadMoveReplace} param
     * @memberof BaseTable
     */
    BaseTable.prototype.theadMoveReplace = function (param, sendMsg) {
        try {
            var targetContainerPosition = param.targetContainerPosition;
            var targetIndexPosition = last(targetContainerPosition);
            var targetParentPosition = dropRight(targetContainerPosition);
            var targetThead = this.getEntity(param.type);
            var targetParentContainer = targetThead.getContainerByTheadPosition(targetParentPosition);
            var souceIndexPosition = last(param.sourceContainerData.theadPosition);
            var souceParentPosition = dropRight(param.sourceContainerData.theadPosition);
            var sourceThead = this.getEntity(param.sourceContainerData.type);
            var sourceParentContainer = sourceThead.getContainerByTheadPosition(souceParentPosition);
            if (param.sourceContainerData) {
                if (!param.withChildren) {
                    param.sourceContainerData.children = new Array();
                }
                var tmpContainer = targetThead.createContain(param.sourceContainerData);
                targetParentContainer.replaceChild(tmpContainer, targetIndexPosition, false);
                sourceParentContainer.deletChild(souceIndexPosition, 1, param.withChildren);
                targetThead.resize();
                if (sourceThead !== targetThead) {
                    sourceThead.resize();
                }
                if (sendMsg !== false) {
                    this.onReceiveMsg({
                        ev_type: 'theadMoveReplace',
                        event: null,
                        data: {
                            objectName: 'ParamTheadMoveReplace',
                            object: param
                        }
                    });
                }
            }
        }
        catch (error) {
            this.onReceiveMsg({
                ev_type: 'error',
                event: null,
                data: {
                    objectName: 'theadMoveReplace',
                    object: error
                }
            });
        }
    };
    /**
     * addSum
     */
    BaseTable.prototype.addSum = function (newParentContainData, param) {
        var mustContainerData = {
            tbodyConfig: {
                container: {
                    cell: {
                        displayClass: {
                            normal: {
                                displayType: 'text',
                            },
                            dbclick: {
                                displayType: 'text',
                            }
                        }
                    }
                }
            },
            id: 'sum' + '_' + guid(),
            canSum: true,
        };
        var addParam = {
            sourceContainerData: {
                cell: {
                    value: '合计',
                }
            }
        };
        objectSet(addParam.sourceContainerData, newParentContainData, 'union');
        if (param) {
            objectSet(addParam, param, 'union');
        }
        var lastSelectContainer = this.$selectBoxEntity.currentCotanier;
        if ((lastSelectContainer && /^top$|^left$/.test(lastSelectContainer.type))) {
            var lSCParam = {
                type: lastSelectContainer.type,
                targetParentPosition: dropRight(lastSelectContainer.theadPosition),
                sourceContainerData: addParam.sourceContainerData,
            };
            objectSet(addParam, lSCParam, 'union');
        }
        objectSet(addParam.sourceContainerData, mustContainerData, 'union');
        this.theadAdd(addParam);
        this.renderAll();
    };
    /**
     *
     *
     * @param {CellContainer} contianer
     * @param {string} delType  'row' | 'col'
     * @memberof BaseTable
     */
    BaseTable.prototype.delOneRowCol = function (delType, container) {
        var _this = this;
        var lastSelectContainer = this.$selectBoxEntity.currentCotanier;
        container = container || lastSelectContainer;
        var delContainerWithParentWhoHasNoChild = function (delContainer) {
            var Entity = _this.getEntity(delContainer.type);
            var parentContainer = Entity.getContainerByTheadPosition(dropRight(delContainer.theadPosition));
            _this.theadDelete({
                type: delContainer.type,
                targetContainerPosition: delContainer.theadPosition,
                withChildren: true
            });
            if (parentContainer.children.length === 0 && !parentContainer.isRootParent) {
                delContainerWithParentWhoHasNoChild(parentContainer);
            }
        };
        var needDelTheadContainer;
        var type = delType === 'row' ? 'left' : 'top';
        if (container.type === 'tbody') {
            var tbodyContainer = this.getContainer(container.position);
            // 删除index
            var delIndex = type === 'left' ? tbodyContainer.position.rowNum : tbodyContainer.position.colNum;
            var IndexEntity = this.getEntity(type + '-index');
            var indexContainer = IndexEntity.getContainerByTheadPosition([delIndex]);
            needDelTheadContainer = indexContainer.$theadContainer;
            if (!needDelTheadContainer) {
                this.theadDelete({
                    type: (type + '-index'),
                    targetContainerPosition: indexContainer.theadPosition
                });
            }
        }
        else {
            needDelTheadContainer = container;
            var position = container.position;
            var colObj = this.$positionManager.getColObj(position);
            for (var rowStr in colObj) {
                if (colObj.hasOwnProperty(rowStr)) {
                    // const parentPosition = _.dropRight(delContainer.theadPosition);
                    // this.processThead(type, 'delete', [], undefined, position.colNum);
                }
            }
            var topIndexContainer = needDelTheadContainer.getTopIndexContainer(needDelTheadContainer.position);
            var leftIndexContainer = needDelTheadContainer.getLeftIndexContainer(needDelTheadContainer.position);
            if (topIndexContainer && delType === 'col') {
                this.theadDelete({
                    type: ('top-index'),
                    targetContainerPosition: topIndexContainer.theadPosition
                });
            }
            if (leftIndexContainer && delType === 'row') {
                this.theadDelete({
                    type: ('left-index'),
                    targetContainerPosition: leftIndexContainer.theadPosition
                });
            }
        }
        if (needDelTheadContainer) {
            delContainerWithParentWhoHasNoChild(needDelTheadContainer);
        }
        this.renderAll();
    };
    /**
     * 获得表头实体
     *
     * @protected
     * @param {string} type
     * @returns
     *
     */
    BaseTable.prototype.getEntity = function (type) {
        switch (type) {
            case 'top': return this.theadTopEntity;
            case 'left': return this.theadLeftEntity;
            case 'top-index': return this.theadTopIndexEntity;
            case 'left-index': return this.theadLeftIndexEntity;
            case 'tbody': return this.tbodyEntity; // 双击编辑表格时 为了统一失去焦点后的函数
            default:
                console.log('getEntity-default');
                return this.theadTopEntity;
        }
    };
    /**
     * getTbodyData 根据outPutType输出tbody数据
     *
     * @param {number} [outPutType]
     * @returns
     * @memberof BaseTable
     */
    BaseTable.prototype.getTbodyData = function (outPutType) {
        var res = {};
        switch (outPutType) {
            case 0:
                res = this.tbodyEntity.output();
                break;
            default:
                res = this.tbodyEntity.output();
        }
        // console.log(res);
        return res;
    };
    /**
     * 渲染表格渲染
     *
     * @memberof BaseTable
     */
    BaseTable.prototype.render = function () {
        this.resizeTable();
        this.indexTheadRender();
        var theadTopHeight = this.theadTopEntity.side2;
        var theadLeftWidth = this.theadLeftEntity.side2;
        if (this.theadTopEntity) {
            var topBasePosition = baseClone(this.position);
            topBasePosition.colNum = theadLeftWidth;
            topBasePosition.rowNum = 0;
            this.tableHeadTop = this.theadTopEntity.convert2TheadTopList(topBasePosition);
        }
        if (this.config.hasLeftThead) {
            var leftBasePosition = baseClone(this.position);
            leftBasePosition.colNum = 0;
            leftBasePosition.rowNum = theadTopHeight;
            this.tableHeadLeft = this.theadLeftEntity.convert2TheadLeftList(leftBasePosition);
        }
        var topLeftCell = new BaseCell_BaseCell({ value: this.id, $parent: this.tableHeadTopLeft });
        this.tableHeadTopLeft.style.width = this.theadLeftEntity.widthNum + 'px';
        this.tableHeadTopLeft.widthNum = this.theadLeftEntity.widthNum;
        this.tableHeadTopLeft.style.height = this.theadTopEntity.heightNum + 'px';
        this.tableHeadTopLeft.heightNum = this.theadTopEntity.heightNum;
        this.tableHeadTopLeft.setCell(topLeftCell);
        topLeftCell.render();
        if (theadTopHeight > 0 && theadLeftWidth > 0) {
            this.$positionManager.setPositionMap(this.tableHeadTopLeft.position, this.tableHeadTopLeft, 'source');
            this.$positionManager.setPositionMap(this.tableHeadTopLeft.position, this.tableHeadTopLeft, 'clone');
        }
        this.renderTBody();
        this.$selectBoxEntity.clear();
        // debugger
        this.saveLastPositionMap(this.position);
    };
    /**
     * serialize 序列化
     */
    BaseTable.prototype.serialize = function () {
        var Table = {};
        try {
            for (var key in this) {
                if (this.hasOwnProperty(key)) {
                    // console.log(key);
                    var value = this[key];
                    if (Array.isArray(value) || /\$/.test(key)) {
                        continue;
                    }
                    else if (typeof value === 'object') {
                        if (key.indexOf('Subject') !== -1) {
                            continue;
                        }
                        else if ((key === 'keyDownSet')) {
                            // Table[key] = Array.from(this[key] as any);
                        }
                        else if (value.EPI_READY) {
                            Table[key] = value.clone(['Subject', '$'], ['userData']);
                        }
                        else {
                            Table[key] = this[key];
                        }
                    }
                    else {
                        Table[key] = this[key];
                    }
                }
            }
        }
        catch (error) {
            console.error('serialize 中出现出错');
            console.error(error);
        }
        return Table;
    };
    /**
     * deserialize 反序列化
     */
    BaseTable.prototype.deserialize = function (tableJson) {
        var copyJson = baseClone(tableJson);
        var self = this;
        try {
            for (var key in copyJson) {
                if (copyJson.hasOwnProperty(key)) {
                    var val = copyJson[key];
                    if (val.EPI_READY) {
                        self[key].setContainerData(val);
                    }
                    else if (key === '$selectBoxEntity' || key === 'keyDownSet') {
                        // self[key] = new Set((tableJson as any)[key]);
                    }
                    else {
                        self[key] = val;
                    }
                }
            }
            this.renderAll();
        }
        catch (error) {
            console.error('Deserialize 中出现出错');
            console.error(error);
        }
    };
    /**
     *  添加父级
     *
     * @returns
     * @memberof BaseTable
     */
    BaseTable.prototype.addParent = function (newParentContainData) {
        var _this = this;
        var fristContainer;
        if (this.$selectBoxEntity.size > 0) {
            var containerList = this.$selectBoxEntity.selectList;
            fristContainer = containerList[0];
            var isSameParent = this.isSameParent(containerList);
            if (isSameParent && fristContainer) {
                var theadEntity = this.getEntity(fristContainer.type);
                if (theadEntity === null) {
                    return;
                }
                var sourceContainerList_1 = new Array();
                this.$selectBoxEntity.forEach(function (th) {
                    sourceContainerList_1.push(_this.getContainer(th.position));
                });
                // 按position从大到小排序 目的是先删除position大的
                sourceContainerList_1.sort(function (a, b) {
                    return last(b.theadPosition) - last(a.theadPosition);
                });
                // console.log(sourceContainerList);
                // 添加在第一个选中th位置上
                // debugger
                fristContainer = last(sourceContainerList_1);
                var targetParentPosition = dropRight(fristContainer.theadPosition, 1);
                newParentContainData = newParentContainData || {
                    cell: {
                        value: '新建合计',
                        data: '',
                    },
                };
                var tmpContainer_1 = theadEntity.createContain(newParentContainData);
                sourceContainerList_1.forEach(function (th) {
                    tmpContainer_1.addChild(th, 0);
                    _this.theadDelete({
                        type: fristContainer.type,
                        targetContainerPosition: th.theadPosition,
                        withChildren: true
                    });
                });
                this.theadAdd({
                    type: fristContainer.type,
                    targetParentPosition: targetParentPosition,
                    insertIndex: last(fristContainer.theadPosition),
                    sourceContainerData: tmpContainer_1,
                });
                // debugger
                this.renderAll();
            }
        }
        this.$selectBoxEntity.clear();
    };
    /**
     * 按键抬起
     *
     * @param {*} ev
     * @memberof BaseTable
     */
    BaseTable.prototype.onKeyUp = function (ev) {
        this.keyDownSet.delete(ev.key);
    };
    /**
     * 按键按下
     *
     * @param {*} ev
     * @memberof BaseTable
     */
    BaseTable.prototype.onKeyDown = function (ev) {
        console.log(ev.key);
        this.keyDownSet.add(ev.key);
    };
    /**
     * dragLeave
     */
    BaseTable.prototype.dragLeave = function (ev, th) {
        var type = th.type.indexOf('top') !== -1 ? 'top' : 'left';
        var theadEntity = this.getEntity(type);
        theadEntity.dragLeave(ev, th);
    };
    /**
     * dragStart 事件
     */
    BaseTable.prototype.dragStart = function (ev, th) {
        var theadEntity = this.getEntity(th.type);
        var dragStartData = {
            operationType: 'move',
            containerData: th,
        };
        theadEntity.dragStart(ev, dragStartData);
    };
    /**
     * dragEnd
     */
    BaseTable.prototype.dragEnd = function (ev, th) {
        var theadEntity = this.getEntity(th.type);
        theadEntity.dragStartData = null;
    };
    /**
     * dragOver事件
     */
    BaseTable.prototype.dragOver = function (ev, th) {
        if (th) {
            var type = th.type.indexOf('top') !== -1 ? 'top' : 'left';
            var theadEntity = this.getEntity(type);
            if (theadEntity.dragStartData) {
                // 悬停在自己上面 不处理
                if (th !== theadEntity.dragStartData.containerData) {
                    theadEntity.dragOver(ev, th);
                }
            }
            else {
                theadEntity.dragOver(ev, th);
            }
        }
        else {
            ev.preventDefault();
        }
    };
    /**
     * 拖拽drop事件
     */
    BaseTable.prototype.drop = function (ev, th) {
        if (th) {
            var type = th.type.indexOf('top') !== -1 ? 'top' : 'left';
            var theadEntity = this.getEntity(type);
            theadEntity.drop(ev, th);
        }
    };
    /**
     * getTheadLe
     */
    BaseTable.prototype.getTheadLeavesList1 = function (theadType) {
        var res = null;
        try {
            var Entity = this.getEntity(theadType);
            res = Entity.leafIndexList;
        }
        catch (error) {
            console.error('获取错误');
        }
        return res;
    };
    /**
     * 合并单元格
     *
     * @protected
     * @memberof BaseTable
     */
    BaseTable.prototype.merge = function () {
        var _this = this;
        if (this.canMerge()) {
            var r = window.confirm('合并单元格时只保留左上单元格，删除其他单元格，确定合并？');
            if (r === true) {
                this.$selectBoxEntity.selectList.sort(function (pre, lat) {
                    return last(lat.theadPosition) - last(pre.theadPosition);
                });
                this.$selectBoxEntity.selectList.forEach(function (container, i) {
                    if (i < _this.$selectBoxEntity.selectList.length - 1) {
                        _this.theadDelete({
                            targetContainerPosition: container.theadPosition,
                            type: container.type
                        });
                    }
                });
                this.renderAll();
            }
            else {
                return;
            }
        }
    };
    /**
     * 拆分单元格
     *
     * @protected
     * @memberof BaseTable
     */
    BaseTable.prototype.disMerge = function () {
        var _this = this;
        this.$selectBoxEntity.forEach(function (th, i) {
            if (th.mergeList.length > 0) {
                var theadEntity = _this.getEntity(th.type);
                theadEntity.disMerge(th);
            }
        });
        this.$selectBoxEntity.clear();
        this.renderAll();
    };
    /**
     * 判断是否符合合并要求
     *
     * @private
     * @returns
     * @memberof BaseTable
     */
    BaseTable.prototype.canMerge = function () {
        var containerList = this.$selectBoxEntity.selectList;
        var isSameParent = this.isSameParent(containerList);
        return isSameParent;
    };
    /**
     * 滚动事件 调整scrollTop scrollLeft
     *
     * @private
     * @param {*} ev
     * @memberof BaseTable
     */
    BaseTable.prototype.onScroll = function (ev) {
        this.style.scrollTop = ev.srcElement.scrollTop;
        this.style.scrollLeft = ev.srcElement.scrollLeft;
    };
    /**
     * 渲染表格内容
     *
     * @memberof DefaultTable
     */
    BaseTable.prototype.renderTBody = function () {
        this.tbodyEntity.topIndexList = this.colNumber.slice(0 + this.theadLeftEntity.side2, this.colNumber.length);
        if (this.config.hasLeftThead) {
            this.tbodyEntity.leftIndexList = this.rowNumber.slice(0 + this.theadTopEntity.side2, this.rowNumber.length);
        }
        else {
            this.tbodyEntity.leftIndexList = this.rowNumber.slice(0 + this.theadTopEntity.side2, this.rowNumber.length);
        }
        this.tbodyEntity.render();
        this.tableBody = this.tbodyEntity.convert();
    };
    /**
     * 保证table 表头与表内容长宽高一致 并且创建行、列标志数组
     *
     * @memberof DefaultTable
     */
    BaseTable.prototype.resizeTable = function () {
        var _this = this;
        this.theadTopEntity.resize();
        this.theadLeftEntity.resize();
        this.theadTopIndexEntity.resize();
        this.theadLeftIndexEntity.resize();
        var maxWidth;
        var maxHeight;
        var theadTopWidth = this.theadTopEntity.side1;
        var theadTopHeight = this.theadTopEntity.side2;
        var theadLeftHeight = this.theadLeftEntity.side1;
        var theadLeftWidth = this.theadLeftEntity.side2;
        var topIndexWidth = this.theadTopIndexEntity.side1;
        var leftIndexHeight = this.theadLeftIndexEntity.side1;
        var resizeTableWidth = function () {
            if (theadTopWidth > 0) {
                _this.theadTopIndexEntity.deletChild(theadLeftWidth, topIndexWidth, true);
                _this.theadTopIndexEntity.resize();
                topIndexWidth = _this.theadTopIndexEntity.side1;
                _this.theadTopEntity.leafIndexList.forEach(function (th, i) {
                    var index = i + theadLeftWidth;
                    var container = _this.theadTopIndexEntity.createContain();
                    var thContainer = _this.theadTopEntity.getContainerByTheadPosition(th.theadPosition);
                    container.update(th);
                    thContainer.$IndexContainer = container;
                    if (index + 1 > topIndexWidth) {
                        _this.theadTopIndexEntity.addChild(container);
                    }
                    else {
                        _this.theadTopIndexEntity.replaceChild(container, index);
                    }
                });
            }
            else {
                _this.theadTopIndexEntity.children.forEach(function (th, i) {
                    if (i + 1 <= theadLeftWidth) {
                        var theadContainer = _this.theadLeftEntity.leafIndexList2[i];
                        var container = _this.theadTopIndexEntity.createContain();
                        container.update(theadContainer);
                        if (/tbody/.test(th.id)) {
                            _this.theadTopIndexEntity.addChild(container, i);
                        }
                        else {
                            _this.theadTopIndexEntity.replaceChild(container, i);
                        }
                    }
                    else if ((i + 1) > theadLeftWidth && !/tbody/.test(th.id)) {
                        _this.theadTopIndexEntity.deletChild(i, 1, true);
                    }
                });
            }
        };
        var resizeTableHeight = function () {
            if (theadLeftHeight > 0) {
                _this.theadLeftIndexEntity.deletChild(theadTopHeight, leftIndexHeight, true);
                _this.theadLeftIndexEntity.resize();
                leftIndexHeight = _this.theadLeftIndexEntity.side1;
                // console.log(this.theadLeftEntity);
                _this.theadLeftEntity.leafIndexList.forEach(function (th, i) {
                    var index = i + theadTopHeight;
                    var container = _this.theadLeftIndexEntity.createContain();
                    // console.log(this.theadLeftEntity);
                    var thContainer = _this.theadLeftEntity.getContainerByTheadPosition(th.theadPosition);
                    thContainer.$IndexContainer = container;
                    container.update(th);
                    if (index + 1 > leftIndexHeight) {
                        _this.theadLeftIndexEntity.addChild(container);
                    }
                    else {
                        _this.theadLeftIndexEntity.replaceChild(container, index);
                    }
                });
            }
            else {
                _this.theadLeftIndexEntity.children.forEach(function (th, i) {
                    if (i + 1 <= theadTopHeight) {
                        var theadContainer = _this.theadTopEntity.leafIndexList2[i];
                        var container = _this.theadLeftIndexEntity.createContain();
                        container.update(theadContainer);
                        if (/tbody/.test(th.id)) {
                            _this.theadLeftIndexEntity.addChild(container, i);
                        }
                        else {
                            _this.theadLeftIndexEntity.replaceChild(container, i);
                        }
                    }
                    else if ((i + 1) > theadTopHeight && !/tbody/.test(th.id)) {
                        _this.theadLeftIndexEntity.deletChild(i, 1, true);
                    }
                });
            }
        };
        // 如果列标识数小于左表头宽度+上表头宽度 例如：添加了单元格
        if (topIndexWidth <= theadTopWidth + theadLeftWidth) {
            maxWidth = theadTopWidth + theadLeftWidth;
            if (maxWidth) {
                for (var colIndex = 0; colIndex < theadLeftWidth; colIndex++) {
                    var originalColTh = this.theadTopIndexEntity.getContainerByTheadPosition([colIndex]);
                    var thContainer = this.theadLeftEntity.leafIndexList2[colIndex];
                    var container = this.theadTopIndexEntity.createContain();
                    container.update(thContainer);
                    if (colIndex + 1 > topIndexWidth || /tbody/.test(originalColTh.id)) {
                        this.theadTopIndexEntity.addChild(container);
                    }
                    else {
                        this.theadTopIndexEntity.replaceChild(container, colIndex);
                    }
                }
                resizeTableWidth();
            }
        }
        else { // 如果列标识数大于左表头宽度+上表头宽度 例如：删除了单元格
            maxWidth = topIndexWidth;
            resizeTableWidth();
        }
        this.theadLeftIndexEntity.render();
        leftIndexHeight = this.theadLeftIndexEntity.side1;
        if (leftIndexHeight <= theadLeftHeight + theadTopHeight) {
            maxHeight = theadLeftHeight + theadTopHeight;
            if (maxHeight) {
                for (var rowIndex = 0; rowIndex < theadTopHeight; rowIndex++) {
                    var originalRowTh = this.theadLeftIndexEntity.getContainerByTheadPosition([rowIndex]);
                    var thContainer = this.theadTopEntity.leafIndexList2[rowIndex];
                    var container = this.theadLeftIndexEntity.createContain();
                    container.update(thContainer);
                    if (rowIndex + 1 > leftIndexHeight || /tbody/.test(originalRowTh.id)) {
                        this.theadLeftIndexEntity.addChild(container, rowIndex);
                    }
                    else {
                        this.theadLeftIndexEntity.replaceChild(container, rowIndex);
                    }
                }
                resizeTableHeight();
            }
        }
        else {
            maxHeight = leftIndexHeight;
            resizeTableHeight();
        }
    };
    /**
     * 当拖拽形成表格后 操作
     *
     * @private
     * @param {*} msg
     * @returns
     * @memberof BaseTable
     */
    BaseTable.prototype.afterDrop = function (msg) {
        var _this = this;
        if (msg) {
            var position_1 = [];
            var insertIndex_1 = null;
            var targetWithChildren_1 = msg.target.withChildren;
            var sourceWithChildren_1 = msg.source.withChildren;
            var targetContainer_1 = msg.target.containerData;
            var sourceContainer_1 = msg.source.containerData;
            var operationType_1 = msg.operationType;
            if (sourceWithChildren_1 === undefined && sourceContainer_1.children && sourceContainer_1.children.length !== 0) {
                var r = window.confirm('整组移动？');
                if (r === true) {
                    sourceWithChildren_1 = true;
                }
                else {
                    sourceWithChildren_1 = false;
                }
            }
            // 处理inner情况
            var handleInner = function () {
                if (/replace/.test(operationType_1)) {
                    // do nothing
                }
                else if (targetContainer_1.cell && targetContainer_1.cell.value) {
                    var r = window.confirm('该单元格已存在数据，是否替换？');
                    if (r === true) {
                        operationType_1 += '-replace';
                    }
                    else {
                        return;
                    }
                }
                else {
                    operationType_1 += '-replace';
                }
                if (targetWithChildren_1 === undefined && targetContainer_1.children && targetContainer_1.children.length > 0) {
                    var r = window.confirm('是否删除该单元格的子节点');
                    if (r === true) {
                        targetWithChildren_1 = true;
                    }
                    else {
                        return;
                    }
                }
                position_1 = dropRight(targetContainer_1.theadPosition, 1);
                insertIndex_1 = last(targetContainer_1.theadPosition);
            };
            var handleTop = function () {
                var targetContainer1Position = baseClone(targetContainer_1.theadPosition);
                var sourceContainerSource = _this.getContainer(sourceContainer_1.position, 'source');
                position_1 = dropRight(targetContainer_1.theadPosition, 1);
                insertIndex_1 = last(targetContainer_1.theadPosition);
                var targetParentPosition1 = dropRight(targetContainer_1.theadPosition, 1);
                var targetContainerIndex = last(targetContainer_1.theadPosition);
                // 先将sourceContainer添加或移动到targetContainer位置,得到sourceContainer2,和targetParentPosition2
                {
                    _this.processThead({
                        operationType: operationType_1,
                        param: {
                            type: targetContainer_1.type,
                            targetParentPosition: targetParentPosition1,
                            insertIndex: targetContainerIndex,
                            withChildren: sourceWithChildren_1,
                            sourceContainerData: sourceContainer_1,
                        }
                    });
                }
                // 再将targetContainer移动到sourceContainer2或者sourceContainer2根节点下面
                var source2ParentPosition = sourceContainerSource ? sourceContainerSource.theadPosition : targetContainer1Position;
                if (sourceWithChildren_1) {
                    var tmpChild = sourceContainer_1;
                    if (tmpChild) {
                        var hasChild = (tmpChild.children || []).length > 0;
                        while (hasChild) {
                            tmpChild = tmpChild.children[0];
                            hasChild = (tmpChild.children || []).length > 0;
                            source2ParentPosition.push(0);
                        }
                    }
                }
                {
                    _this.theadMove({
                        type: targetContainer_1.type,
                        targetParentPosition: source2ParentPosition,
                        sourceContainerData: targetContainer_1,
                        insertIndex: 0,
                        withChildren: true
                    }, false);
                }
            };
            if (/top/.test(targetContainer_1.type)) {
                switch (msg.targetBearing) {
                    case 'left':
                        position_1 = dropRight(targetContainer_1.theadPosition, 1);
                        insertIndex_1 = last(targetContainer_1.theadPosition);
                        break;
                    case 'right':
                        position_1 = dropRight(targetContainer_1.theadPosition, 1);
                        insertIndex_1 = last(targetContainer_1.theadPosition) + 1;
                        break;
                    case 'top':
                        handleTop();
                        return;
                    case 'bottom':
                        position_1 = targetContainer_1.theadPosition;
                        insertIndex_1 = null;
                        break;
                    case 'inner':
                        handleInner();
                        break;
                    default:
                        position_1 = targetContainer_1.theadPosition;
                        insertIndex_1 = null;
                        break;
                }
            }
            else if (/left/.test(targetContainer_1.type)) {
                switch (msg.targetBearing) {
                    case 'top':
                        position_1 = dropRight(targetContainer_1.theadPosition, 1);
                        insertIndex_1 = last(targetContainer_1.theadPosition);
                        break;
                    case 'bottom':
                        position_1 = dropRight(targetContainer_1.theadPosition, 1);
                        insertIndex_1 = last(targetContainer_1.theadPosition) + 1;
                        break;
                    case 'left':
                        handleTop();
                        return;
                    case 'right':
                        position_1 = targetContainer_1.theadPosition;
                        insertIndex_1 = null;
                        break;
                    case 'inner':
                        handleInner();
                        break;
                    default:
                        position_1 = targetContainer_1.theadPosition;
                        insertIndex_1 = null;
                        break;
                }
            }
            this.processThead({
                operationType: operationType_1,
                param: {
                    type: targetContainer_1.type,
                    insertIndex: insertIndex_1,
                    withChildren: targetWithChildren_1,
                    targetParentPosition: position_1,
                    sourceContainerData: sourceContainer_1,
                    targetContainerPosition: targetContainer_1.theadPosition
                }
            });
        }
    };
    /**
     * 批量粘贴 截止2018-10-9还未使用
     *
     * @param {*} e
     * @memberof BaseTable
     */
    BaseTable.prototype.mutiPaste = function (e) {
        // console.log(1111);
    };
    /**
     * 判断选中的selectBoxEntity 是否是同一个父容器下
     *
     * @returns
     * @memberof BaseTable
     */
    BaseTable.prototype.isSameParent = function (containerList) {
        var lastContainer;
        var isSameParentSet = true;
        containerList.forEach(function (th) {
            if (!lastContainer) {
                lastContainer = th;
            }
            else {
                if (lastContainer.type !== th.type) {
                    isSameParentSet = false;
                }
                else if (JSON.stringify(dropRight(th.theadPosition, 1)) !== JSON.stringify(dropRight(lastContainer.theadPosition, 1))) {
                    isSameParentSet = false;
                }
            }
        });
        return isSameParentSet;
    };
    /**
     * indexTheadRender 渲染行列标识列
     *
     * @private
     * @memberof BaseTable
     */
    BaseTable.prototype.indexTheadRender = function () {
        this.theadLeftIndexEntity.render();
        this.theadTopIndexEntity.render();
        this.colNumber = this.theadTopIndexEntity.convert();
        this.rowNumber = this.theadLeftIndexEntity.convert();
    };
    /**
     * 表头改变事件
     *
     * @param {*} msg
     * @memberof BaseTable
     */
    BaseTable.prototype.onReceiveMsg = function (msg) {
        this.subjectSend(msg);
        switch (msg.ev_type) {
            case 'drop':
                this.afterDrop(msg.data.object);
                this.renderAll();
                break;
            case 'click':
                this.afterContainerClick(msg.event, msg.data.object);
                break;
            case 'rightClick':
                this.afterContainerRClick(msg.event, msg.data.object);
                break;
            default:
        }
        if (this.config.renderEvent.indexOf(msg.ev_type) !== -1) {
            this.renderAll();
        }
    };
    /**
     * 通用表头处理方法
     *
     * @private
     * @param {string} theadType
     * @param {string} operationType
     * @param {number[]} targetParentPostion
     * @param {(TheadContainer | null)} [sourceContainerData]
     * @param {number} [operationIndex]
     * @memberof BaseTable
     */
    BaseTable.prototype.processThead = function (processTheadData) {
        var param = processTheadData.param;
        switch (processTheadData.operationType) {
            case 'add':
                this.theadAdd(param, false);
                break;
            case 'move':
                this.theadMove(param, false);
                break;
            case 'add-replace':
                this.theadAddPlace(param, false);
                break;
            case 'move-replace':
                this.theadMoveReplace(param, false);
                break;
            case 'delete':
                this.theadDelete(param, false);
                break;
            default:
        }
    };
    BaseTable.prototype.afterContainerClick = function (ev, th) {
        // debugger
        var dom = ev.currentTarget;
        var container = this.$selectBoxEntity.createSelectContainer(dom, th);
        if (!this.keyDownSet.has('Control')) {
            this.$selectBoxEntity.clear();
        }
        this.$selectBoxEntity.add(container);
        var editContainer = this.$positionManager.$editContainer;
        // console.log(editContainer);
        if (editContainer && editContainer.cell && editContainer.cell.formula.canClickAdd && editContainer.id !== th.id) {
            var oldValue = editContainer.cell.formula.tmpValue;
            var valueArr = oldValue.split('');
            var addValue = '';
            if (this.$positionManager.$editContainer.position.table !== this.position.table) {
                addValue = 'table' + th.position.table + '!';
            }
            addValue += th.position.colStr + th.position.rowStr;
            valueArr.splice(editContainer.cell.selectionStart, 0, addValue);
            // this.$positionManager.$editContainer.cell.value = valueArr.join('');
            var elInput = document.activeElement;
            editContainer.cell.value = valueArr.join('');
            elInput.value = valueArr.join('');
            elInput.selectionStart = editContainer.cell.selectionStart + addValue.length;
            elInput.selectionEnd = editContainer.cell.selectionStart + addValue.length;
            console.log(elInput.value);
        }
        focus();
    };
    BaseTable.prototype.afterContainerRClick = function (ev, th) {
        // debugger
        var dom = ev.currentTarget;
        var container = this.$selectBoxEntity.createSelectContainer(dom, th);
        if (this.$selectBoxEntity.has(container)) {
            // 已选中自己 doNoting
        }
        else {
            this.$selectBoxEntity.clear();
            this.$selectBoxEntity.add(container);
        }
        focus();
    };
    return BaseTable;
}(TableContainer_TableContainer));


// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js??ref--12-0!./node_modules/thread-loader/dist/cjs.js!./node_modules/ts-loader??ref--12-2!./node_modules/vue-loader/lib??vue-loader-options!./packages/drag-table2.0/views/TableCom.vue?vue&type=script&lang=ts&


/* harmony default export */ var TableComvue_type_script_lang_ts_ = (external_commonjs_vue_commonjs2_vue_root_Vue_default.a.component("MyTable", {
    props: {
        inputTable: Object
    },
    data: function () {
        return {
            myTable: this.inputTable || new BaseTable_BaseTable("test")
        };
    },
    watch: {
        inputTable: function (val, oldVal) {
            this.myTable = val || oldVal;
        }
    },
    created: function () {
        console.log(this.myTable.tableId);
    }
}));

// CONCATENATED MODULE: ./packages/drag-table2.0/views/TableCom.vue?vue&type=script&lang=ts&
 /* harmony default export */ var views_TableComvue_type_script_lang_ts_ = (TableComvue_type_script_lang_ts_); 
// EXTERNAL MODULE: ./packages/drag-table2.0/views/TableCom.vue?vue&type=style&index=0&id=7a5dd938&scoped=true&lang=css&
var TableComvue_type_style_index_0_id_7a5dd938_scoped_true_lang_css_ = __webpack_require__("0599");

// CONCATENATED MODULE: ./node_modules/vue-loader/lib/runtime/componentNormalizer.js
/* globals __VUE_SSR_CONTEXT__ */

// IMPORTANT: Do NOT use ES2015 features in this file (except for modules).
// This module is a runtime utility for cleaner component module output and will
// be included in the final webpack user bundle.

function normalizeComponent (
  scriptExports,
  render,
  staticRenderFns,
  functionalTemplate,
  injectStyles,
  scopeId,
  moduleIdentifier, /* server only */
  shadowMode /* vue-cli only */
) {
  // Vue.extend constructor export interop
  var options = typeof scriptExports === 'function'
    ? scriptExports.options
    : scriptExports

  // render functions
  if (render) {
    options.render = render
    options.staticRenderFns = staticRenderFns
    options._compiled = true
  }

  // functional template
  if (functionalTemplate) {
    options.functional = true
  }

  // scopedId
  if (scopeId) {
    options._scopeId = 'data-v-' + scopeId
  }

  var hook
  if (moduleIdentifier) { // server build
    hook = function (context) {
      // 2.3 injection
      context =
        context || // cached call
        (this.$vnode && this.$vnode.ssrContext) || // stateful
        (this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext) // functional
      // 2.2 with runInNewContext: true
      if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {
        context = __VUE_SSR_CONTEXT__
      }
      // inject component styles
      if (injectStyles) {
        injectStyles.call(this, context)
      }
      // register component module identifier for async chunk inferrence
      if (context && context._registeredComponents) {
        context._registeredComponents.add(moduleIdentifier)
      }
    }
    // used by ssr in case component is cached and beforeCreate
    // never gets called
    options._ssrRegister = hook
  } else if (injectStyles) {
    hook = shadowMode
      ? function () { injectStyles.call(this, this.$root.$options.shadowRoot) }
      : injectStyles
  }

  if (hook) {
    if (options.functional) {
      // for template-only hot-reload because in that case the render fn doesn't
      // go through the normalizer
      options._injectStyles = hook
      // register for functioal component in vue file
      var originalRender = options.render
      options.render = function renderWithStyleInjection (h, context) {
        hook.call(context)
        return originalRender(h, context)
      }
    } else {
      // inject component registration as beforeCreate hook
      var existing = options.beforeCreate
      options.beforeCreate = existing
        ? [].concat(existing, hook)
        : [hook]
    }
  }

  return {
    exports: scriptExports,
    options: options
  }
}

// CONCATENATED MODULE: ./packages/drag-table2.0/views/TableCom.vue






/* normalize component */

var component = normalizeComponent(
  views_TableComvue_type_script_lang_ts_,
  render,
  staticRenderFns,
  false,
  null,
  "7a5dd938",
  null
  
)

component.options.__file = "TableCom.vue"
/* harmony default export */ var TableCom = (component.exports);
// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js?{"cacheDirectory":"node_modules//.cache//vue-loader","cacheIdentifier":"2d1472b6-vue-loader-template"}!./node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/cache-loader/dist/cjs.js??ref--0-0!./node_modules/vue-loader/lib??vue-loader-options!./packages/drag-table2.0/views/TableListCom.vue?vue&type=template&id=ecf3276c&
var TableListComvue_type_template_id_ecf3276c_render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',_vm._l((_vm.tableList.children),function(table){return _c('MyTable',{key:table.id,attrs:{"inputTable":table}})}))}
var TableListComvue_type_template_id_ecf3276c_staticRenderFns = []


// CONCATENATED MODULE: ./packages/drag-table2.0/views/TableListCom.vue?vue&type=template&id=ecf3276c&

// CONCATENATED MODULE: ./packages/drag-table2.0/viewModule/tableList/BaseTableList.ts








var BaseTableList_BaseTableList = /** @class */ (function (_super) {
    __extends(BaseTableList, _super);
    function BaseTableList(id, config) {
        var _this = _super.call(this, {
            id: id,
            $selectBoxId: (config && config.positionManagerId) ? config.selectBoxId : id,
            $defConfigId: id,
            $positionManagerId: (config && config.positionManagerId) ? config.positionManagerId : id
        }) || this;
        _this.children = new Array();
        _this.tableListSubject = new Subject(); //  表格事件
        _this.$positionManager = PositionManager_PositionManager.getInstance('multi-table'); // 位置记录器
        _this.defaultConfig = new DefaultConfig_DefaultConfig(); // 默认设置
        _this.config = new BaseTableListConfig_BaseTableListConfig();
        return _this;
    }
    /**
     * onTableSendMsg
     */
    BaseTableList.prototype.onTableSendMsg = function (msg) {
        this.subjectSend(msg);
        if (this.config.renderEvent.indexOf(msg.ev_type) !== -1) {
            this.$positionManager.render();
        }
    };
    /**
     * getTable
     */
    BaseTableList.prototype.getTable = function (index) {
        return this.children[index];
    };
    /**
     * createTable
     */
    BaseTableList.prototype.createTable = function (id, config) {
        var defConfig = {
            tableGroupId: this.id,
        };
        objectSet(defConfig, config, 'union');
        var tmpTable = new BaseTable_BaseTable(id, defConfig);
        tmpTable.tableSubject.subscribe(this.onTableSendMsg, this);
        return tmpTable;
    };
    /**
     * addChild
     * 备注：添加子节点
     * @param child: BaseTable 要添加的子节点
     * @param targetIndex?: number 添加的位置
     */
    BaseTableList.prototype.addChild = function (child, targetIndex) {
        targetIndex = (targetIndex === undefined || targetIndex === null) ? this.children.length : targetIndex;
        if (!child.id) {
            child.id = 'def_' + guid();
        }
        this.children.splice(targetIndex, 0, child);
    };
    /**
     * name
     */
    BaseTableList.prototype.render = function () {
        this.$positionManager.render();
    };
    /**
     * subjectSend
     */
    BaseTableList.prototype.subjectSend = function (msg) {
        this.tableListSubject.sendMsg(msg);
    };
    return BaseTableList;
}(TableContainer_TableContainer));


// CONCATENATED MODULE: ./node_modules/cache-loader/dist/cjs.js??ref--12-0!./node_modules/thread-loader/dist/cjs.js!./node_modules/ts-loader??ref--12-2!./node_modules/vue-loader/lib??vue-loader-options!./packages/drag-table2.0/views/TableListCom.vue?vue&type=script&lang=ts&

 // @ is an alias to /src

/* harmony default export */ var TableListComvue_type_script_lang_ts_ = (external_commonjs_vue_commonjs2_vue_root_Vue_default.a.component("TableListCom", {
    props: {
        TableContanerCom: Object
    },
    components: {
        MyTable: TableCom
    },
    data: function () {
        return {
            tableList: this.TableContanerCom || new BaseTableList_BaseTableList('def')
        };
    },
    methods: {}
}));

// CONCATENATED MODULE: ./packages/drag-table2.0/views/TableListCom.vue?vue&type=script&lang=ts&
 /* harmony default export */ var views_TableListComvue_type_script_lang_ts_ = (TableListComvue_type_script_lang_ts_); 
// EXTERNAL MODULE: ./packages/drag-table2.0/views/TableListCom.vue?vue&type=style&index=0&lang=css&
var TableListComvue_type_style_index_0_lang_css_ = __webpack_require__("26e6");

// CONCATENATED MODULE: ./packages/drag-table2.0/views/TableListCom.vue






/* normalize component */

var TableListCom_component = normalizeComponent(
  views_TableListComvue_type_script_lang_ts_,
  TableListComvue_type_template_id_ecf3276c_render,
  TableListComvue_type_template_id_ecf3276c_staticRenderFns,
  false,
  null,
  null,
  null
  
)

TableListCom_component.options.__file = "TableListCom.vue"
/* harmony default export */ var TableListCom = (TableListCom_component.exports);
// CONCATENATED MODULE: ./packages/drag-table2.0/index.js








// CONCATENATED MODULE: ./node_modules/@vue/cli-service/lib/commands/build/entry-lib-no-default.js
/* concated harmony reexport TableCom */__webpack_require__.d(__webpack_exports__, "TableCom", function() { return TableCom; });
/* concated harmony reexport TableListCom */__webpack_require__.d(__webpack_exports__, "TableListCom", function() { return TableListCom; });
/* concated harmony reexport BaseTable */__webpack_require__.d(__webpack_exports__, "BaseTable", function() { return BaseTable_BaseTable; });
/* concated harmony reexport BaseTableList */__webpack_require__.d(__webpack_exports__, "BaseTableList", function() { return BaseTableList_BaseTableList; });




/***/ })

/******/ });
//# sourceMappingURL=drag-table.common.js.map