(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e(require("vue")):"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["drag-table"]=e(require("vue")):t["drag-table"]=e(t["Vue"])})("undefined"!==typeof self?self:this,function(t){return function(t){var e={};function i(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,o){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(i.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(o,n,function(e){return t[e]}.bind(null,n));return o},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s="fae3")}({"0599":function(t,e,i){"use strict";var o=i("a663"),n=i.n(o);n.a},"1eb2":function(t,e,i){var o;"undefined"!==typeof window&&((o=window.document.currentScript)&&(o=o.src.match(/(.+\/)[^/]+\.js$/))&&(i.p=o[1]))},"26e6":function(t,e,i){"use strict";var o=i("9b13"),n=i.n(o);n.a},"65d9":function(t,e,i){"use strict";
/**
  * vue-class-component v6.2.0
  * (c) 2015-present Evan You
  * @license MIT
  */function o(t){return t&&"object"===typeof t&&"default"in t?t["default"]:t}Object.defineProperty(e,"__esModule",{value:!0});var n=o(i("8bbf")),a={__proto__:[]}instanceof Array;function r(t){return function(e,i,o){var n="function"===typeof e?e:e.constructor;n.__decorators__||(n.__decorators__=[]),"number"!==typeof o&&(o=void 0),n.__decorators__.push(function(e){return t(e,i,o)})}}function s(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.extend({mixins:t})}function l(t){var e=typeof t;return null==t||"object"!==e&&"function"!==e}function c(t,e){var i=e.prototype._init;e.prototype._init=function(){var e=this,i=Object.getOwnPropertyNames(t);if(t.$options.props)for(var o in t.$options.props)t.hasOwnProperty(o)||i.push(o);i.forEach(function(i){"_"!==i.charAt(0)&&Object.defineProperty(e,i,{get:function(){return t[i]},set:function(e){return t[i]=e},configurable:!0})})};var o=new e;e.prototype._init=i;var n={};return Object.keys(o).forEach(function(t){void 0!==o[t]&&(n[t]=o[t])}),n}var d=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured"];function h(t,e){void 0===e&&(e={}),e.name=e.name||t._componentTag||t.name;var i=t.prototype;Object.getOwnPropertyNames(i).forEach(function(t){if("constructor"!==t)if(d.indexOf(t)>-1)e[t]=i[t];else{var o=Object.getOwnPropertyDescriptor(i,t);"function"===typeof o.value?(e.methods||(e.methods={}))[t]=o.value:(o.get||o.set)&&((e.computed||(e.computed={}))[t]={get:o.get,set:o.set})}}),(e.mixins||(e.mixins=[])).push({data:function(){return c(this,t)}});var o=t.__decorators__;o&&(o.forEach(function(t){return t(e)}),delete t.__decorators__);var a=Object.getPrototypeOf(t.prototype),r=a instanceof n?a.constructor:n,s=r.extend(e);return u(s,t,r),s}function u(t,e,i){Object.getOwnPropertyNames(e).forEach(function(o){if("prototype"!==o){var n=Object.getOwnPropertyDescriptor(t,o);if(!n||n.configurable){var r=Object.getOwnPropertyDescriptor(e,o);if(!a){if("cid"===o)return;var s=Object.getOwnPropertyDescriptor(i,o);if(!l(r.value)&&s&&s.value===r.value)return}0,Object.defineProperty(t,o,r)}}})}function p(t){return"function"===typeof t?h(t):function(e){return h(e,t)}}(function(t){function e(t){d.push.apply(d,t)}t.registerHooks=e})(p||(p={}));var f=p;e.default=f,e.createDecorator=r,e.mixins=s},"8bbf":function(e,i){e.exports=t},"9b13":function(t,e,i){},a663:function(t,e,i){},fae3:function(t,e,i){"use strict";i.r(e);i("1eb2");var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.myTable?i("div",{staticStyle:{position:"relative",float:"left",overflow:"hidden"},on:{keydown:function(e){t.myTable.onKeyDown(e)},keyup:function(e){t.myTable.onKeyUp(e)}}},[t.myTable.config.hasLeftFixedTable&&t.myTable.config.hasTopFixedTable?i("div",{staticClass:"fix-top-left-table"},[t.myTable&&t.myTable.rowNumber[0]&&t.myTable.colNumber[0]?i("table",{staticClass:"my-table left-table",attrs:{cellspacing:"0",cellpadding:"0",border:"0"}},[i("thead",[t.myTable.config.isShowColIndex&&t.myTable.config.isShowRowIndex?i("tr",[i("th",{staticClass:"rowNumber",style:{padding:t.myTable.rowNumber[0].style.padding,background:t.myTable.rowNumber[0].style.background}},[i("div",{style:{width:t.myTable.rowNumber[0].style.width,height:t.myTable.colNumber[0].style.height}},[t._v("\n              "+t._s(1===t.myTable.config.debugLevel?t.myTable.id:"")+"\n            ")])]),t._l(t.myTable.theadLeftEntity.leafIndexList2,function(e,o){return i("th",{staticClass:"colNumber",style:t.myTable.colNumber[o].style},[i("div",{style:t.myTable.colNumber[o].cell.style},[t._v("\n              "+t._s(t.myTable.colNumber[o].cell.content)+"\n            ")])])})],2):t._e(),t._l(t.myTable.tableHeadTop,function(e,o){return t.myTable.config.isShowRowIndex?i("tr",{key:e+o},[i("th",{staticClass:"rowNumber",style:t.myTable.rowNumber[o].style,on:{dragover:function(e){t.myTable.dragOver(e)},drop:function(e){t.myTable.drop(e,t.myTable.rowNumber[o])},mousedown:function(e){t.myTable.rowNumber[o].onMouseDown(e)},mouseout:function(e){t.myTable.rowNumber[o].onMouseOut(e)},mousemove:function(e){t.myTable.rowNumber[o].onMouseMove(e)}}},[i("div",{style:[t.myTable.rowNumber[o].cell.style],attrs:{title:t.myTable.rowNumber[o].cell.content}},[t._v(t._s(t.myTable.rowNumber[o].cell.content))])]),0===o&&t.myTable.tableHeadLeft[0]&&t.myTable.tableHeadTop[0]?i("th",{staticClass:"colNumber",staticStyle:{"border-width":"1px"},style:t.myTable.tableHeadTopLeft.style,attrs:{colspan:t.myTable.theadLeftEntity.side2,rowspan:t.myTable.tableHeadTop.length}},[i("div",{style:t.myTable.tableHeadTopLeft.cell.style},[t._v("\n              "+t._s(t.myTable.config.topleftShowTableName?t.myTable.tableHeadTopLeft.cell.content:"")+"\n            ")])]):t._e()]):t._e()})],2)]):t._e()]):t._e(),t.myTable.config.hasLeftFixedTable?i("div",{staticClass:"fix-left-table",style:t.myTable.style.leftTable,domProps:{scrollTop:t.myTable.style.scrollTop}},[t.myTable&&t.myTable.rowNumber[0]&&t.myTable.colNumber[0]?i("table",{staticClass:"my-table left-table"},[i("thead",[t.myTable.config.isShowColIndex?i("tr",[i("th",{staticClass:"rowNumber",style:{padding:(t.myTable.rowNumber[0]||t.myTable.colNumber[0]||{}).style.padding,background:(t.myTable.rowNumber[0]||t.myTable.colNumber[0]||{}).style.background}},[i("div",{style:{width:t.myTable.rowNumber[0].style.width,height:t.myTable.colNumber[0].style.height}})]),t._l(t.myTable.theadLeftEntity.leafIndexList2,function(e,o){return i("th",{staticClass:"colNumber",style:t.myTable.colNumber[o].style},[i("div",{style:t.myTable.colNumber[o].cell.style},[t._v("\n              "+t._s(t.myTable.colNumber[o].cell.content)+"\n            ")])])})],2):t._e(),t._l(t.myTable.rowNumber,function(e,o){return i("tr",{key:"row"+o},[t.myTable.config.isShowRowIndex?i("th",{staticClass:"rowNumber",style:e.style,attrs:{tabindex:"0"},on:{mousedown:function(t){e.onMouseDown(t)},mouseout:function(t){e.onMouseOut(t)},mousemove:function(t){e.onMouseMove(t)},click:function(t){e.onClick(t)},dragover:function(i){t.myTable.dragOver(i,e)},drop:function(i){t.myTable.drop(i,e)}}},[i("div",{style:[e.cell.style],attrs:{title:e.cell.content}},[t._v(t._s(e.cell.content))])]):t._e(),0===o&&t.myTable.tableHeadLeft[0]?i("th",{staticClass:"colNumber",style:t.myTable.tableHeadTopLeft.style,attrs:{colspan:t.myTable.theadLeftEntity.side2,rowspan:t.myTable.tableHeadTop.length}},[i("div",{style:t.myTable.tableHeadTopLeft.cell.style},[t._v("\n              "+t._s(t.myTable.config.topleftShowTableName?t.myTable.tableHeadTopLeft.cell.content:"")+"\n            ")])]):t._e(),t._l(t.myTable.tableHeadLeft[o-t.myTable.theadTopEntity.side2],function(e,o){return i("th",{key:e+o,style:[e.style],attrs:{tabindex:"1",draggable:e.draggable,colspan:e.span2,rowspan:e.span1},on:{click:function(t){e.onClick(t)},blur:function(t){e.onBlur(t)},dragstart:function(i){t.myTable.dragStart(i,e)},dragover:function(i){t.myTable.dragOver(i,e)},drop:function(i){t.myTable.drop(i,e)},dragleave:function(i){t.myTable.dragLeave(i,e)},mousedown:function(t){e.onMouseDown(t)},mousemove:function(t){e.onMouseMove(t)},mouseout:function(t){e.onMouseOut(t)}}},["text"==e.cell.displayClass[e.cell.status].displayType?i("div",{style:[e.cell.style],on:{dblclick:function(t){e.cell.onDbClick()}}},[t._v("\n              "+t._s(e.cell.content)+"\n            ")]):t._e(),"input"==e.cell.displayClass[e.cell.status].displayType?i("input",{directives:[{name:"model",rawName:"v-model",value:e.cell.value,expression:"th.cell.value"}],staticStyle:{"background-color":"#fff"},style:[e.cell.style],domProps:{value:e.cell.value},on:{mouseover:function(t){e.cell.onMouseOver(t)},blur:function(t){e.cell.inputOnBlur(t,!0)},input:function(i){i.target.composing||t.$set(e.cell,"value",i.target.value)}}}):t._e(),"button"==e.cell.displayClass[e.cell.status].displayType?i("button",{style:[e.cell.style],on:{click:function(t){e.cell.click(t)}}},[t._v(t._s(e.cell.content))]):t._e(),"select"==e.cell.displayClass[e.cell.status].displayType?i("select",{directives:[{name:"model",rawName:"v-model",value:e.cell.value,expression:"th.cell.value"}],style:[e.cell.style],attrs:{tabindex:"1"},on:{change:[function(i){var o=Array.prototype.filter.call(i.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(e.cell,"value",i.target.multiple?o:o[0])},function(t){e.cell.onChange(t)}],blur:function(t){e.cell.onBlur(t)}}},t._l(e.cell.select.optionList,function(e){return i("option",{key:e.value,domProps:{value:e.text}},[t._v(t._s(e.text))])})):t._e()])})],2)})],2)]):t._e()]):t._e(),t.myTable.config.hasTopFixedTable?i("div",{staticClass:"fix-top-table",style:t.myTable.style.topTable,domProps:{scrollLeft:t.myTable.style.scrollLeft}},[t.myTable&&t.myTable.rowNumber[0]&&t.myTable.colNumber[0]?i("table",{staticClass:"my-table",attrs:{cellspacing:"0",cellpadding:"0",border:"0"}},[i("thead",[t.myTable.config.isShowColIndex?i("tr",[t.myTable.config.isShowRowIndex?i("th",{staticClass:"rowNumber",style:{padding:t.myTable.rowNumber[0].style.padding,background:t.myTable.rowNumber[0].style.background}},[i("div",{style:{width:t.myTable.rowNumber[0].style.width,height:t.myTable.colNumber[0].style.height}})]):t._e(),t._l(t.myTable.colNumber,function(e,o){return i("th",{key:"col"+o,staticClass:"colNumber",style:e.style,attrs:{tabindex:"1"},on:{mousedown:function(t){e.onMouseDown(t)},mouseout:function(t){e.onMouseOut(t)},mousemove:function(t){e.onMouseMove(t)},click:function(t){e.onClick(t)},dragover:function(i){t.myTable.dragOver(i,e)},drop:function(i){t.myTable.drop(i,e)}}},[i("div",{style:e.cell.style},[t._v(t._s(e.cell.content))])])})],2):t._e(),t._l(t.myTable.tableHeadTop,function(e,o){return i("tr",{key:"tr"+o},[t.myTable.config.isShowRowIndex?i("th",{staticClass:"rowNumber",style:t.myTable.rowNumber[o].style},[i("div",{style:t.myTable.rowNumber[o].cell.style})]):t._e(),0===o&&t.myTable.tableHeadLeft[0]&&t.myTable.tableHeadTop[0]?i("th",{staticClass:"colNumber",style:t.myTable.tableHeadTopLeft.style,attrs:{colspan:t.myTable.theadLeftEntity.side2,rowspan:t.myTable.tableHeadTop.length}},[i("div",{style:t.myTable.tableHeadTopLeft.cell.style},[t._v("\n              "+t._s(t.myTable.config.topleftShowTableName?t.myTable.tableHeadTopLeft.cell.content:"")+"\n            ")])]):t._e(),t._l(e,function(e,o){return i("th",{key:e.id+o,staticClass:"top-th",style:e.style,attrs:{tabindex:"1",draggable:e.draggable,colspan:e.span1,rowspan:e.span2},on:{blur:function(t){e.onBlur(t)},click:function(t){e.onClick(t)},dragstart:function(i){t.myTable.dragStart(i,e)},dragend:function(i){t.myTable.dragEnd(i,e)},dragover:function(i){t.myTable.dragOver(i,e)},drop:function(i){t.myTable.drop(i,e)},dragleave:function(i){t.myTable.dragLeave(i,e)},mousedown:function(t){e.onMouseDown(t)},mousemove:function(t){e.onMouseMove(t)},mouseout:function(t){e.onMouseOut(t)}}},["text"==e.cell.displayClass[e.cell.status].displayType?i("div",{style:[e.cell.style],attrs:{title:e.cell.title},on:{dblclick:function(t){e.cell.onDbClick()}}},[i("i",[e.cell.title?i("svg",{staticClass:"icon",style:e.tips.style,attrs:{t:"1546669133888",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1069"}},[i("path",{attrs:{d:"M512 56.888889C261.688889 56.888889 56.888889 261.688889 56.888889 512s204.8 455.111111 455.111111 455.111111 455.111111-204.8 455.111111-455.111111-204.8-455.111111-455.111111-455.111111m0 853.333333c-221.866667 0-398.222222-176.355556-398.222222-398.222222s176.355556-398.222222 398.222222-398.222222 398.222222 176.355556 398.222222 398.222222-176.355556 398.222222-398.222222 398.222222",fill:"#333333","p-id":"1070"}}),i("path",{attrs:{d:"M512 682.666667c-17.066667 0-28.444444 5.688889-39.822222 17.066666-11.377778 11.377778-17.066667 22.755556-17.066667 39.822223 0 17.066667 5.688889 28.444444 17.066667 39.822222 11.377778 11.377778 22.755556 17.066667 39.822222 17.066666 17.066667 0 28.444444-5.688889 39.822222-17.066666 11.377778-11.377778 17.066667-22.755556 17.066667-39.822222 0-17.066667-5.688889-28.444444-17.066667-39.822223-11.377778-11.377778-22.755556-17.066667-39.822222-17.066666z m-51.2-455.111111l17.066667 409.6h62.577777L563.2 227.555556H460.8z",fill:"#333333","p-id":"1071"}})]):t._e()]),t._v("\n\n              "+t._s(e.cell.content)+"\n\n            ")]):t._e(),"input"==e.cell.displayClass[e.cell.status].displayType?i("input",{directives:[{name:"model",rawName:"v-model",value:e.cell.value,expression:"th.cell.value"}],style:[e.cell.style],domProps:{value:e.cell.value},on:{mouseover:function(t){e.cell.onMouseOver(t)},blur:function(t){e.cell.inputOnBlur(t,!0)},input:function(i){i.target.composing||t.$set(e.cell,"value",i.target.value)}}}):t._e(),"button"==e.cell.displayClass[e.cell.status].displayType?i("button",{style:[e.cell.style],on:{click:function(t){e.cell.click(t)}}},[t._v(t._s(e.cell.content))]):t._e()])})],2)})],2)]):t._e()]):t._e(),i("div",{staticClass:"main-table",style:t.myTable.style.mainTable,attrs:{scrollTop:t.myTable.style.scrollTop,id:"div1"},on:{scroll:function(e){t.myTable.onScroll(e)}}},[t.myTable&&t.myTable.rowNumber[0]&&t.myTable.colNumber[0]?i("table",{staticClass:"my-table",attrs:{cellspacing:"0",cellpadding:"0",border:"0"}},[i("thead",[t.myTable.config.isShowColIndex?i("tr",[t.myTable.config.isShowRowIndex?i("th",{staticClass:"rowNumber",style:{width:t.myTable.rowNumber[0].style.width,height:t.myTable.colNumber[0].style.height}},[i("div")]):t._e(),t._l(t.myTable.colNumber,function(e,o){return i("th",{key:"col"+o,staticClass:"colNumber",style:[e.style],on:{dragover:function(i){t.myTable.dragOver(i,e)},drop:function(e){t.myTable.dropTopA_Z(e)},mousedown:function(t){e.onMouseDown(t)},mousemove:function(t){e.onMouseMove(t)},mouseout:function(t){e.onMouseOut(t)}}},[i("div",{style:[e.cell.style]},[t._v(t._s(e.cell.content))])])})],2):t._e(),t._l(t.myTable.tableHeadTop,function(e,o){return i("tr",{key:e+o},[t.myTable.config.isShowRowIndex?i("th",{staticClass:"rowNumber",on:{mousedown:function(e){t.myTable.rowNumber[o].onMouseDown(e)},mousemove:function(e){t.myTable.rowNumber[o].onMouseMove(e)},mouseout:function(e){t.myTable.rowNumber[o].onMouseOut(e)}}},[i("div",{style:[t.myTable.rowNumber[o].cell.style]},[t._v("\n              "+t._s(t.myTable.config.hasLeftFixedTable?"":t.myTable.rowNumber[o].cell.content)+"\n            ")])]):t._e(),0===o&&t.myTable.tableHeadLeft[0]&&t.myTable.tableHeadTop[0]?i("th",{staticClass:"colNumber",style:[t.myTable.tableHeadTopLeft.style],attrs:{colspan:t.myTable.theadLeftEntity.side2,rowspan:t.myTable.tableHeadTop.length}},[i("div",{style:[t.myTable.tableHeadTopLeft.cell.style]},[t._v("\n              "+t._s(t.myTable.config.topleftShowTableName?t.myTable.tableHeadTopLeft.cell.content:"")+"\n            ")])]):t._e(),t._l(e,function(e,o){return i("th",{key:e.id+o,style:[e.style],attrs:{colspan:e.span1,rowspan:e.span2,draggable:e.draggable,tabindex:"1"},on:{click:function(t){e.onClick(t)},dragstart:function(i){t.myTable.dragStart(i,e)},dragend:function(i){t.myTable.dragEnd(i,e)},dragover:function(i){t.myTable.dragOver(i,e)},drop:function(i){t.myTable.drop(i,e)},dragleave:function(i){t.myTable.dragLeave(i,e)},mousedown:function(t){e.onMouseDown(t)},mousemove:function(t){e.onMouseMove(t)},mouseout:function(t){e.onMouseOut(t)}}},["text"==e.cell.displayClass[e.cell.status].displayType?i("div",{style:[e.cell.style],on:{dblclick:function(t){e.cell.onDbClick(t)}}},[t._v(t._s(e.cell.content)+"\n            ")]):t._e(),"input"==e.cell.displayClass[e.cell.status].displayType?i("div",[i("input",{directives:[{name:"model",rawName:"v-model",value:e.cell.value,expression:"th.cell.value"}],style:[e.cell.style],domProps:{value:e.cell.value},on:{mouseover:function(t){e.cell.onMouseOver(t)},blur:function(t){e.cell.inputOnBlur(t,!0)},input:function(i){i.target.composing||t.$set(e.cell,"value",i.target.value)}}})]):t._e(),"button"==e.cell.displayClass[e.cell.status].displayType?i("div",[i("button",{on:{click:function(t){e.cell.click(t)}}},[t._v(t._s(e.cell.content))])]):t._e(),"select"==e.cell.displayClass[e.cell.status].displayType?i("select",{directives:[{name:"model",rawName:"v-model",value:e.cell.value,expression:"th.cell.value"}],style:[e.cell.style],attrs:{tabindex:"1"},on:{change:[function(i){var o=Array.prototype.filter.call(i.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(e.cell,"value",i.target.multiple?o:o[0])},function(t){e.cell.onChange(t)}],blur:function(t){e.cell.onBlur(t)}}},t._l(e.cell.select.optionList,function(e){return i("option",{key:e.value,domProps:{value:e.text}},[t._v(t._s(e.text))])})):t._e()])})],2)})],2),i("tbody",t._l(t.myTable.tableBody,function(e,o){return i("tr",{key:e+o},[t.myTable.config.isShowRowIndex?i("th",{staticClass:"rowNumber",style:t.myTable.rowNumber[o+t.myTable.tableHeadTop.length].style,on:{mousedown:function(e){t.myTable.rowNumber[o+t.myTable.tableHeadTop.length].onMouseDown(e)},mouseout:function(e){t.myTable.rowNumber[o+t.myTable.tableHeadTop.length].onMouseOut(e)},mousemove:function(e){t.myTable.rowNumber[o+t.myTable.tableHeadTop.length].onMouseMove(e)}}},[i("div",{style:[t.myTable.rowNumber[o+t.myTable.tableHeadTop.length].cell.style]},[t._v("\n              "+t._s(t.myTable.rowNumber[o+t.myTable.tableHeadTop.length].cell.content)+"\n            ")])]):t._e(),t._l(t.myTable.tableHeadLeft[o],function(e,o){return i("th",{key:e+o,style:[e.style],attrs:{tabindex:"1",draggable:e.draggable,colspan:e.span2,rowspan:e.span1},on:{click:function(t){e.onClick(t)},blur:function(t){e.onBlur(t)},dragstart:function(i){t.myTable.dragStart(i,e)},dragover:function(i){t.myTable.dragOver(i,e)},drop:function(i){t.myTable.drop(i,e)},dragleave:function(i){t.myTable.dragLeave(i,e)},mousedown:function(t){e.onMouseDown(t)},mousemove:function(t){e.onMouseMove(t)},mouseout:function(t){e.onMouseOut(t)}}},["text"==e.cell.displayClass[e.cell.status].displayType?i("div",{style:[e.cell.style],on:{dblclick:function(t){e.cell.onDbClick()}}},[t._v("\n              "+t._s(e.cell.content)+"\n            ")]):t._e(),"input"==e.cell.displayClass[e.cell.status].displayType?i("input",{directives:[{name:"model",rawName:"v-model",value:e.cell.value,expression:"th.cell.value"}],staticStyle:{"background-color":"#fff"},style:[e.cell.style],domProps:{value:e.cell.value},on:{mouseover:function(t){e.cell.onMouseOver(t)},blur:function(t){e.cell.inputOnBlur(t,!0)},input:function(i){i.target.composing||t.$set(e.cell,"value",i.target.value)}}}):t._e(),"button"==e.cell.displayClass[e.cell.status].displayType?i("button",{style:[e.cell.style],on:{click:function(t){e.cell.click(t)}}},[t._v(t._s(e.cell.content))]):t._e(),"select"==e.cell.displayClass[e.cell.status].displayType?i("select",{directives:[{name:"model",rawName:"v-model",value:e.cell.value,expression:"th.cell.value"}],style:[e.cell.style],attrs:{tabindex:"1"},on:{change:[function(i){var o=Array.prototype.filter.call(i.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(e.cell,"value",i.target.multiple?o:o[0])},function(t){e.cell.onChange(t)}],blur:function(t){e.cell.onBlur(t)}}},t._l(e.cell.select.optionList,function(e){return i("option",{key:e.value,domProps:{value:e.text}},[t._v(t._s(e.text))])})):t._e()])}),t._l(e,function(e,o){return i("td",{key:1+o,style:[e.style],attrs:{tabindex:"1"},on:{click:function(t){e.onClick(t)},mousedown:function(t){e.onMouseDown(t)},blur:function(t){e.onBlur(t)},paste:function(t){e.onPaste(t)}}},["text"==e.cell.displayClass[e.cell.status].displayType?i("div",{style:[e.cell.style],on:{dblclick:function(t){e.cell.onDbClick(t)}}},[t._v(t._s(e.cell.content)+"\n            ")]):t._e(),"input"==e.cell.displayClass[e.cell.status].displayType?i("input",{directives:[{name:"model",rawName:"v-model",value:e.cell.value,expression:"td.cell.value"}],style:[e.cell.style],attrs:{type:"text"},domProps:{value:e.cell.value},on:{input:[function(i){i.target.composing||t.$set(e.cell,"value",i.target.value)},function(t){e.cell.onInput(t)}],mouseup:function(t){e.cell.onMouseUp(t)},mouseover:function(t){e.cell.onMouseOver(t)},focus:function(t){e.cell.onFocus(t)},blur:function(t){e.cell.inputOnBlur(t,!0)},keydown:function(t){e.cell.onKeyDown(t)}}}):t._e(),e.cell&&"select"==e.cell.displayClass[e.cell.status].displayType?i("select",{directives:[{name:"model",rawName:"v-model",value:e.cell.value,expression:"td.cell.value"}],style:[e.cell.style],attrs:{tabindex:"1"},on:{blur:function(t){e.cell.onBlur(t)},mouseover:function(t){e.cell.onMouseOver(t)},change:[function(i){var o=Array.prototype.filter.call(i.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(e.cell,"value",i.target.multiple?o:o[0])},function(t){e.cell.onChange(t)}]}},t._l(e.cell.select.optionList,function(e){return i("option",{key:e.value,domProps:{value:e.text}},[t._v(t._s(e.text))])})):t._e()])})],2)}))]):t._e()]),t._l(t.myTable.$selectBoxEntity.selectList,function(e,o){return i("div",{key:o,style:{position:"absolute",top:e.fixTop?0:"-"+t.myTable.style.scrollTop+"px",left:e.fixLeft?0:"-"+t.myTable.style.scrollLeft+"px"}},[e.position.table===t.myTable.position.table?i("span",[i("div",{style:e.topStyle}),i("div",{style:e.rightStyle}),i("div",{style:e.bottomStyle}),i("div",{style:e.leftStyle})]):t._e()])})],2):t._e()},n=[],a=i("8bbf"),r=i.n(a);i("65d9");
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var s=function(t,e){return s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])},s(t,e)};function l(t,e){function i(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}function c(t,e,i,o){var n;if(e=e||[],i=e||[],t instanceof Array)return n=[],t.forEach(function(t,o){n[o]=c(t,e,i)}),n;if("function"===typeof t)return t;if(t instanceof Object){n={};var a=function(a){if(t.hasOwnProperty(a)||"function"===typeof t[a]&&o){var r=!1,s=!1;if(e.forEach(function(t){-1!==a.indexOf(t)&&(r=!0)}),i.forEach(function(t){-1!==a.indexOf(t)&&(s=!0)}),r)return"continue";n[a]=s?t[a]:c(t[a],e,i,o)}};for(var r in t)a(r);return n}return t}function d(t,e,i,o){var n=Object.create({}),a=function(a){if(t.hasOwnProperty(a)||o&&"function"===typeof t[a]){"valueP"===a&&Object.defineProperty(n,"value",{get:function(){return this.valueP},set:function(t){this.renderState.hasrendered=!1,this.valueP=t}});var r=t[a],s=null,l=!1,d=!1;if((e||[]).forEach(function(t){-1!==a.indexOf(t)&&(l=!0)}),(i||[]).forEach(function(t){-1!==a.indexOf(t)&&(d=!0)}),l)return"continue";d?s=t[a]:Array.isArray(r)?(s=[],r.forEach(function(t){t.EPI_READY&&"function"===typeof t.clone?s.push(t.clone(e,i,o)):s.push(c(t,e,i,o))})):s="object"===typeof t[a]?r&&r.EPI_READY&&"function"===typeof r.clone?r.clone(e,i,o):c(r,e,i,o):t[a],n[a]=s}};for(var r in t)a(r);return n}function h(t,e,i){var o=-1,n=t.length;e=null==e?0:+e||0,e<0&&(e=-e>n?0:n+e),i=void 0===i||i>n?n:+i||0,i<0&&(i+=n),n=e>i?0:i-e>>>0,e>>>=0;var a=Array(n);while(++o<n)a[o]=t[o+e];return a}function u(t,e){var i=null==t?0:t.length;return i?(e=void 0===e?1:e,h(t,e<0?0:e,i)):[]}function p(t,e){var i=null==t?0:t.length;return i?(e=void 0===e?1:e,e=i-e,h(t,0,e<0?0:e)):[]}function f(t){var e=t?t.length:0;return e?t[e-1]:void 0}function y(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function b(){return y()+y()+"-"+y()+"-"+y()+"-"+y()+"-"+y()+y()+y()}function v(t,e,i){if(i=i||"intersection",t&&e)for(var o in e)if(t.hasOwnProperty(o)||"union"===i&&e.hasOwnProperty(o)){var n=t[o];"object"!==typeof n||Array.isArray(n)?void 0!==e[o]&&(t[o]=e[o]):v(t[o],e[o],i)}return t}function g(t,e,i){var o=new RegExp(e,"g"),n=t.replace(o,i);return n}function m(t){var e=Math.floor(t/26),i=t%26,o="";return e>0&&(o+=String.fromCharCode(e+65-1)),o+=String.fromCharCode(i+65),o}var T=function(){function t(){}return t.addBackgroundColor=function(t,e){t.style["background-color"]=e},t.removeBackgroundColor=function(t){t.style.removeProperty("background-color")},t.addBorder=function(t,e,i,o){var n="solid ";i&&(n+=i+"px "),o&&(n+=o+" "),t.style["border-"+e]=n},t.removeBorder=function(t){t.style.removeProperty("border-left"),t.style.removeProperty("border-right"),t.style.removeProperty("border-top"),t.style.removeProperty("border-bottom")},t.checkBearing=function(t,e){var i="inner";if(t.currentTarget){t.currentTarget;var o=.25*t.target.offsetWidth,n=.75*t.target.offsetWidth,a=.25*t.target.offsetHeight,r=.75*t.target.offsetHeight;e&&(o=e.left||o,n=t.target.offsetWidth-e.right||n,a=e.top||a,r=t.target.offsetHeight-e.bottom||r),t.offsetY<a&&(i="top"),t.offsetY>r&&(i="bottom"),t.offsetX<o&&(i="left"),t.offsetX>n&&(i="right")}return i},t.getOffsetTopByBody=function(t){var e=0;while(t&&"BODY"!==t.tagName)e+=t.offsetTop,t=t.offsetParent;return e},t.getOffsetLeftByBody=function(t){var e=0;while(t&&"BODY"!==t.tagName)e+=t.offsetLeft,t=t.offsetParent;return e},t}(),C=function(){function t(){}return t.complexEval=function(t){if(null==t)return"";"string"!==typeof t&&(t+=""),t=(t+"").replace(/[\s]/g,"");var e="[(][^(]*?[)]",i=t.match(e);while(null!=i){var o=i[0]+"",n=this.simpleEval(o.substr(1,o.length-2));t=t.replace(i[0],n),i=t.match(e)}return this.simpleEval(t)},t.simpleEval=function(t){if(null==t)return"";"string"!==typeof t&&(t+="");for(var e=new Array,i=new Array,o=0,n=t.split(""),a=!1,r=0;r<n.length;r++)if("+"===n[r]||"-"===n[r]||"*"===n[r]||"/"===n[r]){var s=1*o;if(a){var l=e.pop(),c=i.pop();s=this.simpleTwoEval(c,l,s)}e.push(s),i.push(n[r]),o=0,a=!1,"*"!==n[r]&&"/"!==n[r]||(a=!0)}else if(o+=n[r]+"",r===n.length-1){s=1*o;if(a){var d=e.pop(),h=(c=i.pop(),this.simpleTwoEval(c,d,o));s=h}e.push(s)}e=this.reverseArray(e),i=this.reverseArray(i);while(e.length>1){var u=e.pop(),p=e.pop();c=i.pop();e.push(this.simpleTwoEval(c,u,p))}return e[0]||0},t.simpleTwoEval=function(t,e,i){return"+"===t?e+i:"-"===t?e-i:"*"===t?e*i:"/"===t?e/i:0},t.reverseArray=function(t){for(var e=new Array,i=t.length,o=0;o<i;o++)e.push(t.pop());return e},t.cellStr2Position=function(t){var e={table:(/[0-9]+(?=!)/.exec(t)||[null])[0],colStr:(/[^!]?([A-Z])+/.exec(t)||[null])[0],rowStr:(/[0-9]+$/.exec(t)||[null])[0]};return e},t.curlyBracesHandle=function(e,i){var o="[{][^{]*?[}]",n=e.match(o);while(null!=n)(n||[]).forEach(function(o){var n=i.position.rowNum+"";if(/sr/.test(o)){var a=o.replace(/sr/g,n);a=a.replace(/[{}]/g,"");var r=t.complexEval(a);e=e.replace(o,r+1)}else if(/sc/.test(o)){var s=i.position.colNum+"";a=o.replace(/sc/g,s);a=a.replace(/[{}]/g,"");r=t.complexEval(a);e=e.replace(o,m(r))}}),n=e.match(o);return e},t}(),w=function(){function t(){this.style={fontSize:12,color:"#000",textAlign:"center",width:"100px",height:"28px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",boxSizing:"border-box",display:"block",userSelect:"none",backgroundColor:"transparent"}}return t}(),x=function(){function t(){this.style={}}return t}(),P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.baseSide1=100,e.baseSide2=28,e.style={padding:"0px 0px",width:"110px",height:"38px",overflow:"hidden",userSelect:"text",position:"relative"},e}return l(e,t),e}(x),E=function(t){function e(){var e=t.call(this)||this;e.draggable=!0;var i={background:"#f5f7fa",cursor:"pointer"};return v(e.style,i,"union"),e}return l(e,t),e}(P),$=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.topleftShowTableName=!1,e.tableName="",e.debugLevel=0,e.isShowColIndex=!0,e.isShowRowIndex=!0,e.isOverflow=!1,e.canResizeWidth=!1,e.hasTopFixedTable=!0,e.hasLeftFixedTable=!0,e.hasTopThead=!0,e.hasLeftThead=!0,e.renderEvent=["blur","change","paste"],e.maxWidth="100%",e.maxHeight="200px",e}return l(e,t),e}(x),N=function(t){function e(){var e=t.call(this)||this,i={overflow:"hidden",boxSizing:"border-box",whiteSpace:"nowrap",textOverflow:"ellipsis",userSelect:"none",background:"#fff",zIndex:99};return v(e.style,i,"union"),e}return l(e,t),e}(E),L=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return l(e,t),e}($),S=function(t){function e(){var e=t.call(this)||this,i={background:"#fff"};return v(e.style,i,"union"),e}return l(e,t),e}(P),I=function(t){function e(){var e=t.call(this)||this;e.span1=1,e.span2=1;var i={overflow:"hidden",boxSizing:"border-box",whiteSpace:"nowrap",textOverflow:"ellipsis",background:"#fff"};return v(e.style,i,"union"),e}return l(e,t),e}(E),_=function(){function t(){this.tableList=new L,this.table=new $,this.topThead=new E,this.leftThead=new E,this.topIndexThead=new N,this.leftIndexThead=new N,this.baseTbody=new S,this.baseCell=new w,this.cellContainer=new P,this.baseContainer=new x,this.theadContainer=new I,this.leftIndexThead.style.width="80px"}return t.getInstance=function(e){var i;return i=this.instances.hasOwnProperty(e)?this.instances[e]:this.instances[e]=new t,i},t.instances={},t}(),M=function(){function t(t){this.content="",this.selectionStart=0,this.oldValue="",this.title="",this.status="normal",this.readonly=!1,this.displayType="text",this.EPI_READY=!0,this.userData={},this.displayClass={normal:{displayType:"text"},dbclick:{displayType:"input",select:{optionList:[]}},readonly:{displayType:"text"}},this.$defConfigId="defConfig",this.formula={hasFormula:!1,tmpValue:"",canClickAdd:!0},this.style={},this.verification={state:!0,hasVerification:!1,vTypes:[],message:{integer:"必须输入整型",notNull:"该项是必填项",number:"您好请输入数字类型:例如 123|32|3.5....",date:"您好请输入正确时间:例如 2019-01-01",decimal:"您好请输入正确数字"}},this.select={selectOption:null,optionList:[]},this.config=new w,this.warningMessage=[],this.renderState={inRender:!1,hasrendered:!1},this.$ICObject={},this.value=t.value||"",this.$parent=t.$parent,this.$defConfigId=t.$defConfigId||this.$defConfigId,this.$defaultConfig=_.getInstance(this.$defConfigId),this.setConfig(this.$defaultConfig.baseCell),t.config&&this.setConfig(t.config)}return Object.defineProperty(t.prototype,"value",{get:function(){return this.$value},set:function(t){this.renderState.hasrendered=!1,this.$value=t},enumerable:!0,configurable:!0}),t.prototype.setConfig=function(t){var e=c(t);try{e&&(v(this.config,e,"union"),v(this.style,e.style,"union"),v(this,this.config))}catch(t){console.error(t)}},t.prototype.doVerify=function(t){var e=this;this.warningMessage=[];var i=!0;this.verification.state=!0;var o=this.content+"";return this.verification.hasVerification&&this.verification.vTypes.forEach(function(n){if(i=!0,"number"===n&&o)i=!isNaN(o);else if("date"===n&&o){var a=/((?!0000)[0-9]{4}-((0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-8])|(0[13-9]|1[0-2])-(29|30)|(0[13578]|1[02])-31)|([0-9]{2}(0[48]|[2468][048]|[13579][26])|(0[48]|[2468][048]|[13579][26])00)-02-29)/;i=a.test(o)}else if("integer"===n&&o){a=/^[+]{0,1}(\d+)$/;i=i&&a.test(o)}else if(-1!==n.indexOf("decimal")&&o){var r=n.match(/%[0-9]+/),s=0;null!==r&&(s=Number(r[0].replace("%","")));a=void 0;if(a=0===s?/^\d+(\.\d+)*$/:new RegExp("^\\d+(\\.\\d{1,"+s+"})?$"),i=i&&a.test(o),i){var l=o.indexOf("."),c=0;if(-1!==l){var d=o.split(".")[1].length;c=s-d}else o+=0===s?"":".",c=s;o+=new Array(c).fill(0).join("")}for(var h="",u=0;u<s;u++)h+="1";e.verification.message[n]=e.verification.message[n]||"您好请输入最多"+s+"位小数:例如 3."+h}else"notNull"===n&&(i=""!==o&&void 0!==o&&null!==o);i||e.warningMessage.push(n),t&&("date"!==n||i||(e.$value=o="1990-01-01"),e.content=o),e.verification.state=e.verification.state&&i}),i},t.prototype.setCellData=function(t){var e=this;for(var i in t)if(this.hasOwnProperty(i)||"value"===i){var o=t[i];if(-1!==i.indexOf("$")||void 0===o)continue;"displayClass"===i?(v(this.displayClass,o,"union"),v(this,this.displayClass[this.status])):"object"!==typeof o||Array.isArray(o)?this.setProperty(i,o):v(e[i],o,"union")}},t.prototype.setProperty=function(t,e){void 0!==e&&(this[t]=e,this.renderState.hasrendered=!1)},t.prototype.getProperty=function(t){return this[t]},t.prototype.clone=function(t,e,i){return d(this,t,e,i)},t.prototype.onFocus=function(t){this.checkHasFormula();this.checkLastCharStatus(t)},t.prototype.onMouseOver=function(t){switch(this.displayType){case"input":t.srcElement.focus();break}},t.prototype.onMouseUp=function(t){this.checkLastCharStatus(t)},t.prototype.checkLastCharStatus=function(t){this.selectionStart=t.target.selectionStart;var e=this.selectionStart-1,i=(this.$value+"").substr(e,1),o=this.$parent;console.log("char:"+i),/^[\+\-\*\/\=]$/.test(i)?(this.formula.canClickAdd=!0,o.$positionManager.canFocus=!1,o.$positionManager.$editContainer=o,this.formula.tmpValue=this.$value):(this.formula.canClickAdd=!1,o.$positionManager.canFocus=!0,o.$positionManager.$editContainer=null)},t.prototype.onInput=function(t){this.checkLastCharStatus(t)},t.prototype.checkHasFormula=function(){if(this.$parent){var t=/^=/;if(t.test(this.$value)){this.formula.hasFormula=!0;var e=/[A-Z]+[0-9]+$/g;e.test(this.$value)?this.formula.canClickAdd=!0:this.formula.canClickAdd=!1,this.formula.canClickAdd=!0}else this.formula.hasFormula=!1}return this.formula.hasFormula},t.prototype.click=function(t){t.stopPropagation();var e=this.displayClass[this.status].displayType;switch(e){case"button":this.$parent&&this.$parent.rootParentSendMsg({ev_type:"click",event:t,data:{objectName:"button",object:this}});break}},t.prototype.onDbClick=function(t){this.readonly||(this.status="dbclick",v(this,this.displayClass[this.status],"union"));var e=this.$parent;e&&e.rootParentSendMsg({ev_type:"dbclick",event:t,data:{objectName:"Cell",object:this}})},t.prototype.inputOnBlur=function(t,e){var i=this;this.status="normal",this.onBlur(t);var o=this.$parent;if(this.render(),this.verification.state||this.warningMessage.forEach(function(t){i.warning(i.verification.message[t])}),o){if(e){var n=o.getContainer(o.position);n.setCell(this),n.cell.render(),o.$positionManager.canFocus=!0,o.$positionManager.$editContainer=null}o.rootParentSendMsg({ev_type:"blur",event:t,data:{objectName:"Cell",object:this}})}},t.prototype.onBlur=function(t){this.readonly||(this.status="normal",this.oldValue=this.$value,v(this,this.displayClass[this.status]))},t.prototype.warning=function(t){alert(t)},t.prototype.onKeyDown=function(t){"Enter"===t.key?t.target.blur():"Escape"===t.key&&(this.$value=this.oldValue,t.target.blur())},t.prototype.onChange=function(t){switch(this.readonly||(this.status="normal"),this.renderState.hasrendered=!1,this.displayType){case"select":var e=t.target.selectedIndex;this.select.selectOption=this.select.optionList[e];break}var i=this.$parent;i&&i.rootParentSendMsg({ev_type:"change",event:t,data:{objectName:"Cell",object:this}})},t.prototype.checkStatus=function(){var t=this.$parent;if(void 0!==this.config.readonly)this.readonly=this.config.readonly;else if(t){var e=t.$rootParent;void 0!==t.config.readonly?this.readonly=t.config.readonly:e&&void 0!==e.config.readonly&&(this.readonly=e.config.readonly)}!0===this.readonly?this.status="readonly":this.status="normal"},t.prototype.render=function(){var t=this,e=this.$parent;if(e&&(this.style.width=e.style.width,this.style.height=e.style.height,this.style.lineHeight=e.style.height),!this.renderState.hasrendered||this.formula.hasFormula){if(this.renderState.inRender){this.content=0;var i=e.position;console.error("重复引用:table"+i.table+"!"+i.colStr+i.rowStr)}else{if(this.renderState.inRender=!0,this.checkHasFormula(),e&&this.formula.hasFormula){var o=/(table[0-9]+!)?[A-Z]+[0-9]+/g,n=this.$value.replace(/^=/,""),a=this.$value;n=C.curlyBracesHandle(n,e);var r={},s=n.match(o);(s||[]).forEach(function(i){var o,s=C.cellStr2Position(i);if(s.table=s.table||e.position.table,t.$ICObject.hasOwnProperty(i))if(o=t.$ICObject[i],o){var l=(s.table===e.position.table?"":"table"+o.position.table+"!")+o.position.colStr+o.position.rowStr;r[l]=o,a=g(a,l,"back_"+l),a=-1!==a.search("back_"+i)?g(a,"back_"+i,l):g(a,i,l)}else console.error("cell:render() result为空");else o=e.getContainer(s),t.$ICObject[i]=o,r[i]=o;o&&o.cell&&(o.cell.render(),n=n.replace(i,o.cell.content||0))}),this.$value=a,this.$ICObject=r,n=C.complexEval(n),this.content=n}else this.content=this.$value||"";this.renderState.inRender=!1}this.doVerify(!0),this.checkStatus()}},t}(),D=function(){function t(t){this.positionMap={},this.tableList=[],this.$editContainer=null,this.canFocus=!0,this.type=t}return t.getInstance=function(e){var i=this.instances[e];return i||(this.instances[e]=i=new t(e)),i},t.prototype.add=function(t){var e=!1,i=0;this.tableList.forEach(function(o,n){o.id===t.id&&(e=!0,i=n)}),e?(this.tableList.splice(i,1,t),t.position.table=i):(t.position.table=this.tableList.length,this.tableList.push(t))},t.prototype.render=function(){this.tableList.forEach(function(t){t.render()})},t.prototype.getContainer=function(t,e){var i=null;try{if(t){e=e||"source";var o=c(t);o.table=o.table+e;var n=this.positionMap[o.table];if(n){var a=n[o.colStr];a&&(i=a[o.rowStr])}}}catch(t){console.error("getContainer发生错误"),console.log(t)}return i},t.prototype.getTopIndexContainer=function(t,e){e=e||"source";var i=c(t);return i.rowStr=0,this.getContainer(i,e)},t.prototype.getLeftIndexContainer=function(t,e){e=e||"source";var i=c(t);return i.colStr="@",this.getContainer(i,e)},t.prototype.getColObj=function(t,e){e=e||"source";var i=c(t);i.table=i.table+e;var o=null,n=this.positionMap[i.table];if(n){var a=n[i.colStr];o=a}return o},t.prototype.getRowObj=function(t,e){e=e||"source";var i=c(t);i.table=i.table+e;var o=null,n=this.positionMap[i.table];if(n)for(var a in o={},n)if(n.hasOwnProperty(a)){var r=n[a];o[a]=r[i.rowStr]}return o},t.prototype.setPositionMap=function(t,e,i){i=i||"source";var o=c(t);o.table=o.table+i,this.positionMap.hasOwnProperty(o.table)||(this.positionMap[o.table]={});var n=this.positionMap[o.table];n.hasOwnProperty(o.colStr)||(n[o.colStr]={});var a=n[o.colStr];a[o.rowStr]=e},t.prototype.saveLastPositionMap=function(t){var e=c(t),i=this.positionMap[e.table+"source"];for(var o in i)if(i.hasOwnProperty(o)){var n=i[o];for(var a in n)if(n.hasOwnProperty(a)){var r=n[a],s=c(e);s.colStr=o,s.rowStr=a,this.setPositionMap(s,r.clone([],["$","userData"]),"last")}}return this.positionMap[e.table+"last"]},t.instances={},t}(),O=function(){function t(t){this.id=null,this.EPI_READY=!0,this.config={},this.style={},this.position={table:0,colNum:0,rowNum:0},this.userData={},this.$defConfigId="defConfig",this.$positionManagerId="single-table",this.id=t.id,this.$defConfigId=t.$defConfigId||this.$defConfigId,this.$positionManagerId=t.$positionManagerId||this.$positionManagerId,this.$defaultConfig=_.getInstance(t.$defConfigId),this.$positionManager=D.getInstance(t.$positionManagerId)}return t.prototype.setConfig=function(t){var e=c(t);try{e&&(v(this.config,e,"union"),v(this.style,e.style,"union"),v(this,this.config))}catch(t){console.error(t)}},t.prototype.setProperty=function(t,e){void 0!==e&&(this[t]=e)},t.prototype.onClick=function(t){},t.prototype.getContainer=function(t,e){return this.$positionManager.getContainer(t,e)},t.prototype.getTopIndexContainer=function(t,e){return this.$positionManager.getTopIndexContainer(t,e)},t.prototype.getLeftIndexContainer=function(t,e){return this.$positionManager.getLeftIndexContainer(t,e)},t.prototype.getRowObj=function(t,e){return this.$positionManager.getRowObj(t,e)},t.prototype.getColObj=function(t,e){return this.$positionManager.getColObj(t,e)},t.prototype.saveLastPositionMap=function(t){return this.$positionManager.saveLastPositionMap(t)},t}(),k=function(t){function e(e){var i=t.call(this,e)||this;return i.cell=new M({$parent:i}),i.isRootParent=!1,i.span1=1,i.span2=1,i.widthNum=0,i.heightNum=0,i.widthChildNum=0,i.heightChildNum=0,i.tips={style:{width:"12px",height:"12px",marginTop:"-6px",top:"50%",right:"2px"}},i.type=e.type,i.side1=null==e.side1?1:e.side1,i.side2=null==e.side2?1:e.side2,0===i.side1&&0===i.side2&&(i.isRootParent=!0),i.$rootTable=e.$rootTable,i.$rootParent=e.$rootParent,i.isRootParent||(t.prototype.setConfig.call(i,i.$defaultConfig.cellContainer),i.setConfig(e.config)),i}return l(e,t),e.prototype.setCell=function(t){this.cell=t},e.prototype.onClick=function(t){this.rootParentSendMsg({ev_type:"click",event:t,data:{objectName:"CellContainer",object:this}})},e.prototype.onBlur=function(t){},e.prototype.clone=function(t,e,i){return d(this,t,e,i)},e.prototype.onMouseDown=function(t){var e={ev_type:"mouseDown",event:t,data:{objectName:"CellContainer",object:this}};if(3===t.which?(e.ev_type="rightClick",this.rootParentSendMsg(e)):2===t.which&&(e.ev_type="middleClick",this.rootParentSendMsg(e)),!this.$positionManager.canFocus&&this.$positionManager.$editContainer!==this)return t&&t.preventDefault?t.preventDefault():window.event.returnValue=!1,!1},e.prototype.clearCell=function(){if(this.cell){this.cell;this.cell=new M({$parent:this})}},e.prototype.delThisRow=function(t){this.$rootTable.delOneRowCol(t,this)},e.prototype.onPaste=function(t){var e;if(e=t.clipboardData&&t.clipboardData.getData?t.clipboardData.getData("Text"):t.originalEvent.clipboardData.getData("Text"),this.cell){this.cell.value=e;var i={ev_type:"paste",event:t,data:{objectName:"CellContainer",object:this}};this.$rootParent&&this.rootParentSendMsg(i)}return e},e.prototype.rootParentSendMsg=function(t){this.$rootParent&&this.$rootParent.subjectSend(t)},e}(O),j=function(t){function e(e){var i=t.call(this,e)||this;return i.canSum=!1,i.canExpand=!1,i.canDragResize=!1,i.dragType=0,i.draggable=!0,i.positionCheck=!0,i.childrenShow=!0,i.children=[],i.mergeList=[],i.theadPosition=new Array,i.side2Name="height",i.side1Name="width",i.tbodyConfig={weight:{cell:{displayClass:{normal:100,dbclick:100}}},container:{}},/^top/.test(i.type)?(i.side1Name="width",i.side2Name="height"):/^left/.test(i.type)&&(i.side1Name="height",i.side2Name="width"),i.isRootParent||(t.prototype.setConfig.call(i,i.$defaultConfig.theadContainer),i.setConfig(e.config)),i.span1=void 0==e.span1?1:e.span1,i.span2=void 0==e.span2?1:e.span1,i}return l(e,t),e.prototype.setParent=function(t){this.$parent=t},e.prototype.setCell=function(t){this.cell=t},e.prototype.setContainerData=function(t){var e=this,i=this,o=function(o){if(i.hasOwnProperty(o)){var a=t[o];if("children"===o){var r=Array();a.forEach(function(t){if(t&&t.EPI_READY){var i=e.createContain(t);r.push(i)}}),n.setProperty(o,r)}else if("tbodyConfig"===o&&a)n.setProperty(o,a);else if("cell"===o&&a){var s=new M({$parent:n});s.setCellData(a),n.setProperty(o,s)}else"object"!==typeof a||Array.isArray(a)||-1!==o.indexOf("$")?n.setProperty(o,a):v(i[o],a,"union")}},n=this;for(var a in t)o(a)},e.prototype.resize=function(t,e){var i=this;this.resetByIndexContainer();var o=Number(this.style[this.side2Name].replace("px",""));this[this.side2Name+"Num"]=Number(this.style[this.side2Name].replace("px","")),this[this.side1Name+"Num"]=Number(this.style[this.side1Name].replace("px","")),this.span2=1,this.side2=1,"none"===this.style.display&&(this.span1=1,this.span2=0,this.side1=1,this.side2=0,this[this.side2Name+"Num"]=0,o=0),this.isRootParent&&(this.span1=0,this.span2=0,this.side1=0,this.side2=0,o=0);var n=0,a=0,r=0,s=0;if(0!==this.children.length)this.children.forEach(function(o,l){var c=i.theadPosition.concat(l);o.theadPosition=c,!1===i.childrenShow?(o.style.display="none",o.childrenShow=!1):delete o.style.display,o.resize(t,e),n+=o.side1,a=o.side2>a?o.side2:a,r+=o[i.side1Name+"Num"],s=o[i.side2Name+"Num"]>s?o[i.side2Name+"Num"]:s}),this.side1=n,this[this.side1Name+"Num"]=r,this.span1=n,this.style[this.side1Name]=r+"px",this[this.side2Name+"ChildNum"]=s,this.side2=a+this.side2,this[this.side2Name+"Num"]=s+o,this.makeChildrenSameSide2(a,s);else if(0!==this.mergeList.length);else{t&&!this.isRootParent&&t.push(this);var l=this.theadPosition.length-1;if(e&&l>=0&&0!==this.side2&&1===this.span2){var c=e[l];(!c||this.theadPosition.length>c.theadPosition.length)&&(e[l]=this)}}this.cell&&this.cell.render()},e.prototype.resetByIndexContainer=function(){var t=this.$positionManager.getTopIndexContainer(this.position,"last");t&&(this.style.width=t.widthNum+"px");var e=this.$positionManager.getLeftIndexContainer(this.position,"last");e&&(this.style.height=e.heightNum+"px")},e.prototype.addChild=function(t,e){return e=void 0===e||null===e?this.children.length:e,t.id||(t.id="def_"+b()),this.children.splice(e,0,t),t.id},e.prototype.deletChild=function(t,e,i){var o=this;if(e=null==e?1:e,i)this.children.splice(t,e);else{for(var n=t+e,a=t;a<t+e;a++)this.children[a].children.forEach(function(t,e){o.addChild(t,n),n++});this.children.splice(t,e)}},e.prototype.replaceChild=function(t,e,i){if(t.id||(t.id="def_"+b()),i)this.children.splice(e,1,t);else{var o=[];this.children[e].children.forEach(function(t,e){o.push(t)}),this.children.splice(e,1,t),t.children=t.children.concat(o)}},e.prototype.getTopList=function(t,e){var i=this;try{this.position=c(e),this.position.colStr=m(e.colNum),this.position.rowStr=e.rowNum+1;var o=this.clone([],["$","userData"],!0);this.$positionManager.setPositionMap(this.position,this,"source"),this.$positionManager.setPositionMap(this.position,o,"clone"),t[0].push(o);var n=c(e);0!==this.children.length&&this.children.forEach(function(o){var a=c(e);a.rowNum=e.rowNum+i.span2,a.colNum=n.colNum,o.getTopList(u(t),a),n.colNum+=o.side1})}catch(t){}},e.prototype.getLeftList=function(t,e){var i=this;this.position=c(e),this.position.colStr=m(e.colNum),this.position.rowStr=e.rowNum+1;var o=this.clone([],["$","userData"],!0);this.$positionManager.setPositionMap(this.position,this,"source"),this.$positionManager.setPositionMap(this.position,o,"clone");var n=[[]];0===f(this.theadPosition)?t[0].push(o):n[0].push(o);var a=c(e);return this.children.forEach(function(o,r){var s,l=c(a);l.colNum=e.colNum+i.span2,l.rowNum=a.rowNum,s=o.getLeftList(n[0].length>0?n:t,l);try{n="[[]]"===JSON.stringify(n)?[]:n}catch(t){try{s="[[]]"===JSON.stringify(s)?[]:s}catch(t){}}n=n.concat(s),a.rowNum+=o.side1}),n},e.prototype.createContain=function(t){var i=this.$positionManagerId,o=this.$defConfigId,n=new e({type:this.type,side1:1,side2:1,$rootTable:this.$rootTable,$rootParent:this.$rootParent,$positionManagerId:i,$defConfigId:o,config:this.$rootParent.config});if(t&&n.setContainerData(t),!n.cell){var a=new M({$parent:this});n.setCell(a)}return n},e.prototype.onMouseMove=function(t){if(this.$rootTable.config.canResizeWidth&&0===this.dragType&&1===this.side1){T.removeBorder(t.currentTarget);var e=T.checkBearing(t,{bottom:10,right:10});"right"===e&&"left-index"!==this.type?(t.srcElement.style.cursor="e-resize",T.addBorder(t.currentTarget,e),this.canDragResize=!0,this.draggable=!1):"bottom"===e&&"top-index"!==this.type?(t.srcElement.style.cursor="s-resize",T.addBorder(t.currentTarget,e),this.canDragResize=!0,this.draggable=!1):t.srcElement.style.cursor="auto"}},e.prototype.onMouseOut=function(t){t.currentTarget.style.cursor="auto",T.removeBorder(t.currentTarget),this.canDragResize=!1,this.draggable=!0},e.prototype.onMouseDown=function(e){var i=this;if(1===e.which&&this.$rootTable.config.canResizeWidth&&this.canDragResize){this.dragType="e-resize"===e.srcElement.style.cursor?1:2,this.draggable=!1,this.$rootTable.$selectBoxEntity.clear();var o={};o.initMouseLeftX=e.pageX,o.initMouseTopY=e.pageY,o.initWidth=e.target.clientWidth,o.initHeight=e.target.clientHeight,o.initLeft=e.pageX-o.initWidth,o.initTop=e.pageY-o.initHeight,o.x=o.initLeft,o.y=o.initTop;var n,a=0,r=1===this.dragType?"width":"height",s=function(t){var e=t.pageX-o.initMouseLeftX;if(!(-1*e>i.style.minWidth)){var s=t.pageY-o.initMouseTopY;if(!(-1*s>o.initHeight))for(var l in 1===i.dragType?(a=e,n=i.getColObj(i.position,"clone")):2===i.dragType&&(a=s,n=i.getRowObj(i.position,"clone")),n)if(n.hasOwnProperty(l)){var c=n[l];if(c){var d=c[r+"Num"]-c[r+"ChildNum"];c.style[r]=d+a+"px",c.cell.style[r]=d+a+"px","height"===r&&(c.cell.style.lineHeight=d+a+"px")}}}},l=function(t){for(var o in document.removeEventListener("mouseup",l),document.removeEventListener("mousemove",s),1===i.dragType?n=i.getColObj(i.position,"source"):2===i.dragType&&(n=i.getRowObj(i.position,"source")),n)if(n.hasOwnProperty(o)){var c=n[o];if(c){var d=c[r+"Num"];if(/index/.test(c.type)){var h=c.$theadContainer;h&&(d=h[r+"Num"]-h[r+"ChildNum"],h.style[r]=d+a+"px",h.cell.style[r]=d+a+"px")}c.style[r]=d+a+"px",c[r+"Num"]=d+a}}i.$positionManager.saveLastPositionMap(i.position),i.$positionManager.render(),i.draggable=!0,i.dragType=0,e.srcElement.style.cursor="auto"};document.addEventListener("mousemove",s),document.addEventListener("mouseup",l)}t.prototype.onMouseDown.call(this,e)},e.prototype.increaseTheLeafChildHeight=function(t,e){if(0!==this.children.length&&this.childrenShow)this.children.forEach(function(i){i.increaseTheLeafChildHeight(t,e)}),this.side2+=t;else if(0!==this.side2){var i=Number(this.style[this.side2Name].replace("px",""));this.style[this.side2Name]=i+e+"px",this[this.side2Name+"Num"]=i+e,this.span2+=t,this.cell.render(),this.side2+=t}},e.prototype.makeChildrenSameSide2=function(t,e){var i=this;this.children.forEach(function(o){var n=t-o.side2,a=e-o[o.side2Name+"Num"];if(n>0||a>0)o.increaseTheLeafChildHeight(n,a);else{var r=o.theadPosition.length-1;i.$rootParent.leafIndexList2&&r>=0&&1===o.span2&&(i.$rootParent.leafIndexList2[r]=o)}})},e}(k),B=function(){function t(){this.callbackList=new Array}return t.prototype.subscribe=function(t,e){this.callbackList.push({fun:t,arg:e})},t.prototype.unsubscribe=function(t,e){var i=-1;this.callbackList.forEach(function(o,n){o==={fun:t,arg:e}&&(i=n)}),i>-1&&this.callbackList.splice(i,1)},t.prototype.sendMsg=function(t){this.notify(t)},t.prototype.notify=function(t){this.callbackList.forEach(function(e){e.fun.call(e.arg,t)})},t}(),A=function(t){function e(e){var i=t.call(this,e)||this;return i.cell=null,i.config={},i.leafIndexList=[],i.leafIndexList2=[],i.dragStartData=null,i.theadSubject=new B,e.id&&(t.prototype.setConfig.call(i,i.$defaultConfig[e.id]),i.setConfig(e.config)),i.$rootParent=i,i}return l(e,t),e.prototype.setConfig=function(e){try{switch(t.prototype.setConfig.call(this,e),this.type){case"top":break;case"left":var i=this.config.baseSide1;this.config.baseSide1=this.config.baseSide2,this.config.baseSide2=i;break}}catch(t){console.error("CellContainer error"),console.error(t)}},e.prototype.subjectSend=function(t){this.theadSubject.sendMsg(t)},e.prototype.dragStart=function(t,e){this.draggable&&(this.dragStartData=e,t.dataTransfer.setData("dragStartData",JSON.stringify(c(this.dragStartData,["$"]))),this.subjectSend({ev_type:"dragStart",event:t,data:{object:e,objectName:"dragStartData"}}))},e.prototype.dragOver=function(t,e){if(this.draggable){var i=t.currentTarget;if(this.resetDragOverStyle(i,e),e.positionCheck){var o=T.checkBearing(t);T.addBorder(i,o,3,"#000"),"inner"===o&&T.addBackgroundColor(i,"red")}t.preventDefault()}},e.prototype.dragLeave=function(t,e){if(this.draggable){var i=t.currentTarget;T.addBackgroundColor(i,this.style.background),this.resetDragOverStyle(i,e)}},e.prototype.drop=function(t,e){try{var i=t.dataTransfer.getData("dragStartData"),o=this.dragStartData?this.dragStartData:JSON.parse(i||"{}"),n=void 0,a=this;if(e.positionCheck){var r=T.checkBearing(t);a=this.getContainerByTheadPosition(e.theadPosition),n={target:{containerData:a},targetBearing:r,source:{containerData:o.containerData},operationType:o.operationType}}else n={target:{containerData:a},targetBearing:"other",source:{containerData:o.containerData},operationType:o.operationType};var s=t.currentTarget;this.resetDragOverStyle(s,e),this.subjectSend({ev_type:"drop",event:t,data:{object:n,objectName:"DragTsData"}}),this.dragStartData=null,s=null}catch(t){console.error(t)}},e.prototype.dragDel=function(t,e){var i=this.getParentConatiner(e.theadPosition);i.deletChild(f(e.theadPosition),1,!0),this.subjectSend({ev_type:"drop-del",event:t,data:{object:e,objectName:"TheadContainer"}})},e.prototype.getContainerByTheadPosition=function(t){var e=this;return(t||[]).forEach(function(t){e=e.children[t]}),e},e.prototype.resize=function(){this.leafIndexList=[],this.leafIndexList2=[],t.prototype.resize.call(this,this.leafIndexList,this.leafIndexList2)},e.prototype.convert2TheadTopList=function(t){this.leafIndexList=[],this.resize();for(var e=[],i=0;i<this.side2;i++)e.push([]);var o=c(t);return this.children.forEach(function(t){t.getTopList(e,o),o.rowNum=o.rowNum,o.colNum=o.colNum+t.side1}),e},e.prototype.convert2TheadLeftList=function(t){this.leafIndexList=[],this.resize();var e=[],i=c(t);return this.children.forEach(function(t,o){0===o&&e.push([]);var n=t.getLeftList(e,i);try{n="[[]]"===JSON.stringify(n)?[]:n}catch(t){}e=e.concat(n),i.rowNum=i.rowNum+t.side1,i.colNum=i.colNum}),e},e.prototype.merge=function(t){var e=this,i=this.getContainerByTheadPosition(t.theadPosition||[]);i.mergeList=t.mergeList,i.mergeList.forEach(function(t){if(i.cell&&t.cell){var o=e.getContainerByTheadPosition(t.theadPosition);o.style.display="none"}})},e.prototype.disMerge=function(t){var e=this,i=this.getContainerByTheadPosition(t.theadPosition||[]);i.mergeList=t.mergeList,i.mergeList.forEach(function(t){if(i.cell&&t.cell){var o=e.getContainerByTheadPosition(t.theadPosition);o.style.display="table-cell"}})},e.prototype.getParentConatiner=function(t){var e=p(t,1);return this.getContainerByTheadPosition(e)},e.prototype.resetDragOverStyle=function(t,e){T.removeBorder(t),T.removeBackgroundColor(t),T.addBackgroundColor(t,e.style.background)},e}(j),R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.children=new Array,e.renderByThead=!0,e}return l(e,t),e.prototype.setContainerData=function(t,e,i,o){for(var n in this)if(this.hasOwnProperty(n)){var a=this.getDataByWeight(n,t,e,i,o);if(void 0===a)continue;"cell"===n&&a?this.cell.setCellData(a):"object"!==typeof a||Array.isArray(a)||-1!==n.indexOf("$")?this.setProperty(n,a):v(this[n],a,"union")}},e.prototype.getDataByWeight=function(t,e,i,o,n){var a,r=e&&e[t]||void 0,s=i&&i[t]||void 0,l=o&&o[t]||void 0,c=n&&n[t]||void 0;if(r&&s)if(l&&c)if(isNaN(l)||isNaN(c)){if(!isNaN(l)&&isNaN(l))a=r;else if(isNaN(l)&&!isNaN(l))a=s;else if("object"===typeof l&&"object"===typeof c){for(var d in a={},r)if(r.hasOwnProperty(d)&&!a.hasOwnProperty(d)){var h=this.getDataByWeight(d,r,s,l,c);a[d]=h}for(var d in s)if(s.hasOwnProperty(d)&&!a.hasOwnProperty(d)){h=this.getDataByWeight(d,r,s,l,c);a[d]=h}}}else a=l>c?r:s;else l&&!c?a=r:!l&&c?a=s:l||c||(a=r);else void 0===r&&s?a=s:r&&void 0===s&&(a=r);return a},e}(k),H=function(t){function e(e){var i=t.call(this,e)||this;return i.topIndexList=new Array,i.leftIndexList=new Array,i.bodyData={},i.tbodySubject=new B,i.$rootParent=i,i.cell=null,e.id&&(t.prototype.setConfig.call(i,i.$defaultConfig[e.id]),i.setConfig(e.config)),i}return l(e,t),e.prototype.subjectSend=function(t){this.tbodySubject.sendMsg(t)},e.prototype.setRowData=function(t,e){var i=this;try{t=t||"tbody_"+b();var o=e||{};if(Array.isArray(o))o.forEach(function(e,o){var n=i.createContain();-1!==["string","number"].indexOf(typeof e)?n.cell.value=e:"object"===typeof e&&n.setContainerData(e);var a=i.topIndexList[o].id;i.setData(t,a,n)});else if("object"===typeof o)for(var n in o)if(o.hasOwnProperty(n)){var a=o[n],r=this.createContain();-1!==["string","number"].indexOf(typeof a)?r.cell.value=a:"object"===typeof a&&r.setContainerData(a),this.setData(t,n,r)}return t}catch(t){return console.error("setRowData数据有误"),console.error(t),null}},e.prototype.setColData=function(t,e){var i=this;try{t=t||"tbody_"+b();var o=e||{};if(Array.isArray(o))o.forEach(function(e,o){var n=i.createContain();if(-1!==["string","number"].indexOf(typeof e)?n.cell.value=e:"object"===typeof e&&(n=e),i.leftIndexList[o]){var a=i.leftIndexList[o].id;i.setData(a,t,n)}});else if("object"===typeof o)for(var n in o)if(o.hasOwnProperty(n)){var a=o[n],r=this.createContain();-1!==["string","number"].indexOf(typeof a)?r.cell.value=a:"object"===typeof a&&(r=a),this.setData(n,t,r)}return t}catch(t){return console.error("setColData"),console.error(t),null}},e.prototype.setData=function(t,e,i){var o;try{var n=this.bodyData[t];n||(this.bodyData[t]=n={}),n[e]?n[e].setContainerData(i):n[e]=this.createContain(i),o=n[e]}catch(t){console.error(t)}return o},e.prototype.setContainerData=function(t){for(var e in t)if(t.hasOwnProperty(e)){var i=t[e];if("bodyData"===e){for(var o in i)if(i.hasOwnProperty(o)){var n=i[o];this.setRowData(o,n)}}else"object"!==typeof i||Array.isArray(i)||-1!==e.indexOf("$")?this.setProperty(e,i):v(this[e],i,"union")}},e.prototype.resize=function(){this.side1=this.topIndexList.length,this.side2=this.leftIndexList.length},e.prototype.initData=function(t,e){for(var i=0;i<e;i++)this.setRowData()},e.prototype.createContain=function(t){var e=this.$positionManagerId,i=this.$defConfigId,o=new R({type:"tbody",side1:1,side2:1,$rootTable:this.$rootTable,$rootParent:this,$positionManagerId:e,$defConfigId:i,config:this.$rootParent.config});return t&&o.setContainerData(t),o},e.prototype.render=function(){var t=this,e=this.leftIndexList,i=this.topIndexList;this.resize(),e.forEach(function(e){var o={};t.bodyData.hasOwnProperty(e.id)&&(o=t.bodyData[e.id]),i.forEach(function(i){var n=t.createContain();o.hasOwnProperty(i.id)?n=o[i.id]:o[i.id]=n,n.position={table:t.$rootTable.position.table,colNum:i.theadPosition[0],rowNum:e.theadPosition[0],colStr:m(i.theadPosition[0]),rowStr:e.theadPosition[0]+1},n.id=[e.id,i.id],t.$positionManager.setPositionMap(n.position,n,"source");var a,r=e.$theadContainer,s=i.$theadContainer,l=e.tbodyConfig.container,c=i.tbodyConfig.container;if(/sum/.test(e.id)?(c=null,a=r):/sum/.test(i.id)&&(l=null,a=s),(/sum/.test(i.id)||/sum/.test(e.id))&&(e.canSum||void 0===s)&&(i.canSum||void 0===r)){for(var d=a.$rootParent.getContainerByTheadPosition(p(a.theadPosition)),h=new Array,u=0,y=0;y<f(a.theadPosition);y++)u+=d.children[y].side1;for(y=0;y<u;y++)if("top"===a.type&&y){var b=m(a.position.colNum-y-1)+n.position.rowStr;h.push(b)}else{b=n.position.colStr+(a.position.rowNum-y);h.push(b)}n.renderByThead&&(n.cell.value="="+h.join("+"))}1==n.renderByThead&&n.setContainerData(l,c,e.tbodyConfig.weight,i.tbodyConfig.weight),n.style.width=i.style.width,n.style.height=e.style.height,n.cell.render(),n.widthNum=Number(n.style.width.replace("px","")),n.heightNum=Number(n.style.height.replace("px",""))}),t.bodyData[e.id]=o})},e.prototype.getContainerById=function(t){var e=null;try{var i=t[0],o=t[1];if(this.bodyData.hasOwnProperty(i)){var n=this.bodyData[i];n.hasOwnProperty(o)&&(e=n[o])}}catch(t){console.error("发生错误")}return e},e.prototype.convert=function(){var t=this,e=new Array;return this.leftIndexList.forEach(function(i){if(t.bodyData.hasOwnProperty(i.id)){var o=t.bodyData[i.id],n=new Array;t.topIndexList.forEach(function(e){if(o.hasOwnProperty(e.id)){var i=o[e.id];n.push(i),t.$positionManager.setPositionMap(i.position,i,"clone")}}),e.push(n)}}),e},e.prototype.output=function(){var t=this,e=new Array;return this.leftIndexList.forEach(function(i){if(t.bodyData.hasOwnProperty(i.id)){var o=t.bodyData[i.id],n={};t.topIndexList.forEach(function(t){o.hasOwnProperty(t.id)&&(n[t.id]=o[t.id].cell.content)}),e.push(n)}}),e},e.prototype.output2=function(){var t=this,e={};return this.leftIndexList.forEach(function(i){if(t.bodyData.hasOwnProperty(i.id)){var o=t.bodyData[i.id],n={};t.topIndexList.forEach(function(t){o.hasOwnProperty(t.id)&&(n[t.id]=o[t.id].clone(["$"]))}),e[i.id]=n}}),e},e.prototype.clone=function(e,i,o){var n={};return e=e||[],e.push("bodyData"),n=t.prototype.clone.call(this,e,i,o),n.bodyData=this.output2(),n},e}(R),z=function(t){function e(e){var i=t.call(this,e)||this;return i.positionCheck=!1,i.canSum=!0,i}return l(e,t),e.prototype.update=function(t){this.tbodyConfig=t.tbodyConfig,this.canSum=t.canSum,this.id=t.id||this.id,this.$theadContainer=t,/left/.test(this.type)?this.style.height=t.style.height:/top/.test(this.type)&&(this.style.width=t.style.width)},e}(j),F=function(t){function e(e){var i=t.call(this,e)||this;return i.children=new Array,i.indexTheadSubject=new B,i.leafIndexList=[],i.leafIndexList2=[],e.id&&(t.prototype.setConfig.call(i,i.$defaultConfig[e.id]),i.setConfig(e.config)),i.$rootParent=i,i.cell=null,i}return l(e,t),e.prototype.getContainerByTheadPosition=function(t){var e=this;return(t||[]).forEach(function(t){e=e.children[t]}),e},e.prototype.subjectSend=function(t){this.indexTheadSubject.sendMsg(t)},e.prototype.render=function(){var t=this;this.resize(),this.children.forEach(function(e,i){e.position.table=t.$rootTable.position.table,e.id||(e.id="def2.0_"+i),e.cell&&(-1!==e.type.indexOf("top")?(e.position.colNum=i,e.position.colStr=m(i),e.position.rowStr=0,e.cell.value=m(i)):-1!==e.type.indexOf("left")&&(e.position.colStr="@",e.position.rowNum=i,e.position.rowStr=i+1,e.cell.value=i+1),1===t.$rootTable.config.debugLevel?e.cell.value=e.id:t.$rootTable.config.debugLevel,t.$positionManager.setPositionMap(e.position,e,"source"),e.cell.render())})},e.prototype.createContain=function(t){var e=this.$positionManagerId,i=this.$defConfigId,o=new z({type:this.type,side1:1,side2:1,$rootParent:this.$rootParent,config:this.$rootParent.config,$rootTable:this.$rootTable,$defConfigId:i,$positionManagerId:e});if(t&&o.setContainerData(t),!o.cell){var n=new M({$parent:o});o.setCell(n)}return o},e.prototype.fastAddChild=function(){var t=this.createContain();this.addChild(t)},e.prototype.convert=function(){var t=this,e=new Array;return this.children.forEach(function(i){var o=i.clone([],["$"],!0);t.$positionManager.setPositionMap(o.position,o,"clone"),e.push(o)}),e},e}(z),W=function(){function t(t,e){this.selectSet=new Set,this.selectList=new Array,this.size=0,this.stlye={position:"absolute",zIndex:98},this.type=t,this.$TableContainer=e}return t.getInstance=function(e,i){var o=this.instances[e];return o||(this.instances[e]=o=new t(e,i)),o},t.prototype.createSelectContainer=function(t,e){var i=e.clone([],["$","userData"],!0),o=98;switch(e.type){case"top":o=100,i.fixTop=!0;break;case"left":o=100,i.fixLeft=!0;break;case"tbody":o=96;break}console.log("zIndex:"+o),i.topStyle={position:"absolute",left:t.offsetLeft+"px",top:t.offsetTop+"px",width:t.offsetWidth+"px",borderBottom:"2px solid blue",boxSizing:"border-box",zIndex:o},i.bottomStyle={position:"absolute",left:t.offsetLeft+"px",top:t.offsetTop+t.clientHeight+"px",width:t.offsetWidth+"px",boxSizing:"border-box",borderTop:"2px solid blue",zIndex:o},i.leftStyle={position:"absolute",left:t.offsetLeft+"px",top:t.offsetTop+"px",height:t.offsetHeight+"px",borderLeft:"2px solid blue",boxSizing:"border-box",zIndex:o},i.rightStyle={position:"absolute",left:t.offsetLeft+t.clientWidth+"px",top:t.offsetTop+"px",height:t.offsetHeight+"px",borderLeft:"2px solid blue",boxSizing:"border-box",zIndex:o};var n=i.style;return n.position="absolute",n.zIndex=o,n.width=t.offsetWidth+"px",n.height=t.offsetHeight+"px",n.left=t.offsetLeft+"px",n.top=t.offsetTop+"px",i},t.prototype.add=function(t){this.currentCotanier=t;var e=this.selectSet.add(t);return this.render(),e},t.prototype.has=function(t){var e=!1;return this.selectList.forEach(function(i){JSON.stringify(i.id)===JSON.stringify(t.id)&&(e=!0)}),e},t.prototype.delete=function(t){var e=this.selectSet.delete(t);return this.render(),e},t.prototype.clear=function(){this.currentCotanier=null;var t=this.selectSet.clear();return this.render(),t},t.prototype.forEach=function(t,e){this.selectSet.forEach(t,e)},t.prototype.render=function(){this.selectList=Array.from(this.selectSet),this.size=this.selectList.length},t.prototype.convert=function(){return this.selectList},t.instances={},t}(),Y=function(t){function e(e){var i=t.call(this,e)||this;return i.$selectBoxId=e.$selectBoxId,i.$selectBoxEntity=W.getInstance(i.$selectBoxId,i),i}return l(e,t),e.prototype.setDefaultConfig=function(t){try{v(this.$defaultConfig,t,"union")}catch(t){console.error("initDefaultConfig error")}},e.prototype.setConfig=function(e){t.prototype.setConfig.call(this,e),this.$selectBoxEntity.clear()},e.prototype.renderAll=function(){this.$positionManager.render()},e}(O),V=function(t){function e(e,i){var o=t.call(this,{id:e,$selectBoxId:i&&i.tableGroupId?i.tableGroupId:e,$defConfigId:i&&i.tableGroupId?i.tableGroupId:e,$positionManagerId:i&&i.tableGroupId?i.tableGroupId:e})||this;return o.position={table:0,colNum:0,rowNum:0},o.style={scrollTop:0,scrollLeft:0,mainTable:{},topTable:{},leftTable:{}},o.tableSubject=new B,o.tableName="",o.showType=0,o.colNumber=new Array,o.rowNumber=new Array,o.tableHeadTop=new Array,o.tableHeadLeft=new Array,o.tableBody=new Array,o.tableHeadTopLeft=new j({side1:1,side2:1,$rootTable:o}),o.keyDownSet=new Set,o.$positionManager.add(o),o.setConfig(o.$defaultConfig.table),o.setConfig(i),o.initial(),o}return l(e,t),e.prototype.initial=function(){var t=this.$defConfigId,e=this.$positionManagerId;this.theadTopEntity=new A({id:"topThead",type:"top",$defConfigId:t,$positionManagerId:e,$rootTable:this,side1:0,side2:0}),this.theadLeftEntity=new A({id:"leftThead",type:"left",$defConfigId:t,$positionManagerId:e,$rootTable:this,side1:0,side2:0}),this.theadTopIndexEntity=new F({id:"topIndexThead",type:"top-index",$defConfigId:t,$positionManagerId:e,$rootTable:this,side1:0,side2:0}),this.theadLeftIndexEntity=new F({id:"leftIndexThead",type:"left-index",$defConfigId:t,$positionManagerId:e,$rootTable:this,side1:0,side2:0}),this.tbodyEntity=new H({id:"baseTbody",type:"tbody",$defConfigId:t,$positionManagerId:e,$rootTable:this,side1:0,side2:0});var i={table:this.position.table,colStr:"A",rowStr:1};this.tableHeadTopLeft.position=i,this.initSubject(this)},e.prototype.onDestroy=function(){var t=this;t.theadTopEntity.theadSubject.unsubscribe(t.onReceiveMsg,t),t.theadLeftEntity.theadSubject.subscribe(t.onReceiveMsg,t),t.tbodyEntity.tbodySubject.subscribe(t.onReceiveMsg,t)},e.prototype.initSubject=function(t){t=t||this,t.theadTopEntity&&t.theadTopEntity.theadSubject.subscribe(t.onReceiveMsg,t),t.theadLeftEntity&&t.theadLeftEntity.theadSubject.subscribe(t.onReceiveMsg,t),t.tbodyEntity&&t.tbodyEntity.tbodySubject.subscribe(t.onReceiveMsg,t)},e.prototype.subjectSend=function(t){this.tableSubject.sendMsg(t)},e.prototype.setConfig=function(e){t.prototype.setConfig.call(this,e);var i={mainTable:{overflow:this.config.isOverflow?"auto":"visible",maxWidth:this.config.isOverflow?this.config.maxWidth:"auto",maxHeight:this.config.isOverflow?this.config.maxHeight:"auto"},leftTable:{overflow:this.config.isOverflow?"hidden":"visible",height:this.config.isOverflow?"calc("+this.config.maxHeight+" - 17px)":"auto"},topTable:{overflow:this.config.isOverflow?"hidden":"visible",maxWidth:this.config.isOverflow?"calc("+this.config.maxWidth+" - 17px)":"auto"}};v(this.style,i,"union")},e.prototype.setDefaultConfig=function(e){t.prototype.setDefaultConfig.call(this,e),this.setConfig(this.$defaultConfig.table),this.theadTopEntity.setConfig(this.$defaultConfig.topThead),this.theadLeftEntity.setConfig(this.$defaultConfig.leftThead),this.theadTopIndexEntity.setConfig(this.$defaultConfig.topIndexThead),this.theadLeftIndexEntity.setConfig(this.$defaultConfig.leftIndexThead),this.tbodyEntity.setConfig(this.$defaultConfig.baseTbody),this.render()},e.prototype.initTable=function(t,e){for(var i=0;i<t;i++)this.theadTopIndexEntity.fastAddChild(),this.theadAdd({type:"top",targetParentPosition:[]});e=void 0===e?1:e;for(var o=0;o<e;o++)this.addOneRow();this.renderAll()},e.prototype.addOneRow=function(t,e){var i,o=null,n=!1,a=this.$selectBoxEntity.currentCotanier;if(e?(i={type:"left",targetParentPosition:e.targetParentPosition,insertIndex:e.insertIndex,sourceContainerData:e.sourceContainerData},n=!0):0!==this.tableHeadLeft.length&&(n=!0),a){var r=void 0;if(/^left$/.test(a.type))r={type:"left",targetParentPosition:p(a.theadPosition),insertIndex:f(a.theadPosition)+1};else{var s=this.getLeftIndexContainer(a.position);if(s&&s.$theadContainer){var l=s.$theadContainer;r={type:"left",targetParentPosition:p(l.theadPosition),insertIndex:f(l.theadPosition)+1}}}i=v(r,i,"union")}else{var c={type:"left",targetParentPosition:[]};i=v(c,i,"union")}n&&(o=this.theadAdd(i));var d=this.theadLeftIndexEntity.createContain();return this.theadLeftIndexEntity.addChild(d),o=this.tbodyEntity.setRowData(o,t||{}),d.id=o,this.renderAll(),o},e.prototype.addOneCol=function(t,e){var i,o=null,n=!1,a=this.$selectBoxEntity.currentCotanier;if(e?(i={type:"top",targetParentPosition:e.targetParentPosition,insertIndex:e.insertIndex,sourceContainerData:e.sourceContainerData},n=!0):0!==this.tableHeadTop.length&&(n=!0),a){var r=void 0;if(/^top$/.test(a.type))r={type:"top",targetParentPosition:p(a.theadPosition),insertIndex:f(a.theadPosition)+1};else if(/^tbody$/.test(a.type)){var s=this.getTopIndexContainer(a.position);if(s&&s.$theadContainer){var l=s.$theadContainer;r={type:"top",targetParentPosition:p(l.theadPosition),insertIndex:f(l.theadPosition)+1}}}i=v(r,i,"union")}else{var c={type:"top",targetParentPosition:[]};i=v(c,i,"union")}n&&(o=this.theadAdd(i));var d=this.theadTopIndexEntity.createContain();return o=this.tbodyEntity.setColData(o,t||{}),d.id=o,this.theadTopIndexEntity.addChild(d),this.renderAll(),o},e.prototype.setTbodyData=function(t){var e=this;try{if(Array.isArray(t))t.forEach(function(t,i){var o=e.tbodyEntity.leftIndexList[i].id;e.tbodyEntity.setRowData(o,t)});else if("object"===typeof t)for(var i in t)t.hasOwnProperty(i)&&this.tbodyEntity.setRowData(i,t[i])}catch(t){console.error(t),console.error("输入数据格式有误")}this.renderAll()},e.prototype.theadAddPlace=function(t,e){var i=t.targetContainerPosition,o=this.getEntity(t.type),n=f(i),a=p(i),r=o.getContainerByTheadPosition(a);if(t.sourceContainerData){var s=o.createContain(t.sourceContainerData);r.replaceChild(s,n,t.withChildren)}!1!==e&&this.onReceiveMsg({ev_type:"theadAddPlace",event:null,data:{objectName:"ParamTheadAddReplace",object:t}})},e.prototype.theadAdd=function(t,e){var i=null;try{t.sourceContainerData||(t.sourceContainerData={cell:{value:""}});var o=this.getEntity(t.type),n=o.getContainerByTheadPosition(t.targetParentPosition),a=o.createContain(t.sourceContainerData);i=n.addChild(a,t.insertIndex),o.resize(),!1!==e&&this.onReceiveMsg({ev_type:"theadAdd",event:null,data:{objectName:"ParamTheadAdd",object:t}})}catch(t){console.error(t),this.onReceiveMsg({ev_type:"error",event:null,data:{objectName:"error",object:t}})}return i},e.prototype.theadMove=function(t,e){try{var i=f(t.sourceContainerData.theadPosition),o=p(t.sourceContainerData.theadPosition);if(t.sourceContainerData){var n=this.getEntity(t.type),a=n.getContainerByTheadPosition(t.targetParentPosition),r=this.getEntity(t.sourceContainerData.type),s=r.getContainerByTheadPosition(o),l=r.getContainerByTheadPosition(t.sourceContainerData.theadPosition);JSON.stringify(o)===JSON.stringify(t.targetParentPosition)&&i>t.insertIndex?(s.deletChild(i,1,t.withChildren),a.addChild(l,t.insertIndex)):(a.addChild(l,t.insertIndex),s.deletChild(i,1,t.withChildren)),t.withChildren||(l.children=new Array),n.resize(),r.resize()}!1!==e&&this.onReceiveMsg({ev_type:"theadMove",event:null,data:{objectName:"ParamTheadMove",object:t}})}catch(t){this.onReceiveMsg({ev_type:"error",event:null,data:{objectName:"theadMove",object:t}})}},e.prototype.theadDelete=function(t,e){try{var i=void 0,o=void 0,n=void 0,a=void 0,r=!1,s=!1,l=this.$selectBoxEntity.currentCotanier;if(t&&(o=f(t.targetContainerPosition),n=p(t.targetContainerPosition),i=t.targetContainerPosition,a=t.type,r=t.withChildren,s=!0),l&&(o=void 0!==o?o:f(l.theadPosition),n=void 0!==n?n:p(l.theadPosition),i=void 0!==i?i:l.theadPosition,a=a||l.type,s=!0),s){var c=this.getEntity(a),d=(c.getContainerByTheadPosition(i),c.getContainerByTheadPosition(n));d.deletChild(o,1,r),c.resize(),!1!==e&&this.onReceiveMsg({ev_type:"theadDelete",event:null,data:{objectName:"ParamTheadDelete",object:t}})}else console.error("theadDelete 未传入参数")}catch(t){this.onReceiveMsg({ev_type:"error",event:null,data:{objectName:"theadDelete",object:t}})}},e.prototype.theadMoveReplace=function(t,e){try{var i=t.targetContainerPosition,o=f(i),n=p(i),a=this.getEntity(t.type),r=a.getContainerByTheadPosition(n),s=f(t.sourceContainerData.theadPosition),l=p(t.sourceContainerData.theadPosition),c=this.getEntity(t.sourceContainerData.type),d=c.getContainerByTheadPosition(l);if(t.sourceContainerData){t.withChildren||(t.sourceContainerData.children=new Array);var h=a.createContain(t.sourceContainerData);r.replaceChild(h,o,!1),d.deletChild(s,1,t.withChildren),a.resize(),c!==a&&c.resize(),!1!==e&&this.onReceiveMsg({ev_type:"theadMoveReplace",event:null,data:{objectName:"ParamTheadMoveReplace",object:t}})}}catch(t){this.onReceiveMsg({ev_type:"error",event:null,data:{objectName:"theadMoveReplace",object:t}})}},e.prototype.addSum=function(t,e){var i={tbodyConfig:{container:{cell:{displayClass:{normal:{displayType:"text"},dbclick:{displayType:"text"}}}}},id:"sum_"+b(),canSum:!0},o={sourceContainerData:{cell:{value:"合计"}}};v(o.sourceContainerData,t,"union"),e&&v(o,e,"union");var n=this.$selectBoxEntity.currentCotanier;if(n&&/^top$|^left$/.test(n.type)){var a={type:n.type,targetParentPosition:p(n.theadPosition),sourceContainerData:o.sourceContainerData};v(o,a,"union")}v(o.sourceContainerData,i,"union"),this.theadAdd(o),this.renderAll()},e.prototype.delOneRowCol=function(t,e){var i=this,o=this.$selectBoxEntity.currentCotanier;e=e||o;var n,a=function(t){var e=i.getEntity(t.type),o=e.getContainerByTheadPosition(p(t.theadPosition));i.theadDelete({type:t.type,targetContainerPosition:t.theadPosition,withChildren:!0}),0!==o.children.length||o.isRootParent||a(o)},r="row"===t?"left":"top";if("tbody"===e.type){var s=this.getContainer(e.position),l="left"===r?s.position.rowNum:s.position.colNum,c=this.getEntity(r+"-index"),d=c.getContainerByTheadPosition([l]);n=d.$theadContainer,n||this.theadDelete({type:r+"-index",targetContainerPosition:d.theadPosition})}else{n=e;var h=e.position,u=this.$positionManager.getColObj(h);for(var f in u)u.hasOwnProperty(f);var y=n.getTopIndexContainer(n.position),b=n.getLeftIndexContainer(n.position);y&&"col"===t&&this.theadDelete({type:"top-index",targetContainerPosition:y.theadPosition}),b&&"row"===t&&this.theadDelete({type:"left-index",targetContainerPosition:b.theadPosition})}n&&a(n),this.renderAll()},e.prototype.getEntity=function(t){switch(t){case"top":return this.theadTopEntity;case"left":return this.theadLeftEntity;case"top-index":return this.theadTopIndexEntity;case"left-index":return this.theadLeftIndexEntity;case"tbody":return this.tbodyEntity;default:return console.log("getEntity-default"),this.theadTopEntity}},e.prototype.getTbodyData=function(t){var e={};switch(t){case 0:e=this.tbodyEntity.output();break;default:e=this.tbodyEntity.output()}return e},e.prototype.render=function(){this.resizeTable(),this.indexTheadRender();var t=this.theadTopEntity.side2,e=this.theadLeftEntity.side2;if(this.theadTopEntity){var i=c(this.position);i.colNum=e,i.rowNum=0,this.tableHeadTop=this.theadTopEntity.convert2TheadTopList(i)}if(this.config.hasLeftThead){var o=c(this.position);o.colNum=0,o.rowNum=t,this.tableHeadLeft=this.theadLeftEntity.convert2TheadLeftList(o)}var n=new M({value:this.id,$parent:this.tableHeadTopLeft});this.tableHeadTopLeft.style.width=this.theadLeftEntity.widthNum+"px",this.tableHeadTopLeft.widthNum=this.theadLeftEntity.widthNum,this.tableHeadTopLeft.style.height=this.theadTopEntity.heightNum+"px",this.tableHeadTopLeft.heightNum=this.theadTopEntity.heightNum,this.tableHeadTopLeft.setCell(n),n.render(),t>0&&e>0&&(this.$positionManager.setPositionMap(this.tableHeadTopLeft.position,this.tableHeadTopLeft,"source"),this.$positionManager.setPositionMap(this.tableHeadTopLeft.position,this.tableHeadTopLeft,"clone")),this.renderTBody(),this.$selectBoxEntity.clear(),this.saveLastPositionMap(this.position)},e.prototype.serialize=function(){var t={};try{for(var e in this)if(this.hasOwnProperty(e)){var i=this[e];if(Array.isArray(i)||/\$/.test(e))continue;if("object"===typeof i){if(-1!==e.indexOf("Subject"))continue;"keyDownSet"===e||(i.EPI_READY?t[e]=i.clone(["Subject","$"],["userData"]):t[e]=this[e])}else t[e]=this[e]}}catch(t){console.error("serialize 中出现出错"),console.error(t)}return t},e.prototype.deserialize=function(t){var e=c(t),i=this;try{for(var o in e)if(e.hasOwnProperty(o)){var n=e[o];n.EPI_READY?i[o].setContainerData(n):"$selectBoxEntity"===o||"keyDownSet"===o||(i[o]=n)}this.renderAll()}catch(t){console.error("Deserialize 中出现出错"),console.error(t)}},e.prototype.addParent=function(t){var e,i=this;if(this.$selectBoxEntity.size>0){var o=this.$selectBoxEntity.selectList;e=o[0];var n=this.isSameParent(o);if(n&&e){var a=this.getEntity(e.type);if(null===a)return;var r=new Array;this.$selectBoxEntity.forEach(function(t){r.push(i.getContainer(t.position))}),r.sort(function(t,e){return f(e.theadPosition)-f(t.theadPosition)}),e=f(r);var s=p(e.theadPosition,1);t=t||{cell:{value:"新建合计",data:""}};var l=a.createContain(t);r.forEach(function(t){l.addChild(t,0),i.theadDelete({type:e.type,targetContainerPosition:t.theadPosition,withChildren:!0})}),this.theadAdd({type:e.type,targetParentPosition:s,insertIndex:f(e.theadPosition),sourceContainerData:l}),this.renderAll()}}this.$selectBoxEntity.clear()},e.prototype.onKeyUp=function(t){this.keyDownSet.delete(t.key)},e.prototype.onKeyDown=function(t){console.log(t.key),this.keyDownSet.add(t.key)},e.prototype.dragLeave=function(t,e){var i=-1!==e.type.indexOf("top")?"top":"left",o=this.getEntity(i);o.dragLeave(t,e)},e.prototype.dragStart=function(t,e){var i=this.getEntity(e.type),o={operationType:"move",containerData:e};i.dragStart(t,o)},e.prototype.dragEnd=function(t,e){var i=this.getEntity(e.type);i.dragStartData=null},e.prototype.dragOver=function(t,e){if(e){var i=-1!==e.type.indexOf("top")?"top":"left",o=this.getEntity(i);o.dragStartData?e!==o.dragStartData.containerData&&o.dragOver(t,e):o.dragOver(t,e)}else t.preventDefault()},e.prototype.drop=function(t,e){if(e){var i=-1!==e.type.indexOf("top")?"top":"left",o=this.getEntity(i);o.drop(t,e)}},e.prototype.getTheadLeavesList1=function(t){var e=null;try{var i=this.getEntity(t);e=i.leafIndexList}catch(t){console.error("获取错误")}return e},e.prototype.merge=function(){var t=this;if(this.canMerge()){var e=window.confirm("合并单元格时只保留左上单元格，删除其他单元格，确定合并？");if(!0!==e)return;this.$selectBoxEntity.selectList.sort(function(t,e){return f(e.theadPosition)-f(t.theadPosition)}),this.$selectBoxEntity.selectList.forEach(function(e,i){i<t.$selectBoxEntity.selectList.length-1&&t.theadDelete({targetContainerPosition:e.theadPosition,type:e.type})}),this.renderAll()}},e.prototype.disMerge=function(){var t=this;this.$selectBoxEntity.forEach(function(e,i){if(e.mergeList.length>0){var o=t.getEntity(e.type);o.disMerge(e)}}),this.$selectBoxEntity.clear(),this.renderAll()},e.prototype.canMerge=function(){var t=this.$selectBoxEntity.selectList,e=this.isSameParent(t);return e},e.prototype.onScroll=function(t){this.style.scrollTop=t.srcElement.scrollTop,this.style.scrollLeft=t.srcElement.scrollLeft},e.prototype.renderTBody=function(){this.tbodyEntity.topIndexList=this.colNumber.slice(0+this.theadLeftEntity.side2,this.colNumber.length),this.config.hasLeftThead,this.tbodyEntity.leftIndexList=this.rowNumber.slice(0+this.theadTopEntity.side2,this.rowNumber.length),this.tbodyEntity.render(),this.tableBody=this.tbodyEntity.convert()},e.prototype.resizeTable=function(){var t,e,i=this;this.theadTopEntity.resize(),this.theadLeftEntity.resize(),this.theadTopIndexEntity.resize(),this.theadLeftIndexEntity.resize();var o=this.theadTopEntity.side1,n=this.theadTopEntity.side2,a=this.theadLeftEntity.side1,r=this.theadLeftEntity.side2,s=this.theadTopIndexEntity.side1,l=this.theadLeftIndexEntity.side1,c=function(){o>0?(i.theadTopIndexEntity.deletChild(r,s,!0),i.theadTopIndexEntity.resize(),s=i.theadTopIndexEntity.side1,i.theadTopEntity.leafIndexList.forEach(function(t,e){var o=e+r,n=i.theadTopIndexEntity.createContain(),a=i.theadTopEntity.getContainerByTheadPosition(t.theadPosition);n.update(t),a.$IndexContainer=n,o+1>s?i.theadTopIndexEntity.addChild(n):i.theadTopIndexEntity.replaceChild(n,o)})):i.theadTopIndexEntity.children.forEach(function(t,e){if(e+1<=r){var o=i.theadLeftEntity.leafIndexList2[e],n=i.theadTopIndexEntity.createContain();n.update(o),/tbody/.test(t.id)?i.theadTopIndexEntity.addChild(n,e):i.theadTopIndexEntity.replaceChild(n,e)}else e+1>r&&!/tbody/.test(t.id)&&i.theadTopIndexEntity.deletChild(e,1,!0)})},d=function(){a>0?(i.theadLeftIndexEntity.deletChild(n,l,!0),i.theadLeftIndexEntity.resize(),l=i.theadLeftIndexEntity.side1,i.theadLeftEntity.leafIndexList.forEach(function(t,e){var o=e+n,a=i.theadLeftIndexEntity.createContain(),r=i.theadLeftEntity.getContainerByTheadPosition(t.theadPosition);r.$IndexContainer=a,a.update(t),o+1>l?i.theadLeftIndexEntity.addChild(a):i.theadLeftIndexEntity.replaceChild(a,o)})):i.theadLeftIndexEntity.children.forEach(function(t,e){if(e+1<=n){var o=i.theadTopEntity.leafIndexList2[e],a=i.theadLeftIndexEntity.createContain();a.update(o),/tbody/.test(t.id)?i.theadLeftIndexEntity.addChild(a,e):i.theadLeftIndexEntity.replaceChild(a,e)}else e+1>n&&!/tbody/.test(t.id)&&i.theadLeftIndexEntity.deletChild(e,1,!0)})};if(s<=o+r){if(t=o+r,t){for(var h=0;h<r;h++){var u=this.theadTopIndexEntity.getContainerByTheadPosition([h]),p=this.theadLeftEntity.leafIndexList2[h],f=this.theadTopIndexEntity.createContain();f.update(p),h+1>s||/tbody/.test(u.id)?this.theadTopIndexEntity.addChild(f):this.theadTopIndexEntity.replaceChild(f,h)}c()}}else t=s,c();if(this.theadLeftIndexEntity.render(),l=this.theadLeftIndexEntity.side1,l<=a+n){if(e=a+n,e){for(var y=0;y<n;y++){var b=this.theadLeftIndexEntity.getContainerByTheadPosition([y]);p=this.theadTopEntity.leafIndexList2[y],f=this.theadLeftIndexEntity.createContain();f.update(p),y+1>l||/tbody/.test(b.id)?this.theadLeftIndexEntity.addChild(f,y):this.theadLeftIndexEntity.replaceChild(f,y)}d()}}else e=l,d()},e.prototype.afterDrop=function(t){var e=this;if(t){var i=[],o=null,n=t.target.withChildren,a=t.source.withChildren,r=t.target.containerData,s=t.source.containerData,l=t.operationType;if(void 0===a&&s.children&&0!==s.children.length){var d=window.confirm("整组移动？");a=!0===d}var h=function(){if(/replace/.test(l));else if(r.cell&&r.cell.value){var t=window.confirm("该单元格已存在数据，是否替换？");if(!0!==t)return;l+="-replace"}else l+="-replace";if(void 0===n&&r.children&&r.children.length>0){t=window.confirm("是否删除该单元格的子节点");if(!0!==t)return;n=!0}i=p(r.theadPosition,1),o=f(r.theadPosition)},u=function(){var t=c(r.theadPosition),n=e.getContainer(s.position,"source");i=p(r.theadPosition,1),o=f(r.theadPosition);var d=p(r.theadPosition,1),h=f(r.theadPosition);e.processThead({operationType:l,param:{type:r.type,targetParentPosition:d,insertIndex:h,withChildren:a,sourceContainerData:s}});var u=n?n.theadPosition:t;if(a){var y=s;if(y){var b=(y.children||[]).length>0;while(b)y=y.children[0],b=(y.children||[]).length>0,u.push(0)}}e.theadMove({type:r.type,targetParentPosition:u,sourceContainerData:r,insertIndex:0,withChildren:!0},!1)};if(/top/.test(r.type))switch(t.targetBearing){case"left":i=p(r.theadPosition,1),o=f(r.theadPosition);break;case"right":i=p(r.theadPosition,1),o=f(r.theadPosition)+1;break;case"top":return void u();case"bottom":i=r.theadPosition,o=null;break;case"inner":h();break;default:i=r.theadPosition,o=null;break}else if(/left/.test(r.type))switch(t.targetBearing){case"top":i=p(r.theadPosition,1),o=f(r.theadPosition);break;case"bottom":i=p(r.theadPosition,1),o=f(r.theadPosition)+1;break;case"left":return void u();case"right":i=r.theadPosition,o=null;break;case"inner":h();break;default:i=r.theadPosition,o=null;break}this.processThead({operationType:l,param:{type:r.type,insertIndex:o,withChildren:n,targetParentPosition:i,sourceContainerData:s,targetContainerPosition:r.theadPosition}})}},e.prototype.mutiPaste=function(t){},e.prototype.isSameParent=function(t){var e,i=!0;return t.forEach(function(t){e?e.type!==t.type?i=!1:JSON.stringify(p(t.theadPosition,1))!==JSON.stringify(p(e.theadPosition,1))&&(i=!1):e=t}),i},e.prototype.indexTheadRender=function(){this.theadLeftIndexEntity.render(),this.theadTopIndexEntity.render(),this.colNumber=this.theadTopIndexEntity.convert(),this.rowNumber=this.theadLeftIndexEntity.convert()},e.prototype.onReceiveMsg=function(t){switch(this.subjectSend(t),t.ev_type){case"drop":this.afterDrop(t.data.object),this.renderAll();break;case"click":this.afterContainerClick(t.event,t.data.object);break;case"rightClick":this.afterContainerRClick(t.event,t.data.object);break;default:}-1!==this.config.renderEvent.indexOf(t.ev_type)&&this.renderAll()},e.prototype.processThead=function(t){var e=t.param;switch(t.operationType){case"add":this.theadAdd(e,!1);break;case"move":this.theadMove(e,!1);break;case"add-replace":this.theadAddPlace(e,!1);break;case"move-replace":this.theadMoveReplace(e,!1);break;case"delete":this.theadDelete(e,!1);break;default:}},e.prototype.afterContainerClick=function(t,e){var i=t.currentTarget,o=this.$selectBoxEntity.createSelectContainer(i,e);this.keyDownSet.has("Control")||this.$selectBoxEntity.clear(),this.$selectBoxEntity.add(o);var n=this.$positionManager.$editContainer;if(n&&n.cell&&n.cell.formula.canClickAdd&&n.id!==e.id){var a=n.cell.formula.tmpValue,r=a.split(""),s="";this.$positionManager.$editContainer.position.table!==this.position.table&&(s="table"+e.position.table+"!"),s+=e.position.colStr+e.position.rowStr,r.splice(n.cell.selectionStart,0,s);var l=document.activeElement;n.cell.value=r.join(""),l.value=r.join(""),l.selectionStart=n.cell.selectionStart+s.length,l.selectionEnd=n.cell.selectionStart+s.length,console.log(l.value)}focus()},e.prototype.afterContainerRClick=function(t,e){var i=t.currentTarget,o=this.$selectBoxEntity.createSelectContainer(i,e);this.$selectBoxEntity.has(o)||(this.$selectBoxEntity.clear(),this.$selectBoxEntity.add(o)),focus()},e}(Y),J=r.a.component("MyTable",{props:{inputTable:Object},data:function(){return{myTable:this.inputTable||new V("test")}},watch:{inputTable:function(t,e){this.myTable=t||e}},created:function(){console.log(this.myTable.tableId)}}),X=J;i("0599");function G(t,e,i,o,n,a,r,s){var l,c="function"===typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=i,c._compiled=!0),o&&(c.functional=!0),a&&(c._scopeId="data-v-"+a),r?(l=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},c._ssrRegister=l):n&&(l=s?function(){n.call(this,this.$root.$options.shadowRoot)}:n),l)if(c.functional){c._injectStyles=l;var d=c.render;c.render=function(t,e){return l.call(e),d(t,e)}}else{var h=c.beforeCreate;c.beforeCreate=h?[].concat(h,l):[l]}return{exports:t,options:c}}var U=G(X,o,n,!1,null,"7a5dd938",null);U.options.__file="TableCom.vue";var K=U.exports,Z=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",t._l(t.tableList.children,function(t){return i("MyTable",{key:t.id,attrs:{inputTable:t}})}))},q=[],Q=function(t){function e(e,i){var o=t.call(this,{id:e,$selectBoxId:i&&i.positionManagerId?i.selectBoxId:e,$defConfigId:e,$positionManagerId:i&&i.positionManagerId?i.positionManagerId:e})||this;return o.children=new Array,o.tableListSubject=new B,o.$positionManager=D.getInstance("multi-table"),o.defaultConfig=new _,o.config=new L,o}return l(e,t),e.prototype.onTableSendMsg=function(t){this.subjectSend(t),-1!==this.config.renderEvent.indexOf(t.ev_type)&&this.$positionManager.render()},e.prototype.getTable=function(t){return this.children[t]},e.prototype.createTable=function(t,e){var i={tableGroupId:this.id};v(i,e,"union");var o=new V(t,i);return o.tableSubject.subscribe(this.onTableSendMsg,this),o},e.prototype.addChild=function(t,e){e=void 0===e||null===e?this.children.length:e,t.id||(t.id="def_"+b()),this.children.splice(e,0,t)},e.prototype.render=function(){this.$positionManager.render()},e.prototype.subjectSend=function(t){this.tableListSubject.sendMsg(t)},e}(Y),tt=r.a.component("TableListCom",{props:{TableContanerCom:Object},components:{MyTable:K},data:function(){return{tableList:this.TableContanerCom||new Q("def")}},methods:{}}),et=tt,it=(i("26e6"),G(et,Z,q,!1,null,null,null));it.options.__file="TableListCom.vue";var ot=it.exports;i.d(e,"TableCom",function(){return K}),i.d(e,"TableListCom",function(){return ot}),i.d(e,"BaseTable",function(){return V}),i.d(e,"BaseTableList",function(){return Q})}})});
//# sourceMappingURL=drag-table.umd.min.js.map