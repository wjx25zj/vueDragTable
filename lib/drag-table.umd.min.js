(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e(require("vue")):"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["drag-table"]=e(require("vue")):t["drag-table"]=e(t["Vue"])})("undefined"!==typeof self?self:this,function(t){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="fae3")}({"1eb2":function(t,e,n){var i;"undefined"!==typeof window&&((i=window.document.currentScript)&&(i=i.src.match(/(.+\/)[^/]+\.js$/))&&(n.p=i[1]))},"24c9":function(t,e,n){"use strict";var i=n("dbfa"),o=n.n(i);o.a},"65d9":function(t,e,n){"use strict";
/**
  * vue-class-component v6.2.0
  * (c) 2015-present Evan You
  * @license MIT
  */function i(t){return t&&"object"===typeof t&&"default"in t?t["default"]:t}Object.defineProperty(e,"__esModule",{value:!0});var o=i(n("8bbf")),r={__proto__:[]}instanceof Array;function a(t){return function(e,n,i){var o="function"===typeof e?e:e.constructor;o.__decorators__||(o.__decorators__=[]),"number"!==typeof i&&(i=void 0),o.__decorators__.push(function(e){return t(e,n,i)})}}function s(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return o.extend({mixins:t})}function l(t){var e=typeof t;return null==t||"object"!==e&&"function"!==e}function c(t,e){var n=e.prototype._init;e.prototype._init=function(){var e=this,n=Object.getOwnPropertyNames(t);if(t.$options.props)for(var i in t.$options.props)t.hasOwnProperty(i)||n.push(i);n.forEach(function(n){"_"!==n.charAt(0)&&Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){return t[n]=e},configurable:!0})})};var i=new e;e.prototype._init=n;var o={};return Object.keys(i).forEach(function(t){void 0!==i[t]&&(o[t]=i[t])}),o}var h=["data","beforeCreate","created","beforeMount","mounted","beforeDestroy","destroyed","beforeUpdate","updated","activated","deactivated","render","errorCaptured"];function d(t,e){void 0===e&&(e={}),e.name=e.name||t._componentTag||t.name;var n=t.prototype;Object.getOwnPropertyNames(n).forEach(function(t){if("constructor"!==t)if(h.indexOf(t)>-1)e[t]=n[t];else{var i=Object.getOwnPropertyDescriptor(n,t);"function"===typeof i.value?(e.methods||(e.methods={}))[t]=i.value:(i.get||i.set)&&((e.computed||(e.computed={}))[t]={get:i.get,set:i.set})}}),(e.mixins||(e.mixins=[])).push({data:function(){return c(this,t)}});var i=t.__decorators__;i&&(i.forEach(function(t){return t(e)}),delete t.__decorators__);var r=Object.getPrototypeOf(t.prototype),a=r instanceof o?r.constructor:o,s=a.extend(e);return u(s,t,a),s}function u(t,e,n){Object.getOwnPropertyNames(e).forEach(function(i){if("prototype"!==i){var o=Object.getOwnPropertyDescriptor(t,i);if(!o||o.configurable){var a=Object.getOwnPropertyDescriptor(e,i);if(!r){if("cid"===i)return;var s=Object.getOwnPropertyDescriptor(n,i);if(!l(a.value)&&s&&s.value===a.value)return}0,Object.defineProperty(t,i,a)}}})}function p(t){return"function"===typeof t?d(t):function(e){return d(e,t)}}(function(t){function e(t){h.push.apply(h,t)}t.registerHooks=e})(p||(p={}));var f=p;e.default=f,e.createDecorator=a,e.mixins=s},"8bbf":function(e,n){e.exports=t},dbfa:function(t,e,n){},fae3:function(t,e,n){"use strict";n.r(e);n("1eb2");var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.myTable?n("div",{staticClass:"clearfix",staticStyle:{position:"relative"},on:{keydown:function(e){t.myTable.onKeyDown(e)},keyup:function(e){t.myTable.onKeyUp(e)}}},[t.myTable.hasLeftFixedTable&&t.myTable.hasTopFixedTable?n("TopLeftFixTable",{attrs:{inputTable:t.myTable}}):t._e(),t.myTable.hasLeftFixedTable?n("LeftFixTable",{attrs:{inputTable:t.myTable}}):t._e(),t.myTable.hasTopFixedTable?n("TopFixTable",{attrs:{inputTable:t.myTable}}):t._e(),n("div",{staticClass:"main-table",style:t.myTable.style.mainTable,attrs:{scrollTop:t.myTable.style.scrollTop},on:{scroll:function(e){t.myTable.onScroll(e)}}},[t.myTable&&t.myTable.$rowNumber[0]&&t.myTable.$colNumber[0]?n("table",{staticClass:"my-table",attrs:{cellspacing:"0",cellpadding:"0",border:"0"}},[t.myTable.isShowColIndex?n("tr",[t.myTable.isShowRowIndex?n("th",{staticClass:"rowNumber",style:{width:t.myTable.$rowNumber[0].style.width,height:t.myTable.$colNumber[0].style.height},attrs:{tabindex:"1"}},[n("div",{style:{width:t.myTable.$rowNumber[0].style.width,height:t.myTable.$colNumber[0].style.height,lineHeight:t.myTable.$colNumber[0].style.height}},[t._v("\n            "+t._s(t.myTable.isTopLeftShow?t.myTable.topLeftValue:"")+"\n          ")])]):t._e(),t._l(t.myTable.$colNumber,function(e,i){return n("th",{key:"col"+i,staticClass:"colNumber",style:[e.style],on:{dragover:function(t){e.dragOver(t)},dragleave:function(t){e.dragLeave(t)},dragenter:function(t){e.dragEnter(t)},drop:function(t){e.drop(t)},mousedown:function(t){e.onMouseDown(t)},mousemove:function(t){e.onMouseMove(t)},mouseout:function(t){e.onMouseOut(t)}}},[n("div",{style:[e.cell.style]},[t._v(t._s(e.cell.content))])])})],2):t._e(),t._l(t.myTable.$rowNumber,function(e,i){return n("tr",{key:e.id},[i<t.myTable.$tableHeadTop.length?[t.myTable.isShowRowIndex?n("th",{staticClass:"rowNumber",on:{mousedown:function(t){e.onMouseDown(t)},mousemove:function(t){e.onMouseMove(t)},mouseout:function(t){e.onMouseOut(t)},dragover:function(t){e.dragOver(t)},dragleave:function(t){e.dragLeave(t)},dragenter:function(t){e.dragEnter(t)},drop:function(t){e.drop(t)}}},[n("div",{style:[e.cell.style]},[t._v("\n              "+t._s(t.myTable.hasLeftFixedTable?"":e.cell.content)+"\n            ")])]):t._e(),0===i&&t.myTable.$tableHeadLeft[0]&&t.myTable.$tableHeadTop[0]?n("th",{staticClass:"colNumber",style:[t.myTable.tableHeadTopLeft.style],attrs:{tabindex:"1",colspan:t.myTable.theadLeftEntity.side2,rowspan:t.myTable.theadTopEntity.side2}},[n("div",{style:[t.myTable.tableHeadTopLeft.cell.style]})]):t._e(),t._l(t.myTable.$tableHeadTop[i],function(e,i){return n("th",{key:e.id,style:[e.style],attrs:{colspan:e.span1,rowspan:e.span2,draggable:e.draggable,tabindex:"1"},on:{click:function(t){e.onClick(t)},dragstart:function(t){e.dragStart(t)},dragend:function(t){e.dragEnd(t)},dragover:function(t){e.dragOver(t)},dragleave:function(t){e.dragLeave(t)},dragenter:function(t){e.dragEnter(t)},drop:function(t){e.drop(t)},mousedown:function(t){e.onMouseDown(t)},mousemove:function(t){e.onMouseMove(t)},mouseout:function(t){e.onMouseOut(t)}}},[e.treeContainer.show?n("svg",{style:e.treeContainer.style,attrs:{viewBox:"0 0 1024 1024"},on:{click:function(t){e.treeContainer.onClick(t)}}},t._l(e.treeContainer.svg[e.treeContainer.$openStatus].paths,function(t){return n("path",{attrs:{d:t}})})):t._e(),t._l(e.selfContainers,function(e){return e.show?n("svg",{style:e.style,attrs:{viewBox:"0 0 1024 1024"},on:{click:function(t){e.onClick(t)}}},t._l(e.svg[e.type].paths,function(t){return n("path",{attrs:{d:t}})})):t._e()}),"text"==e.cell.displayClass[e.cell.status].displayType?n("div",{style:[e.cell.style],attrs:{title:e.cell.title},on:{dblclick:function(t){e.cell.onDbClick(t)}}},[t._v("\n              "+t._s(e.cell.content)+"\n            ")]):t._e(),"input"==e.cell.displayClass[e.cell.status].displayType?n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.cell.value,expression:"th.cell.value"}],style:[e.cell.style],domProps:{value:e.cell.value},on:{mouseover:function(t){e.cell.onMouseOver(t)},blur:function(t){e.cell.inputOnBlur(t,!0)},input:function(n){n.target.composing||t.$set(e.cell,"value",n.target.value)}}})]):t._e(),"button"==e.cell.displayClass[e.cell.status].displayType?n("div",[n("button",{on:{click:function(t){e.cell.onClick(t)}}},[t._v(t._s(e.cell.content))])]):t._e(),"select"==e.cell.displayClass[e.cell.status].displayType?n("select",{directives:[{name:"model",rawName:"v-model",value:e.cell.value,expression:"th.cell.value"}],style:[e.cell.style],attrs:{tabindex:"1"},on:{change:[function(n){var i=Array.prototype.filter.call(n.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(e.cell,"value",n.target.multiple?i:i[0])},function(t){e.cell.onChange(t)}],blur:function(t){e.cell.onBlur(t)}}},t._l(e.cell.select.optionList,function(e){return n("option",{key:e.value,domProps:{value:e.text}},[t._v(t._s(e.text))])})):t._e()],2)})]:[t.myTable.isShowRowIndex?n("th",{staticClass:"rowNumber",style:e.style,on:{mousedown:function(t){e.onMouseDown(t)},mouseout:function(t){e.onMouseOut(t)},mousemove:function(t){e.onMouseMove(t)},dragover:function(t){e.dragOver(t)},dragleave:function(t){e.dragLeave(t)},dragenter:function(t){e.dragEnter(t)},drop:function(t){e.drop(t)}}},[n("div",{style:[e.cell.style]},[t._v("\n              "+t._s(e.cell.content)+"\n            ")])]):t._e(),t._l(t.myTable.$tableHeadLeft[i-t.myTable.$tableHeadTop.length],function(e,i){return n("th",{key:e+i,style:[e.style],attrs:{tabindex:"1",draggable:e.draggable,colspan:e.span2,rowspan:e.span1},on:{click:function(t){e.onClick(t)},blur:function(t){e.onBlur(t)},dragstart:function(t){e.dragStart(t)},dragend:function(t){e.dragEnd(t)},dragover:function(t){e.dragOver(t)},dragleave:function(t){e.dragLeave(t)},dragenter:function(t){e.dragEnter(t)},drop:function(t){e.drop(t)},mousedown:function(t){e.onMouseDown(t)},mousemove:function(t){e.onMouseMove(t)},mouseout:function(t){e.onMouseOut(t)}}},[e.treeContainer.show?n("svg",{style:e.treeContainer.style,attrs:{viewBox:"0 0 1024 1024"},on:{click:function(t){e.treeContainer.onClick(t)}}},t._l(e.treeContainer.svg[e.treeContainer.$openStatus].paths,function(t){return n("path",{attrs:{d:t}})})):t._e(),t._l(e.selfContainers,function(e){return e.show?n("svg",{style:e.style,attrs:{viewBox:"0 0 1024 1024"},on:{click:function(t){e.onClick(t)}}},t._l(e.svg[e.type].paths,function(t){return n("path",{attrs:{d:t}})})):t._e()}),"text"==e.cell.displayClass[e.cell.status].displayType?n("div",{style:[e.cell.style],attrs:{title:e.cell.title},on:{dblclick:function(t){e.cell.onDbClick()}}},[t._v("\n              "+t._s(e.cell.content)+"\n            ")]):t._e(),"input"==e.cell.displayClass[e.cell.status].displayType?n("input",{directives:[{name:"model",rawName:"v-model",value:e.cell.value,expression:"th.cell.value"}],staticStyle:{"background-color":"#fff"},style:[e.cell.style],domProps:{value:e.cell.value},on:{mouseover:function(t){e.cell.onMouseOver(t)},blur:function(t){e.cell.inputOnBlur(t,!0)},input:function(n){n.target.composing||t.$set(e.cell,"value",n.target.value)}}}):t._e(),"button"==e.cell.displayClass[e.cell.status].displayType?n("button",{style:[e.cell.style],on:{click:function(t){e.cell.onClick(t)}}},[t._v(t._s(e.cell.content))]):t._e(),"select"==e.cell.displayClass[e.cell.status].displayType?n("select",{directives:[{name:"model",rawName:"v-model",value:e.cell.value,expression:"th.cell.value"}],style:[e.cell.style],attrs:{tabindex:"1"},on:{change:[function(n){var i=Array.prototype.filter.call(n.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(e.cell,"value",n.target.multiple?i:i[0])},function(t){e.cell.onChange(t)}],blur:function(t){e.cell.onBlur(t)}}},t._l(e.cell.select.optionList,function(e){return n("option",{key:e.value,domProps:{value:e.text}},[t._v(t._s(e.text))])})):t._e()],2)}),t._l(t.myTable.$tableBody[i-t.myTable.$tableHeadTop.length],function(e,i){return n("td",{key:1+i,style:[e.style],attrs:{tabindex:"1"},on:{click:function(t){e.onClick(t)},mousedown:function(t){e.onMouseDown(t)},blur:function(t){e.onBlur(t)},paste:function(t){e.onPaste(t)}}},["text"==e.cell.displayClass[e.cell.status].displayType?n("div",{style:[e.cell.style],on:{dblclick:function(t){e.cell.onDbClick(t)}}},[t._v(t._s(e.cell.content)+"\n            ")]):t._e(),"input"==e.cell.displayClass[e.cell.status].displayType?n("input",{directives:[{name:"model",rawName:"v-model",value:e.cell.value,expression:"td.cell.value"}],style:[e.cell.style],attrs:{type:"text"},domProps:{value:e.cell.value},on:{input:[function(n){n.target.composing||t.$set(e.cell,"value",n.target.value)},function(t){e.cell.onInput(t)}],mouseup:function(t){e.cell.onMouseUp(t)},mouseover:function(t){e.cell.onMouseOver(t)},focus:function(t){e.cell.onFocus(t)},blur:function(t){e.cell.inputOnBlur(t,!0)},keydown:function(t){e.cell.onKeyDown(t)}}}):t._e(),e.cell&&"select"==e.cell.displayClass[e.cell.status].displayType?n("select",{directives:[{name:"model",rawName:"v-model",value:e.cell.value,expression:"td.cell.value"}],style:[e.cell.style],attrs:{tabindex:"1"},on:{blur:function(t){e.cell.onBlur(t)},mouseover:function(t){e.cell.onMouseOver(t)},change:[function(n){var i=Array.prototype.filter.call(n.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(e.cell,"value",n.target.multiple?i:i[0])},function(t){e.cell.onChange(t)}]}},t._l(e.cell.select.optionList,function(e){return n("option",{key:e.value,domProps:{value:e.text}},[t._v(t._s(e.text))])})):t._e()])})]],2)})],2):t._e(),t.myTable?n("SelectBox",{attrs:{inputTable:t.myTable,positionType:"main"}}):t._e()],1),t._m(0)],1):t._e()},o=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"rightMeu"}},[n("ul")])}],r=n("8bbf"),a=n.n(r);n("65d9");var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"fix-top-table",style:t.myTable.style.topTable,domProps:{scrollLeft:t.myTable.style.scrollLeft}},[t.myTable&&t.myTable.$rowNumber[0]&&t.myTable.$colNumber[0]?n("table",{staticClass:"my-table",attrs:{cellspacing:"0",cellpadding:"0",border:"0"}},[n("thead",[t.myTable.isShowColIndex?n("tr",[t.myTable.isShowRowIndex?n("th",{staticClass:"rowNumber",style:{padding:t.myTable.$rowNumber[0].style.padding,background:t.myTable.$rowNumber[0].style.background},attrs:{tabindex:"1"}},[n("div",{style:{width:t.myTable.$rowNumber[0].style.width,height:t.myTable.$colNumber[0].style.height,lineHeight:t.myTable.$colNumber[0].style.height}},[t._v("\n            "+t._s(t.myTable.isTopLeftShow?t.myTable.topLeftValue:"")+"\n          ")])]):t._e(),t._l(t.myTable.$colNumber,function(e,i){return n("th",{key:"col"+i,staticClass:"colNumber",style:e.style,attrs:{tabindex:"1"},on:{mousedown:function(t){e.onMouseDown(t)},mouseout:function(t){e.onMouseOut(t)},mousemove:function(t){e.onMouseMove(t)},click:function(t){e.onClick(t)},dragover:function(t){e.dragOver(t)},dragleave:function(t){e.dragLeave(t)},dragenter:function(t){e.dragEnter(t)},drop:function(t){e.drop(t)}}},[n("div",{style:e.cell.style},[t._v(t._s(e.cell.content))])])})],2):t._e(),t._l(t.myTable.$tableHeadTop,function(e,i){return n("tr",{key:"tr"+i},[t.myTable.isShowRowIndex?n("th",{staticClass:"rowNumber",style:t.myTable.$rowNumber[i].style,attrs:{tabindex:"1"},on:{mousedown:function(e){t.myTable.$rowNumber[i].onMouseDown(e)},mousemove:function(e){t.myTable.$rowNumber[i].onMouseMove(e)},mouseout:function(e){t.myTable.$rowNumber[i].onMouseOut(e)},dragover:function(e){t.myTable.$rowNumber[i].dragOver(e)},dragleave:function(e){t.myTable.$rowNumber[i].dragLeave(e)},dragenter:function(e){t.myTable.$rowNumber[i].dragEnter(e)},drop:function(e){t.myTable.$rowNumber[i].drop(e)}}},[n("div",{style:t.myTable.$rowNumber[i].cell.style},[t._v(t._s(t.myTable.$rowNumber[i].cell.content))])]):t._e(),0===i&&t.myTable.$tableHeadLeft[0]&&t.myTable.$tableHeadTop[0]?n("th",{staticClass:"colNumber",style:t.myTable.tableHeadTopLeft.style,attrs:{tabindex:"1",colspan:t.myTable.theadLeftEntity.side2,rowspan:t.myTable.theadTopEntity.side2}},[n("div",{style:t.myTable.tableHeadTopLeft.cell.style})]):t._e(),t._l(e,function(e,i){return n("th",{key:e.id+i,staticClass:"top-th",style:e.style,attrs:{tabindex:"1",draggable:e.draggable,colspan:e.span1,rowspan:e.span2},on:{blur:function(t){e.onBlur(t)},click:function(t){e.onClick(t)},dragstart:function(t){e.dragStart(t)},dragend:function(t){e.dragEnd(t)},dragover:function(t){e.dragOver(t)},dragleave:function(t){e.dragLeave(t)},dragenter:function(t){e.dragEnter(t)},drop:function(t){e.drop(t)},mousedown:function(t){e.onMouseDown(t)},mousemove:function(t){e.onMouseMove(t)},mouseout:function(t){e.onMouseOut(t)}}},[e.treeContainer.show?n("svg",{style:e.treeContainer.style,attrs:{viewBox:"0 0 1024 1024"},on:{click:function(t){e.treeContainer.onClick(t)}}},t._l(e.treeContainer.svg[e.treeContainer.$openStatus].paths,function(t){return n("path",{attrs:{d:t}})})):t._e(),t._l(e.selfContainers,function(e){return e.show?n("svg",{style:e.style,attrs:{viewBox:"0 0 1024 1024"},on:{click:function(t){e.onClick(t)}}},t._l(e.svg[e.type].paths,function(t){return n("path",{attrs:{d:t}})})):t._e()}),"text"==e.cell.displayClass[e.cell.status].displayType?n("div",{style:[e.cell.style],attrs:{title:e.cell.title},on:{dblclick:function(t){e.cell.onDbClick()}}},[t._v("\n            "+t._s(e.cell.content)+"\n          ")]):t._e(),"input"==e.cell.displayClass[e.cell.status].displayType?n("input",{directives:[{name:"model",rawName:"v-model",value:e.cell.value,expression:"th.cell.value"}],style:[e.cell.style],domProps:{value:e.cell.value},on:{mouseover:function(t){e.cell.onMouseOver(t)},blur:function(t){e.cell.inputOnBlur(t,!0)},input:function(n){n.target.composing||t.$set(e.cell,"value",n.target.value)}}}):t._e(),"button"==e.cell.displayClass[e.cell.status].displayType?n("button",{style:[e.cell.style],on:{click:function(t){e.cell.onClick(t)}}},[t._v(t._s(e.cell.content))]):t._e()],2)})],2)})],2)]):t._e(),t.myTable?n("SelectBox",{attrs:{inputTable:t.myTable,positionType:"top"}}):t._e()],1)},l=[],c=a.a.component("TopFixTable",{props:{inputTable:Object},data:function(){return{myTable:this.inputTable}},watch:{inputTable:function(t,e){this.myTable=t||e}}}),h=c;function d(t,e,n,i,o,r,a,s){var l,c="function"===typeof t?t.options:t;if(e&&(c.render=e,c.staticRenderFns=n,c._compiled=!0),i&&(c.functional=!0),r&&(c._scopeId="data-v-"+r),a?(l=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"===typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),o&&o.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(a)},c._ssrRegister=l):o&&(l=s?function(){o.call(this,this.$root.$options.shadowRoot)}:o),l)if(c.functional){c._injectStyles=l;var h=c.render;c.render=function(t,e){return l.call(e),h(t,e)}}else{var d=c.beforeCreate;c.beforeCreate=d?[].concat(d,l):[l]}return{exports:t,options:c}}var u=d(h,s,l,!1,null,null,null);u.options.__file="TopFixTable.vue";var p=u.exports,f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"fix-top-left-table"},[t.myTable&&t.myTable.$rowNumber[0]&&t.myTable.$colNumber[0]?n("table",{staticClass:"my-table left-top-table",attrs:{cellspacing:"0",cellpadding:"0",border:"0"}},[n("thead",[t.myTable.isShowColIndex&&t.myTable.isShowRowIndex?n("tr",[n("th",{staticClass:"rowNumber",style:{padding:t.myTable.$rowNumber[0].style.padding,background:t.myTable.$rowNumber[0].style.background},attrs:{tabindex:"1"}},[n("div",{style:{width:t.myTable.$rowNumber[0].style.width,height:t.myTable.$colNumber[0].style.height,lineHeight:t.myTable.$colNumber[0].style.height}},[t._v("\n            "+t._s(t.myTable.isTopLeftShow?t.myTable.topLeftValue:"")+"\n          ")])]),t._l(t.myTable.theadLeftEntity.$leafIndexList2,function(e,i){return n("th",{staticClass:"colNumber",style:t.myTable.$colNumber[i].style,attrs:{tabindex:"1"},on:{mousedown:function(e){t.myTable.$colNumber[i].onMouseDown(e)},mouseout:function(e){t.myTable.$colNumber[i].onMouseOut(e)},mousemove:function(e){t.myTable.$colNumber[i].onMouseMove(e)},click:function(e){t.myTable.$colNumber[i].onClick(e)},dragenter:function(e){t.myTable.$colNumber[i].dragEnter(e)},dragleave:function(e){t.myTable.$colNumber[i].dragLeave(e)},dragover:function(e){t.myTable.$colNumber[i].dragOver(e)},drop:function(e){t.myTable.$colNumber[i].drop(e)}}},[n("div",{style:t.myTable.$colNumber[i].cell.style},[t._v("\n            "+t._s(t.myTable.$colNumber[i].cell.content)+"\n          ")])])})],2):t._e(),t._l(t.myTable.$tableHeadTop,function(e,i){return t.myTable.isShowRowIndex?n("tr",{key:e+i},[n("th",{staticClass:"rowNumber",style:t.myTable.$rowNumber[i].style,attrs:{tabindex:"1"},on:{click:function(e){t.myTable.$rowNumber[i].onClick(e)},dragenter:function(e){t.myTable.$rowNumber[i].dragEnter(e)},dragleave:function(e){t.myTable.$rowNumber[i].dragLeave(e)},dragover:function(e){t.myTable.$rowNumber[i].dragOver(e)},drop:function(e){t.myTable.$rowNumber[i].drop(e)},mousedown:function(e){t.myTable.$rowNumber[i].onMouseDown(e)},mouseout:function(e){t.myTable.$rowNumber[i].onMouseOut(e)},mousemove:function(e){t.myTable.$rowNumber[i].onMouseMove(e)}}},[n("div",{style:[t.myTable.$rowNumber[i].cell.style],attrs:{title:t.myTable.$rowNumber[i].cell.content}},[t._v("\n            "+t._s(t.myTable.$rowNumber[i].cell.content)+"\n          ")])]),0===i&&t.myTable.$tableHeadLeft[0]&&t.myTable.$tableHeadTop[0]?n("th",{staticClass:"colNumber",staticStyle:{"border-width":"1px"},style:t.myTable.tableHeadTopLeft.style,attrs:{tabindex:"1",colspan:t.myTable.theadLeftEntity.side2,rowspan:t.myTable.theadTopEntity.side2}},[n("div",{style:t.myTable.tableHeadTopLeft.cell.style})]):t._e()]):t._e()})],2)]):t._e(),t.myTable?n("SelectBox",{attrs:{inputTable:t.myTable,positionType:"top-left"}}):t._e()],1)},y=[],b=a.a.component("TopLeftFixTable",{props:{inputTable:Object},data:function(){return{myTable:this.inputTable}},watch:{inputTable:function(t,e){this.myTable=t||e}}}),v=b,g=d(v,f,y,!1,null,null,null);g.options.__file="TopLeftFixTable.vue";var m=g.exports,C=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"fix-left-table",style:t.myTable.style.leftTable,domProps:{scrollTop:t.myTable.style.scrollTop}},[t.myTable&&t.myTable.$rowNumber[0]&&t.myTable.$colNumber[0]?n("table",{staticClass:"my-table left-table"},[n("thead",[t.myTable.isShowColIndex?n("tr",[n("th",{staticClass:"rowNumber",style:{padding:(t.myTable.$rowNumber[0]||t.myTable.$colNumber[0]||{}).style.padding,background:(t.myTable.$rowNumber[0]||t.myTable.$colNumber[0]||{}).style.background},attrs:{tabindex:"1"}},[n("div",{style:{width:t.myTable.$rowNumber[0].style.width,height:t.myTable.$colNumber[0].style.height,lineHeight:t.myTable.$colNumber[0].style.height}},[t._v("\n            "+t._s(t.myTable.isTopLeftShow?t.myTable.topLeftValue:"")+"\n          ")])]),t._l(t.myTable.theadLeftEntity.$leafIndexList2,function(e,i){return n("th",{staticClass:"colNumber",style:t.myTable.$colNumber[i].style},[n("div",{style:t.myTable.$colNumber[i].cell.style},[t._v("\n            "+t._s(t.myTable.$colNumber[i].cell.content)+"\n          ")])])})],2):t._e(),t._l(t.myTable.$rowNumber,function(e,i){return n("tr",{key:"row"+i},[t.myTable.isShowRowIndex?n("th",{staticClass:"rowNumber",style:e.style,attrs:{tabindex:"1"},on:{mousedown:function(t){e.onMouseDown(t)},mouseout:function(t){e.onMouseOut(t)},mousemove:function(t){e.onMouseMove(t)},click:function(t){e.onClick(t)},dragstart:function(t){e.dragStart(t)},dragend:function(t){e.dragEnd(t)},dragover:function(t){e.dragOver(t)},dragleave:function(t){e.dragLeave(t)},dragenter:function(t){e.dragEnter(t)},drop:function(t){e.drop(t)}}},[n("div",{style:[e.cell.style],attrs:{title:e.cell.content}},[t._v(t._s(e.cell.content))])]):t._e(),0===i&&t.myTable.$tableHeadLeft[0]&&t.myTable.$tableHeadTop[0]?n("th",{staticClass:"colNumber",style:t.myTable.tableHeadTopLeft.style,attrs:{tabindex:"1",colspan:t.myTable.theadLeftEntity.side2,rowspan:t.myTable.theadTopEntity.side2},on:{click:function(e){t.myTable.onClick(e)}}},[n("div",{style:t.myTable.tableHeadTopLeft.cell.style})]):t._e(),t._l(t.myTable.$tableHeadLeft[i-t.myTable.theadTopEntity.side2],function(e,i){return n("th",{key:e+i,style:[e.style],attrs:{tabindex:"1",draggable:e.draggable,colspan:e.span2,rowspan:e.span1},on:{click:function(t){e.onClick(t)},blur:function(t){e.onBlur(t)},dragstart:function(t){e.dragStart(t)},dragover:function(t){e.dragOver(t)},drop:function(t){e.drop(t)},dragleave:function(t){e.dragLeave(t)},mousedown:function(t){e.onMouseDown(t)},mousemove:function(t){e.onMouseMove(t)},mouseout:function(t){e.onMouseOut(t)}}},[e.treeContainer.show?n("svg",{style:e.treeContainer.style,attrs:{viewBox:"0 0 1024 1024"},on:{click:function(t){e.treeContainer.onClick(t)}}},t._l(e.treeContainer.svg[e.treeContainer.$openStatus].paths,function(t){return n("path",{attrs:{d:t}})})):t._e(),t._l(e.selfContainers,function(e){return e.show?n("svg",{style:e.style,attrs:{viewBox:"0 0 1024 1024"},on:{click:function(t){e.onClick(t)}}},t._l(e.svg[e.type].paths,function(t){return n("path",{attrs:{d:t}})})):t._e()}),"text"==e.cell.displayClass[e.cell.status].displayType?n("div",{style:[e.cell.style],attrs:{title:e.cell.title},on:{dblclick:function(t){e.cell.onDbClick()}}},[t._v("\n\n            "+t._s(e.cell.content)+"\n          ")]):t._e(),"input"==e.cell.displayClass[e.cell.status].displayType?n("input",{directives:[{name:"model",rawName:"v-model",value:e.cell.value,expression:"th.cell.value"}],staticStyle:{"background-color":"#fff"},style:[e.cell.style],domProps:{value:e.cell.value},on:{mouseover:function(t){e.cell.onMouseOver(t)},blur:function(t){e.cell.inputOnBlur(t,!0)},input:function(n){n.target.composing||t.$set(e.cell,"value",n.target.value)}}}):t._e(),"button"==e.cell.displayClass[e.cell.status].displayType?n("button",{style:[e.cell.style],on:{click:function(t){e.cell.onClick(t)}}},[t._v(t._s(e.cell.content))]):t._e(),"select"==e.cell.displayClass[e.cell.status].displayType?n("select",{directives:[{name:"model",rawName:"v-model",value:e.cell.value,expression:"th.cell.value"}],style:[e.cell.style],attrs:{tabindex:"1"},on:{change:[function(n){var i=Array.prototype.filter.call(n.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(e.cell,"value",n.target.multiple?i:i[0])},function(t){e.cell.onChange(t)}],blur:function(t){e.cell.onBlur(t)}}},t._l(e.cell.select.optionList,function(e){return n("option",{key:e.value,domProps:{value:e.text}},[t._v(t._s(e.text))])})):t._e()],2)})],2)})],2)]):t._e(),t.myTable?n("SelectBox",{attrs:{inputTable:t.myTable,positionType:"left"}}):t._e()],1)},T=[],$=a.a.component("LeftFixTable",{props:{inputTable:Object},data:function(){return{myTable:this.inputTable}},watch:{inputTable:function(t,e){this.myTable=t||e}}}),w=$,x=d(w,C,T,!1,null,null,null);x.options.__file="LeftFixTable.vue";var N=x.exports,S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{position:"absolute",display:"contents"}},t._l(t.myTable.$selectBoxEntity.selectList,function(e,i){return e.position.table===t.myTable.position.table&&e.selectBoxType===t.positionType?n("div",{key:i,style:{position:"absolute",top:e.style.top+"px",left:e.style.left+"px"}},[n("span",[n("div",{style:e.topStyle}),n("div",{style:e.rightStyle}),n("div",{style:e.bottomStyle}),n("div",{style:e.leftStyle})])]):t._e()}))},P=[],E=a.a.component("SelectBox",{props:{inputTable:Object,positionType:String},data:function(){return{myTable:this.inputTable}},watch:{inputTable:function(t,e){this.myTable=t||e}}}),_=E,L=d(_,S,P,!1,null,null,null);L.options.__file="SelectBox.vue";var I=L.exports,M=function(t,e){return M=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},M(t,e)};
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function D(t,e){function n(){this.constructor=t}M(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function k(t,e,n,i){var o;if(t instanceof Array)return o=[],t.forEach(function(t,i){o[i]=k(t,e,n)}),o;if("function"===typeof t)return t;if(t instanceof Object){for(var r in o={},t)if(t.hasOwnProperty(r)||"function"===typeof t[r]&&i){var a=!!e&&!!e.test(r),s=!!n&&!!n.test(r);if(a)continue;o[r]=s?t[r]:k(t[r],e,n,i)}return o}return t}var O=function(){function t(){}return t.keepReg=/\$|userData/,t}();function j(t,e,n,i){return n=n||O.keepReg,k(t,e,n,i)}function B(t,e,n,i){var o=Object.create({}),r=function(r){if(t.hasOwnProperty(r)||i&&"function"===typeof t[r]){"_value"===r&&Object.defineProperty(o,"value",{get:function(){return this._value},set:function(t){this.$renderState.hasrendered=!1,this._value=t}});var a=t[r],s=null,l=!!e&&!!e.test(r),c=!!n&&!!n.test(r);if(l)return"continue";c?s=t[r]:Array.isArray(a)?(s=[],a.forEach(function(t){"function"===typeof t.clone?s.push(t.clone(e,n,i)):s.push(j(t,e,n,i))})):s="object"===typeof t[r]?a&&"function"===typeof a.clone?a.clone(e,n,i):j(a,e,n,i):t[r],o[r]=s}};for(var a in t)r(a);return o}function R(t,e,n){var i=-1,o=t.length;e=null==e?0:+e||0,e<0&&(e=-e>o?0:o+e),n=void 0===n||n>o?o:+n||0,n<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;var r=Array(o);while(++i<o)r[i]=t[i+e];return r}function A(t,e){var n=null==t?0:t.length;return n?(e=void 0===e?1:e,R(t,e<0?0:e,n)):[]}function z(t,e){var n=null==t?0:t.length;return n?(e=void 0===e?1:e,e=n-e,R(t,0,e<0?0:e)):[]}function H(t){var e=t?t.length:0;return e?t[e-1]:void 0}function F(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function q(){return F()+F()+"-"+F()+"-"+F()+"-"+F()+"-"+F()+F()+F()}function V(t,e,n,i){var o=k(e,void 0,i);if(n=n||"intersection",t&&o)for(var r in o)if(t.hasOwnProperty(r)||"union"===n&&o.hasOwnProperty(r)){var a=t[r],s=!!i&&!!i.test(r);"object"!==typeof a||Array.isArray(a)||s?void 0!==o[r]&&(t[r]=o[r]):V(t[r],o[r],n)}return t}function W(t,e,n){var i=new RegExp(e,"g"),o=t.replace(i,n);return o}function X(t){var e=Math.floor(t/26),n=t%26,i="";return e>0&&(i+=String.fromCharCode(e+65-1)),i+=String.fromCharCode(n+65),i}var Y=function(){function t(){}return t.complexEval=function(t){if(null==t)return"";"string"!==typeof t&&(t+=""),t=(t+"").replace(/[\s]/g,"");var e="[(][^(]*?[)]",n=t.match(e);while(null!=n){var i=n[0]+"",o=this.simpleEval(i.substr(1,i.length-2));t=t.replace(n[0],o),n=t.match(e)}return this.simpleEval(t)},t.simpleEval=function(t){if(null==t)return"";"string"!==typeof t&&(t+="");for(var e=new Array,n=new Array,i=0,o=t.split(""),r=!1,a=0;a<o.length;a++)if("+"===o[a]||"-"===o[a]||"*"===o[a]||"/"===o[a]){var s=1*i;if(r){var l=e.pop(),c=n.pop();s=this.simpleTwoEval(c,l,s)}e.push(s),n.push(o[a]),i=0,r=!1,"*"!==o[a]&&"/"!==o[a]||(r=!0)}else if(i+=o[a]+"",a===o.length-1){s=1*i;if(r){var h=e.pop(),d=(c=n.pop(),this.simpleTwoEval(c,h,i));s=d}e.push(s)}e=this.reverseArray(e),n=this.reverseArray(n);while(e.length>1){var u=e.pop(),p=e.pop();c=n.pop();e.push(this.simpleTwoEval(c,u,p))}return e[0]||0},t.simpleTwoEval=function(t,e,n){var i=0;return"+"===t?i=e+n:"-"===t?i=e-n:"*"===t?i=e*n:"/"===t&&(i=e/n),i=parseFloat(i.toFixed(10)),i},t.reverseArray=function(t){for(var e=new Array,n=t.length,i=0;i<n;i++)e.push(t.pop());return e},t.cellStr2Position=function(t){var e={table:(/^[\u4e00-\u9fa5_a-zA-Z0-9_]+(?=\!)/.exec(t)||[null])[0],colStr:(/[^!]?([A-Z])+/.exec(t)||[null])[0],rowStr:(/[0-9]+$/.exec(t)||[null])[0]};return e},t.curlyBracesHandle=function(e,n){var i="[{][^{]*?[}]",o=e.match(i);while(null!=o)(o||[]).forEach(function(i){var o=n.position.rowNum+"";if(/sr/.test(i)){var r=i.replace(/sr/g,o);r=r.replace(/[{}]/g,"");var a=t.complexEval(r);e=e.replace(i,a+1)}else if(/sc/.test(i)){var s=n.position.colNum+"";r=i.replace(/sc/g,s);r=r.replace(/[{}]/g,"");a=t.complexEval(r);e=e.replace(i,X(a))}}),o=e.match(i);return e},t.percentHandle=function(t){var e=/(\d+(\.\d+)*)%/g,n=t.replace(e,function(t,e){return.01*Number(e)+""});return n},t}(),J=function(){function t(){this.style={},this.config={},this.userData={},this.position={table:0,colNum:0,rowNum:0}}return t}(),U=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.oldValue="",e.content="",e.selectionStart=0,e.title="",e.status="normal",e.displayType="text",e.style={fontSize:12,float:"left",color:"#000",textAlign:"center",width:"110px",height:"28px",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",boxSizing:"border-box",display:"block",userSelect:"none"},e.displayClass={normal:{displayType:"text"},dbclick:{displayType:"input",select:{optionList:[]}},readonly:{displayType:"text"}},e.formatter="",e.verification={state:!0,hasVerification:!1,vTypes:[],message:{integer:"必须输入整型",notNull:"该项是必填项",number:"您好请输入数字类型:例如 123|32|3.5....",date:"您好请输入正确时间:例如 2019-01-01",decimal:"您好请输入正确数字"}},e}return D(e,t),e}(J),K=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.widthNum=0,e.heightNum=0,e.widthChildNum=0,e.heightChildNum=0,e.widthSelfNum=110,e.heightSelfNum=38,e.paddingLeftNum=0,e.children=new Array,e.isRootParent=!1,e.$inSystem=!1,e.cell=new U,e.hideType="visible",e.$positionCheck=["top","bottom","left","right","inner"],e.side1=1,e.side2=1,e.span1=1,e.span2=1,e.style={padding:"0px 0px",overflow:"hidden",userSelect:"text",boxSizing:"border-box",position:"relative"},e}return D(e,t),e}(J),Z=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.span1=1,e.span2=1,e.canSum=!1,e.canDragResize=!1,e.draggable=!0,e.$resizeChildren=[],e.selfContainers=[],e.theadPosition=new Array,e.tbodyConfig={},e.children=[],e.style=V(e.style,{overflow:"hidden",boxSizing:"border-box",whiteSpace:"nowrap",textOverflow:"ellipsis",background:"#f5f7fa"},"union"),e}return D(e,t),e}(K),G=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.widthSelfNum=15,e.heighSelftNum=38,e.allChildren=new Array,e.$positionCheck=null,e.style={cursor:"pointer",float:"left",left:"0px",boxSizing:"content-box",position:"absolute"},e.$openStatus="close",e.svg={close:{paths:["M815.2 911.7H210.8c-55.4 0-100.7-45.3-100.7-100.7V206.5c0-55.4 45.3-100.7 100.7-100.7h604.5c55.4 0 100.7 45.3 100.7 100.7V811c0 55.3-45.3 100.7-100.8 100.7zM210.8 156.1c-30.2 0-50.4 20.1-50.4 50.4V811c0 30.2 20.1 50.4 50.4 50.4h604.5c30.2 0 50.4-20.1 50.4-50.4V206.5c0-30.2-20.1-50.4-50.4-50.4H210.8z m0 0","M714.5 533.9h-403c-15.1 0-25.2-10.1-25.2-25.2s10.1-25.2 25.2-25.2h403c15.1 0 25.2 10.1 25.2 25.2s-10.1 25.2-25.2 25.2z m0 0","M513 735.4c-15.1 0-25.2-10.1-25.2-25.2v-403c0-15.1 10.1-25.2 25.2-25.2s25.2 10.1 25.2 25.2v403c0 15.1-10.1 25.2-25.2 25.2z m0 0"]},open:{paths:["M815.2 911.7H210.8c-55.4 0-100.7-45.3-100.7-100.7V206.5c0-55.4 45.3-100.7 100.7-100.7h604.5c55.4 0 100.7 45.3 100.7 100.7V811c0 55.3-45.3 100.7-100.8 100.7zM210.8 156.1c-30.2 0-50.4 20.1-50.4 50.4V811c0 30.2 20.1 50.4 50.4 50.4h604.5c30.2 0 50.4-20.1 50.4-50.4V206.5c0-30.2-20.1-50.4-50.4-50.4H210.8z m0 0","M714.5 533.9h-403c-15.1 0-25.2-10.1-25.2-25.2s10.1-25.2 25.2-25.2h403c15.1 0 25.2 10.1 25.2 25.2s-10.1 25.2-25.2 25.2z m0 0"]},loading:{paths:["M693.333333 650.325333q17.322667 0 29.994667 12.672l120.661333 120.661333q12.672 12.672 12.672 30.336 0 17.322667-12.672 29.994667t-29.994667 12.672q-17.664 0-30.336-12.672l-120.661333-120.661333q-12.330667-12.330667-12.330667-30.336 0-17.664 12.501333-30.165333t30.165333-12.501333zM331.008 650.325333q17.664 0 30.165333 12.501333t12.501333 30.165333-12.672 30.336l-120.661333 120.661333q-12.672 12.672-29.994667 12.672-17.664 0-30.165333-12.501333t-12.501333-30.165333q0-18.005333 12.330667-30.336l120.661333-120.661333q12.672-12.672 30.336-12.672zM85.333333 469.333333l170.666667 0q17.664 0 30.165333 12.501333t12.501333 30.165333-12.501333 30.165333-30.165333 12.501333l-170.666667 0q-17.664 0-30.165333-12.501333t-12.501333-30.165333 12.501333-30.165333 30.165333-12.501333zM512 725.333333q17.664 0 30.165333 12.501333t12.501333 30.165333l0 170.666667q0 17.664-12.501333 30.165333t-30.165333 12.501333-30.165333-12.501333-12.501333-30.165333l0-170.666667q0-17.664 12.501333-30.165333t30.165333-12.501333zM210.346667 167.338667q17.322667 0 29.994667 12.672l120.661333 120.661333q12.672 12.672 12.672 29.994667 0 17.664-12.501333 30.165333t-30.165333 12.501333q-18.005333 0-30.336-12.330667l-120.661333-120.661333q-12.330667-12.330667-12.330667-30.336 0-17.664 12.501333-30.165333t30.165333-12.501333zM768 469.333333l170.666667 0q17.664 0 30.165333 12.501333t12.501333 30.165333-12.501333 30.165333-30.165333 12.501333l-170.666667 0q-17.664 0-30.165333-12.501333t-12.501333-30.165333 12.501333-30.165333 30.165333-12.501333zM512 42.666667q17.664 0 30.165333 12.501333t12.501333 30.165333l0 170.666667q0 17.664-12.501333 30.165333t-30.165333 12.501333-30.165333-12.501333-12.501333-30.165333l0-170.666667q0-17.664 12.501333-30.165333t30.165333-12.501333zM813.994667 167.338667q17.322667 0 29.994667 12.672t12.672 29.994667q0 17.664-12.672 30.336l-120.661333 120.661333q-12.330667 12.330667-29.994667 12.330667-18.346667 0-30.506667-12.16t-12.16-30.506667q0-17.664 12.330667-29.994667l120.661333-120.661333q12.672-12.672 30.336-12.672z"]}},e}return D(e,t),e}(K),Q=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.$positionCheck=new Array,e.canSum=!0,e.style=V(e.style,{background:"#fff"},"union"),e}return D(e,t),e}(Z),tt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.draggable=!0,e.readonly=!1,e.$leafIndexList=new Array,e.$leafIndexList2=new Array,e.side1=0,e.side2=0,e.span1=0,e.span2=0,e.isRootParent=!0,e.style=V(e.style,{background:"#f5f7fa",cursor:"pointer"},"union"),e}return D(e,t),e}(Z),et=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.$leafIndexList=new Array,e.$leafIndexList2=new Array,e.side1=0,e.side2=0,e.span1=0,e.span2=0,e.isRootParent=!0,e.style=V(e.style,{overflow:"hidden",boxSizing:"border-box",whiteSpace:"nowrap",textOverflow:"ellipsis",userSelect:"none",background:"#fff",zIndex:99},"union"),e}return D(e,t),e}(Q),nt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="table",e.isTopLeftShow=!1,e.tableName="",e.debugLevel=0,e.isShowColIndex=!0,e.isShowRowIndex=!0,e.isOverflowX=!1,e.isOverflowY=!1,e.canDragResize=!1,e.hasTopFixedTable=!0,e.hasLeftFixedTable=!0,e.maxWidth="100%",e.maxHeight="400px",e.scrollBarWidth="17px",e.scrollBarHeight="17px",e.defaultExpandedIds=[],e.style={scrollTop:0,scrollLeft:0,mainTable:{},topTable:{},leftTable:{}},e}return D(e,t),e}(J),it=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.topIndexList=new Array,e.leftIndexList=new Array,e.bodyData={},e.style=V(e.style,{background:"#fff"},"union"),e}return D(e,t),e}(K),ot=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.separator="_",e.style=V(e.style,{background:"#fff"},"union"),e}return D(e,t),e}(K),rt=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.show=!1,e.type="tips",e.widthSelfNum=15,e.rightNum=5,e.style={float:"right",right:"0px",width:"15px",boxSizing:"content-box",position:"absolute"},e.svg={tips:{paths:["M997.64736 819.1488l0-0.13824L577.84832 91.89888l-0.07168 0c-5.25312-19.3536-29.25056-33.87392-58.07104-33.87392-29.0304 0-52.94592 14.86848-57.99424 34.432L32.0256 836.608l0.35328 0.49152c-9.82016 9.74848-7.92576 32.89088 5.39648 54.49216 13.39904 22.02624 33.59232 34.29888 46.63808 29.24544l0.49152 0.768 869.75488 0 0.49152-1.11616c14.52032 2.24256 32.39936-10.52672 43.55072-33.24928C1011.74272 861.08672 1010.90304 831.63136 997.64736 819.1488L997.64736 819.1488zM458.83904 320.52224c0-32.18944 26.15808-58.27584 58.27584-58.27584 32.26112 0 58.28096 26.0864 58.28096 58.27584l0 300.36992c0 32.11264-26.01984 58.27584-58.28096 58.27584-32.11776 0-58.27584-26.15808-58.27584-58.27584L458.83904 320.52224 458.83904 320.52224zM517.12 844.81536c-34.9952 0-63.39584-28.40576-63.39584-63.46752 0-35.00032 28.40064-63.26272 63.39584-63.26272 34.9952 0 63.39072 28.26752 63.39072 63.26272C580.51072 816.33792 552.1152 844.81536 517.12 844.81536L517.12 844.81536z"]}},e}return D(e,t),e}(J),at=function(){function t(){this.BaseCellConfig=new U,this.BaseContainerConfig=new J,this.CellContainerConfig=new K,this.TheadContainerConfig=new Z,this.TbodyContainerConfig=new ot,this.TreeContainerConfig=new G,this.SelfContainerConfig=new rt,this.IndexContainerConfig=new Q,this.BaseTheadConfig=new tt,this.IndexTheadConfig=new et,this.BaseTbodyConfig=new it,this.BaseTableConfig=new nt,this.baseCell={},this.baseContainer={},this.cellContainer={},this.topThead={},this.leftThead={},this.topIndexThead={},this.leftIndexThead={},this.theadContainer={},this.topIndexContainer={},this.leftIndexContainer={style:{width:"80px"}},this.treeContainer={},this.selfContainer={},this.tbodyContainer={},this.baseTbody={},this.table={}}return t.getInstance=function(e){var n;return n=this.instances.hasOwnProperty(e)?this.instances[e]:this.instances[e]=new t,n},t.instances={},t}(),st=function(){function t(t){this.nullReplace="",this.userData={},this.formula={hasFormula:!1,tmpValue:"",canClickAdd:!0},this.style={},this.select={selectOption:null,optionList:[]},this.config={},this.$warningMessage=[],this.$renderState={inRender:!1,hasrendered:!1},this.$ICObject={};var e=j(t);this.initBeforeSetData(e),V(this,this.config,"union"),this.setCellData(e)}return Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){this.$renderState.hasrendered=!1,this._value=t},enumerable:!0,configurable:!0}),t.prototype.initBeforeSetData=function(t){this.value=t.value||"",this.$groupId=t.$groupId,this.$parent=t.$parent,this.$dragTableConfig=at.getInstance(this.$groupId),V(this.config,this.$dragTableConfig.BaseCellConfig,"union"),V(t,this.$dragTableConfig.baseCell,"union")},t.prototype.setConfig=function(t){var e=k(t);try{e&&(V(this.config,e,"union"),V(this.style,e.style,"union"),V(this,this.config))}catch(t){console.error(t)}},t.prototype.doVerify=function(){var t=this;this.$warningMessage=[];var e=!0;this.verification.state=!0;var n=this.content+"",i=/(^\d+(\.\d+)*)%$/;return n=n.replace(i,function(t,e){return.01*Number(e)}),this.verification.hasVerification&&this.verification.vTypes.forEach(function(i){if(e=!0,"number"===i&&n)e=!isNaN(n);else if("date"===i&&n){var o=/((?!0000)[0-9]{4}-((0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-8])|(0[13-9]|1[0-2])-(29|30)|(0[13578]|1[02])-31)|([0-9]{2}(0[48]|[2468][048]|[13579][26])|(0[48]|[2468][048]|[13579][26])00)-02-29)/;e=o.test(n)}else if("integer"===i&&n){o=/^[+]{0,1}(\d+)$/;e=e&&o.test(n)}else if(/decimal/.test(i)&&n){var r=i.match(/%[0-9]+/),a=0;null!==r&&(a=Number(r[0].replace("%","")));o=void 0;o=0===a?/^\d+(\.\d+)*$/:new RegExp("^\\d+(\\.\\d{1,"+a+"})?$"),e=e&&o.test(n);for(var s="",l=0;l<a;l++)s+="1";t.verification.message[i]=t.verification.message[i]||"您好请输入最多"+a+"位小数:例如 3."+s}else"notNull"===i&&(e=""!==n&&void 0!==n&&null!==n);e||t.$warningMessage.push(i),t.verification.state=t.verification.state&&e}),e},t.prototype.format=function(){var t=this.formatter,e=this.content+"",n=!0,i=/(^\d+(\.\d+)*)%$/;if(e=e.replace(i,function(e,n){return/percent/.test(t)?n:.01*Number(n)}),this.formatter&&!isNaN(e)&&e&&this.verification.state)if("date"===t){var o=/((?!0000)[0-9]{4}-((0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-8])|(0[13-9]|1[0-2])-(29|30)|(0[13578]|1[02])-31)|([0-9]{2}(0[48]|[2468][048]|[13579][26])|(0[48]|[2468][048]|[13579][26])00)-02-29)/;this.content=o.test(e)?e:"1990-01-01"}else if("integer"===t){o=/^[+]{0,1}(\d+)$/;this.content=o.test(e)?e:Math.round(e)}else if(/decimal|percent/.test(t)){var r=t.match(/%[0-9]+/),a=0;if(null!==r){var s=Number(r[0].replace("%",""));a=s}o=void 0;o=0===a?/^\d+(\.\d+)*$/:new RegExp("^\\d+\\.\\d{"+a+"}$"),n=o.test(e);var l=e;if(!n){var c=e.indexOf("."),h=0;if(-1!==c){var d=e.split(".")[1].length;h=a-d}else l+=0===a?"":".",h=a;h>0?l+=new Array(h).fill(0).join(""):l=Math.round(e*Math.pow(10,a))/(1*Math.pow(10,a))}this.content=/percent/.test(t)?l+"%":l}},t.prototype.setCellData=function(t){var e=this;for(var n in t)if(this.hasOwnProperty(n)||"value"===n){var i=t[n];if(-1!==n.indexOf("$")||void 0===i)continue;"displayClass"===n?(V(this.displayClass,i,"union"),V(this,this.displayClass[this.status])):"object"!==typeof i||Array.isArray(i)?this.setProperty(n,i):V(e[n],i,"union")}},t.prototype.setProperty=function(t,e){void 0!==e&&(this[t]=e,this.$renderState.hasrendered=!1)},t.prototype.clone=function(t,e,n){return B(this,t,e,n)},t.prototype.onFocus=function(t){this.checkHasFormula();this.checkLastCharStatus(t)},t.prototype.onMouseOver=function(t){switch(this.displayType){case"input":t.srcElement.focus();break}},t.prototype.onClick=function(t){t.stopPropagation();this.displayClass[this.status].displayType},t.prototype.onMouseUp=function(t){this.checkLastCharStatus(t)},t.prototype.inputOnBlur=function(t,e){var n=this;this.status="normal",this.onBlur(t);var i=this.$parent;if(this.render(),this.verification.state||this.$warningMessage.forEach(function(t){n.warning(n.verification.message[t])}),i){if(e){var o=i.getContainer(i.position);o.setCell(this),o.cell.render(),i.$positionManager.canFocus=!0,i.$positionManager.$editContainer=null}i.rootParentSendMsg({ev_type:"blur",render:!0,event:t,data:{objectName:"Cell",object:this}})}},t.prototype.onInput=function(t){this.checkLastCharStatus(t)},t.prototype.onDbClick=function(t){"readonly"!==this.status&&(this.status="dbclick",V(this,this.displayClass[this.status],"union"));var e=this.$parent;e&&e.rootParentSendMsg({ev_type:"dbclick",event:t,data:{objectName:"Cell",object:this}})},t.prototype.onBlur=function(t){"readonly"!==this.status&&(this.status="normal",this.oldValue=this._value,V(this,this.displayClass[this.status]))},t.prototype.warning=function(t){alert(t)},t.prototype.onKeyDown=function(t){"Enter"===t.key?t.target.blur():"Escape"===t.key&&(this._value=this.oldValue,t.target.blur())},t.prototype.onChange=function(t){switch("readonly"!==this.status&&(this.status="normal"),this.$renderState.hasrendered=!1,this.displayType){case"select":var e=t.target.selectedIndex;this.select.selectOption=this.select.optionList[e];break}var n=this.$parent;n&&n.rootParentSendMsg({ev_type:"change",render:!0,event:t,data:{objectName:"Cell",object:this}})},t.prototype.checkStatus=function(){var t=!1,e=this.$parent;if(void 0!==this.readonly)t=this.readonly;else if(e){var n=e.$rootParent;void 0!==e.readonly?t=e.readonly:n&&void 0!==n.readonly&&(t=n.readonly)}this.status=!0===t?"readonly":"normal"},t.prototype.render=function(){var t=this.$parent;if(t&&(this.style.width=t.widthSelfNum-2+"px",this.style.height=t.heightSelfNum-2+"px",this.style.lineHeight=t.style.height),!this.$renderState.hasrendered||this.formula.hasFormula){if(this.$renderState.inRender){this.content=0;var e=t.position;console.error("重复引用:table"+e.table+"!"+e.colStr+e.rowStr)}else{if(this.$renderState.inRender=!0,this.checkHasFormula(),t&&this.formula.hasFormula){var n=/([\u4e00-\u9fa5_a-zA-Z0-9_]+!)?[A-Z]+[0-9]+/g,i=this._value.replace(/^=/,""),o=this._value;i=Y.percentHandle(i),i=Y.curlyBracesHandle(i,t);var r={},a=i.match(n);(a||[]).forEach(function(e){var n=Y.cellStr2Position(e);n.table=n.table||t.position.table;var a,s=n.table+"!"+n.colStr+n.rowStr;if(r.hasOwnProperty(s))if(a=r[s],a){var l=(a.position.table===t.position.table?"":a.position.table+"!")+a.position.colStr+a.position.rowStr;r[s]=a,o=W(o,e,"back_"+s),-1!==o.search("back_"+s)&&(o=W(o,"back_"+s,l))}else console.error("cell:render() result为空");else a=t.getContainer(n),r[s]=a;a&&a.cell&&(a.cell.render(),i=i.replace(e,a.cell.content||0))}),this._value=o,this.$ICObject=r,i=Y.complexEval(i),this.content=i}else this.content=""===this._value||null===this._value||void 0===this._value?this.nullReplace:this._value;this.$renderState.inRender=!1}this.doVerify(),this.format(),this.checkStatus()}},t.prototype.checkLastCharStatus=function(t){this.selectionStart=t.target.selectionStart;var e=this.selectionStart-1,n=(this._value+"").substr(e,1),i=this.$parent;console.log("char:"+n),/^[\+\-\*\/\=]$/.test(n)?(this.formula.canClickAdd=!0,i.$positionManager.canFocus=!1,i.$positionManager.$editContainer=i,this.formula.tmpValue=this._value):(this.formula.canClickAdd=!1,i.$positionManager.canFocus=!0,i.$positionManager.$editContainer=null)},t.prototype.checkHasFormula=function(){if(this.$parent){var t=/^=/;if(t.test(this._value)){this.formula.hasFormula=!0;var e=/[A-Z]+[0-9]+$/g;e.test(this._value)?this.formula.canClickAdd=!0:this.formula.canClickAdd=!1,this.formula.canClickAdd=!0}else this.formula.hasFormula=!1}return this.formula.hasFormula},t}(),lt=function(){function t(t){this.positionMap={},this.treeContainerMap=new Map,this.hideContainerMap=new Map,this.$editContainer=null,this.canFocus=!0,this.type=t}return t.getInstance=function(e){var n=this.instances[e];return n||(this.instances[e]=n=new t(e)),n},t.prototype.clearPositionMapById=function(t){delete this.positionMap[t+"clone"],delete this.positionMap[t+"last"],delete this.positionMap[t+"source"]},t.prototype.getContainer=function(t,e){var n=null;try{if(t){e=e||"source";var i=k(t);i.table=i.table+e;var o=this.positionMap[i.table];if(o){var r=o[i.colStr];r&&(n=r[i.rowStr])}}}catch(t){console.error("getContainer发生错误"),console.log(t)}return n},t.prototype.getTopIndexContainer=function(t,e){e=e||"source";var n=k(t);return n.rowStr=0,this.getContainer(n,e)},t.prototype.getLeftIndexContainer=function(t,e){e=e||"source";var n=k(t);return n.colStr="@",this.getContainer(n,e)},t.prototype.getColObj=function(t,e){e=e||"source";var n=k(t);n.table=n.table+e;var i=null,o=this.positionMap[n.table];if(o){var r=o[n.colStr];i=r}return i},t.prototype.getRowObj=function(t,e){e=e||"source";var n=k(t);n.table=n.table+e;var i=null,o=this.positionMap[n.table];if(o)for(var r in i={},o)if(o.hasOwnProperty(r)){var a=o[r];i[r]=a[n.rowStr]}return i},t.prototype.setPositionMap=function(t,e,n){n=n||"source";var i=k(t);i.table=i.table+n,this.positionMap.hasOwnProperty(i.table)||(this.positionMap[i.table]={});var o=this.positionMap[i.table];o.hasOwnProperty(i.colStr)||(o[i.colStr]={});var r=o[i.colStr];r[i.rowStr]=e},t.prototype.saveLastPositionMap=function(t){var e=k(t),n=this.positionMap[e.table+"source"];for(var i in n)if(n.hasOwnProperty(i)){var o=n[i];for(var r in o)if(o.hasOwnProperty(r)){var a=o[r],s=k(e);s.colStr=i,s.rowStr=r,this.setPositionMap(s,a.clone(),"last")}}return this.positionMap[e.table+"last"]},t.instances={},t}(),ct=function(){function t(){this.callbackList=new Array}return t.prototype.subscribe=function(t,e){this.callbackList.push({fun:t,arg:e})},t.prototype.unsubscribe=function(t,e){var n=-1;this.callbackList.forEach(function(i,o){i==={fun:t,arg:e}&&(n=o)}),n>-1&&this.callbackList.splice(n,1)},t.prototype.sendMsg=function(t){return this.notify(t)},t.prototype.notify=function(t){var e=[];return this.callbackList.forEach(function(n){e.push(n.fun.call(n.arg,t)||!0)}),e},t}(),ht=function(){function t(t){this.$subject=new ct;var e=j(t);this.initBeforeSetData(e),V(this,this.config,"union"),this.setContainerData(e)}return t.prototype.initBeforeSetData=function(t){this.id=t.id||"def_"+q(),this.config={},this.$groupId=t.$groupId,this.$rootTable=t.$rootTable,this.$positionManager=lt.getInstance(this.$groupId),this.$dragTableConfig=at.getInstance(this.$groupId),this.config=k(this.$dragTableConfig.BaseContainerConfig),V(t,this.$dragTableConfig.baseContainer,"union"),this.type=t.type||"top"},t.prototype.setContainerData=function(t,e,n,i,o){var r=j(t),a=j(e),s=this;try{for(var l in this)if(this.hasOwnProperty(l)){var c=this.getDataByWeight(l,r,a,n,i);if(null===c||void 0===c){this.setProperty(l,c);continue}if(/(^\$)|cell|bodyData|Entity|treeContainer|tipContainer/.test(l));else{if("object"===typeof c&&!Array.isArray(c)){if(s[l]&&"function"===typeof s[l].setContainerData){s[l].setContainerData(c);continue}V(s[l],c,"union",/\$/);continue}if("children"===l){this.setChildren(c);continue}}o&&"function"===typeof o?o(l,c):this.setProperty(l,c)}}catch(t){console.error("setContainerData 中出现出错"),console.error(t)}},t.prototype.setChildren=function(t){var e=this;this.children=new Array,t.forEach(function(t){var n=e.createContain(t);e.addChild(n)})},t.prototype.createContain=function(t){},t.prototype.addChild=function(t,e){return e=void 0===e||null===e?this.children.length:e,this.children.splice(e,0,t),t.$parent=this,t.id},t.prototype.deletChild=function(t,e,n){var i=this,o=[];if(e=null==e?1:e,n)o=this.children.splice(t,e);else{for(var r=t+e,a=t;a<t+e;a++)this.children[a].children.forEach(function(t,e){i.addChild(t,r),r++});o=this.children.splice(t,e)}o.forEach(function(t){t.$inSystem=!1})},t.prototype.replaceChild=function(t,e,n){if(t.id||(t.id="def_"+q()),e>this.children.length-1)this.addChild(t,e);else if(t.position=this.children[e].position,n)this.children.splice(e,1,t);else{var i=[];this.children[e].children.forEach(function(t,e){i.push(t)}),this.children.splice(e,1,t),t.children=t.children.concat(i)}t.$parent=this},t.prototype.clone=function(t,e,n){e=e||O.keepReg;var i=Object.create({}),o=this,r=function(r){if(o.hasOwnProperty(r)||n&&"function"===typeof o[r]){var a=o[r],s=null,l=!!t&&!!t.test(r),c=!!e&&!!e.test(r);if(l)return"continue";c?s=o[r]:Array.isArray(a)?(s=[],a.forEach(function(i){"function"===typeof i.clone?s.push(i.clone(t,e,n)):s.push(j(i,t,e,n))})):s="object"===typeof o[r]?a&&"function"===typeof a.clone?a.clone(t,e,n):j(a,t,e,n):o[r],i[r]=s}};for(var a in o)r(a);return i},t.prototype.setConfig=function(t){var e=k(t);try{e&&V(this,e,"union")}catch(t){console.error(t)}},t.prototype.setProperty=function(t,e){void 0!==e&&(this[t]=e)},t.prototype.onClick=function(t){this.$rootTable&&this.$rootTable.subjectSend({ev_type:"click",event:t,data:{objectName:"BaseContainer",object:this}})},t.prototype.onMouseDown=function(t){return t.stopPropagation(),t&&t.preventDefault?t.preventDefault():window.event.returnValue=!1,!1},t.prototype.onBlur=function(t){},t.prototype.onScroll=function(t){this.style.scrollTop=t.srcElement.scrollTop,this.style.scrollLeft=t.srcElement.scrollLeft},t.prototype.subjectSend=function(t){return this.$subject.sendMsg(t)},t.prototype.getContainer=function(t,e){return this.$positionManager.getContainer(t,e)},t.prototype.getTopIndexContainer=function(t,e){return this.$positionManager.getTopIndexContainer(t,e)},t.prototype.getLeftIndexContainer=function(t,e){return this.$positionManager.getLeftIndexContainer(t,e)},t.prototype.getRowObj=function(t,e){return this.$positionManager.getRowObj(t,e)},t.prototype.getColObj=function(t,e){return this.$positionManager.getColObj(t,e)},t.prototype.saveLastPositionMap=function(t){return this.$positionManager.saveLastPositionMap(t)},t.prototype.getDataByWeight=function(t,e,n,i,o){var r,a=e?e[t]:void 0,s=n?n[t]:void 0,l=i?i[t]:void 0,c=o?o[t]:void 0;if(void 0!==a&&void 0!==s)if(l&&c)if(isNaN(l)||isNaN(c)){if(!isNaN(l)&&isNaN(l))r=a;else if(isNaN(l)&&!isNaN(l))r=s;else if("object"===typeof l&&"object"===typeof c){for(var h in r={},a)if(a.hasOwnProperty(h)&&!r.hasOwnProperty(h)){var d=this.getDataByWeight(h,a,s,l,c);r[h]=d}for(var h in s)if(s.hasOwnProperty(h)&&!r.hasOwnProperty(h)){d=this.getDataByWeight(h,a,s,l,c);r[h]=d}}}else r=l>c?a:s;else l&&!c?r=a:!l&&c?r=s:l||c||(r=a);else void 0===a&&void 0!==s?r=s:void 0!==a&&void 0===s&&(r=a);return r},t}(),dt=function(t){function e(e){return t.call(this,e)||this}return D(e,t),e.prototype.initBeforeSetData=function(e){t.prototype.initBeforeSetData.call(this,e),this.cell=new st({$parent:this}),this.$rootParent=e.$rootParent,this.paddingLeftNum=e.paddingLeftNum,this.config=k(this.$dragTableConfig.CellContainerConfig),V(e,this.$dragTableConfig.cellContainer,"union")},e.prototype.setContainerData=function(e,n,i,o,r){var a=this,s=function(t,e){/^cell$/.test(t)?a.setCell(e):r&&"function"===typeof r?r(t,e):a.setProperty(t,e)};t.prototype.setContainerData.call(this,e,n,i,o,s)},e.prototype.checkStatus=function(t){var e,n=this.$rootParent;return void 0!==this[t]?e=this[t]:n&&void 0!==n[t]&&(e=n[t]),e},e.prototype.setCell=function(t){this.cell&&"function"===typeof this.cell.setCellData?this.cell.setCellData(t):(t.$parent=this,this.cell=new st(t))},e.prototype.onClick=function(t){this.rootParentSendMsg({ev_type:"click",event:t,data:{objectName:"CellContainer",object:this}})},e.prototype.onMouseDown=function(e){var n={ev_type:"mouseDown",event:e,data:{objectName:"CellContainer",object:this}};3===e.which?(n.ev_type="rightClick",this.rootParentSendMsg(n)):2===e.which&&(n.ev_type="middleClick",this.rootParentSendMsg(n)),this.$positionManager.canFocus||this.$positionManager.$editContainer===this||t.prototype.onMouseDown.call(this,e)},e.prototype.setWidthOrHeight=function(t,e){for(var n,i=0;i<this.side1;i++){var o=k(this.position);if("width"===t?(o.colStr=X(o.colNum+i+1),n=this.getTopIndexContainer(this.position,"source")):"height"===t&&(o.rowStr=o.rowNum+i+1,n=this.getLeftIndexContainer(this.position,"source")),isNaN(e)||!n)return;e=Number(e),n.style[t]=e+"px",n[t+"SelfNum"]=n[t+"Num"]=e}this.$positionManager.saveLastPositionMap(this.position),this.rootParentSendMsg({ev_type:"beforeRender",render:!0,event:null,data:{objectName:"",object:null}})},e.prototype.delThisRow=function(t){this.$rootTable.delOneRowCol(t,this)},e.prototype.onPaste=function(t){var e;if(e=t.clipboardData&&t.clipboardData.getData?t.clipboardData.getData("Text"):t.originalEvent.clipboardData.getData("Text"),this.cell){this.cell.value=e;var n={ev_type:"paste",render:!0,event:t,data:{objectName:"CellContainer",object:this}};this.$rootParent&&this.rootParentSendMsg(n)}return e},e.prototype.rootParentSendMsg=function(t){var e=[];return this.$rootParent?e=this.$rootParent.subjectSend(t):this.$rootTable&&(e=this.$rootTable.subjectSend(t)),e},e}(ht),ut=function(){function t(){}return t.addBackgroundColor=function(t,e){t.style["background-color"]=e},t.removeBackgroundColor=function(t){t.style.removeProperty("background-color")},t.addBorder=function(t,e,n,i){var o="solid ";n&&(o+=n+"px "),i&&(o+=i+" "),t.style["border-"+e]=o},t.removeBorder=function(t){t.style.removeProperty("border-left"),t.style.removeProperty("border-right"),t.style.removeProperty("border-top"),t.style.removeProperty("border-bottom")},t.checkBearing=function(t,e){var n="inner";if(t.currentTarget){t.currentTarget;var i=.25*t.target.offsetWidth,o=.75*t.target.offsetWidth,r=.25*t.target.offsetHeight,a=.75*t.target.offsetHeight;e&&(i=e.left||i,o=t.target.offsetWidth-e.right||o,r=e.top||r,a=t.target.offsetHeight-e.bottom||a),t.offsetY<r&&(n="top"),t.offsetY>a&&(n="bottom"),t.offsetX<i&&(n="left"),t.offsetX>o&&(n="right")}return n},t.getOffsetTopByBody=function(t){var e=0;while(t&&"BODY"!==t.tagName)e+=t.offsetTop,t=t.offsetParent;return e},t.getOffsetLeftByBody=function(t){var e=0;while(t&&"BODY"!==t.tagName)e+=t.offsetLeft,t=t.offsetParent;return e},t}(),pt=function(t){function e(e){return t.call(this,e)||this}return D(e,t),e.prototype.initBeforeSetData=function(e){t.prototype.initBeforeSetData.call(this,e),this.$parent=e.$parent,this.config=k(this.$dragTableConfig.SelfContainerConfig)},e.prototype.onClick=function(t){t.stopPropagation(),this.$rootTable&&this.$rootTable.subjectSend({ev_type:"click",event:t,data:{objectName:this.type+"Container",object:this}})},e.prototype.resize=function(){this.style.height=this.$parent.heightSelfNum+"px",this.style.right=this.rightNum+"px",this.widthNum=this.widthSelfNum+this.rightNum,this.style.lineHeight=this.$parent.heightSelfNum+"px"},e}(ht),ft=function(t){function e(e){return t.call(this,e)||this}return D(e,t),e.prototype.initBeforeSetData=function(e){t.prototype.initBeforeSetData.call(this,e),this.$parent=e.$parent,V(this.config,this.$dragTableConfig.TreeContainerConfig,"union"),V(e,this.$dragTableConfig.treeContainer,"union")},e.prototype.onClick=function(t){t.stopPropagation(),this.nextStatus="open"===this.$openStatus?"close":"open";try{var e=this.$parent;e&&(e.rootParentSendMsg({ev_type:this.nextStatus,event:t,data:{object:this,objectName:"TreeContainer"}}),"loading"!==this.$openStatus&&(this.$openStatus=this.nextStatus,this.loop(this.$openStatus),e.rootParentSendMsg({ev_type:"beforeRender",render:!0,event:t,data:{object:null,objectName:"innerContontainer"}})))}catch(t){console.error(t)}},e.prototype.loop=function(t){"close"===t?this.hideChildren():"open"===t&&this.checkAndChange(),this.children.forEach(function(e){var n=e.treeContainer;n&&n.loop(t)})},e.prototype.setContainerData=function(e,n,i,o,r){t.prototype.setContainerData.call(this,e,n,i,o,r)},e.prototype.resize=function(){var t=this,e=new Array,n=0,i=this.$parent;0!==this.children.length?(this.show=!0,this.children.forEach(function(i,o){e.push(i);var r=i.treeContainer;r&&(r.resize(),e=e.concat(r.allChildren),n+="open"===r.$openStatus?r.children.length:0,n+=i.treeContainer.openChildrenCount,r.$treeParent=t)}),this.widthNum=this.widthSelfNum+this.paddingLeftNum+2):this.widthNum=(this.$treeParent||this.show?this.widthSelfNum:0)+this.paddingLeftNum+2,this.style.paddingLeft=this.paddingLeftNum+"px",this.style.width=this.widthSelfNum+"px",this.heightSelfNum=this.$parent.heightSelfNum,this.style.height=this.heightSelfNum+"px",this.$treeParent&&i&&(/top/.test(this.$parent.type)?(this.widthNum=this.widthSelfNum,this.style.paddingLeft="0px",i.cell.style.textAlign=i.config.cell.style.textAlign):/left/.test(this.$parent.type)&&(i.cell.style.textAlign="left")),this.openChildrenCount=n,this.allChildren=e},e.prototype.getContainerByTheadPosition=function(t){var e=this;return(t||[]).forEach(function(t){e=e.children[t].treeContainer}),e},e.prototype.init=function(){var t=this.$parent;this.addChildren(),this.openOrClose(this.$openStatus),this.$positionManager.treeContainerMap.set(t.id,this)},e.prototype.openOrClose=function(t){"open"===t?this.showAndHide(this.children.length+this.openChildrenCount,"show"):this.showAndHide(this.children.length+this.openChildrenCount,"hide")},e.prototype.checkAndChange=function(){var t=this;this.children.forEach(function(e){e.hideType="open"===t.$openStatus?"visible":"hideAll-tree"})},e.prototype.hideChildren=function(){this.children.forEach(function(t){t.hideType="hideAll-tree"})},e.prototype.addChildrenAsy=function(t){var e=this;this.$openStatus="loading",t.then(function(t){e.$openStatus=e.nextStatus,e.addChildren(t),e.openOrClose(e.$openStatus);var n=e.$parent;n.rootParentSendMsg({ev_type:"beforeRender",render:!0,event:null,data:{object:e,objectName:"null"}})})},e.prototype.createContain=function(t){var e=j(t),n=this.$parent,i=V(e,{treeContainer:{paddingLeftNum:this.paddingLeftNum+15},side1:1,side2:1,$groupId:this.$groupId,type:n.type,$parent:this,$rootTable:n.$rootTable,$rootParent:n.$rootParent},"union",/\$/),o=yt.create("thead",i);return o},e.prototype.addChildren=function(t){var e=this;this.setContainerData({children:t});var n=this.$parent;if(n&&n.$parent){var i=n.$parent,o=i.children.indexOf(n)+1;this.cleanChildrenInSystem(),this.children.forEach(function(t,r){var a=n.createContain(t);a.treeContainer.resize();var s=a.treeContainer.allChildren.length;i.addChild(a,o+r),o+=s,e.children[r]=a,a.addByTree=!0})}this.resize()},e.prototype.cleanChildrenInSystem=function(){var t=this;this.children.forEach(function(e){e.$inSystem&&t.$rootTable.theadDelete({type:e.type,targetContainerPosition:e.theadPosition,withChildren:!0})})},e.prototype.showAndHide=function(t,e){this.allChildren.forEach(function(n,i){var o="hide"===e?"hideAll-tree":"visible";t>0&&o!==n.hideType&&(n.hideType=o,t--)})},e}(pt),yt=function(){function t(){}return t.create=function(t,e){var n=j(e),i=null;return/inner/.test(t)?i=new ft(n):/thead|Thead/.test(t)?i=new bt(n):/selfContainer/.test(t)?i=new pt(n):/treeContainer/.test(t)&&(i=new ft(n)),i},t}(),bt=function(t){function e(e){var n=t.call(this,e)||this;return n.$dragType="none",n}return D(e,t),e.prototype.initBeforeSetData=function(e){t.prototype.initBeforeSetData.call(this,e);var n={$parent:this,$rootParent:this.$rootParent,$rootTable:this.$rootTable,$groupId:this.$groupId};this.treeContainer=yt.create("treeContainer",n),this.config=k(this.$dragTableConfig.TheadContainerConfig),V(e,this.$dragTableConfig.theadContainer,"union"),delete this.config.style.width,delete this.config.style.height},e.prototype.setSelfContainers=function(t){var e=this;this.selfContainers=new Array,t.forEach(function(t){var n={$parent:e,$rootParent:e.$rootParent,$rootTable:e.$rootTable,$groupId:e.$groupId};V(t,n,"union",/\$/);var i=yt.create("selfContainer",t);e.selfContainers.push(i)})},e.prototype.setContainerData=function(e,n,i,o,r){var a=this,s=function(t,e){if("tbodyConfig"===t)a.setProperty(t,e);else{if("treeContainer"===t)return V(e,a.$dragTableConfig.treeContainer),void(a.treeContainer&&"function"===typeof a.treeContainer.setContainerData?a.treeContainer.setContainerData(e):a.treeContainer=yt.create("treeContainer",e));if("selfContainers"===t)return void a.setSelfContainers(e)}a.setProperty(t,e)};t.prototype.setContainerData.call(this,e,n,i,o,s),/^top/.test(this.type)?(this.side1Name="width",this.side2Name="height"):/^left/.test(this.type)&&(this.side1Name="height",this.side2Name="width")},e.prototype.addChild=function(e,n){return t.prototype.addChild.call(this,e,n),e.treeContainer&&e.treeContainer.init(),e.id},e.prototype.resize=function(){var t=this;/visible|tree/.test(this.hideType)||this.$positionManager.hideContainerMap.set(this.id,this);var e=this.hideTypeTemporary||this.hideType;if(this.$inSystem=!0,this.resetByIndexContainer(),this.$resizeChildren=[],"hideSelf"===e)this.span1=0,this.span2=0,this.side1=0,this.side2=0,this[this.side2Name+"Num"]=0,this[this.side1Name+"Num"]=0,this[this.side2Name+"SelfNum"]=0,this[this.side1Name+"SelfNum"]=0;else{if(/hideAll/.test(e))return this.span1=0,this.span2=0,this.side1=0,this.side2=0,this[this.side2Name+"Num"]=0,this[this.side1Name+"Num"]=0,[];"hideChildrenHeight"===this.hideTypeTemporary&&(this.span1=1,this.span2=0,this.side1=1,this.side2=0,this[this.side2Name+"Num"]=0,this[this.side2Name+"SelfNum"]=0)}this.isRootParent&&(this.span1=0,this.span2=0,this.side1=0,this.side2=0,this[this.side2Name+"SelfNum"]=0);var n=0,i=0,o=0,r=0,a=[];if(0!==this.children.length&&(this.children.forEach(function(s,l){var c=t.theadPosition.concat(l);s.theadPosition=c,"hideChildrenHeight"===e&&(s.hideTypeTemporary="hideChildrenHeight");var h=s.resize();s.hideTypeTemporary=null,a=a.concat(h),o+=s.side1,n=s.side2>n?s.side2:n,r+=s[t.side1Name+"Num"],i=s[t.side2Name+"Num"]>i?s[t.side2Name+"Num"]:i}),this.side1=o||this.side1,this[this.side1Name+"Num"]=this[this.side1Name+"SelfNum"]=this[this.side1Name+"ChildNum"]=r||this[this.side1Name+"SelfNum"],this.span1=o,this.style[this.side1Name]=r+"px",this[this.side2Name+"ChildNum"]=i,this.side2=n+this.side2,this[this.side2Name+"Num"]=i+this[this.side2Name+"SelfNum"]),this.style[this.side1Name]=this[this.side1Name+"SelfNum"]+"px",this.style[this.side2Name]=this[this.side2Name+"SelfNum"]+"px",this.$resizeChildren=a,this.makeChildrenSameSide2(n,i),this.treeContainer&&this.innerContainerRender(),this.selfContainerRender(),this.cell&&(this.cell.render(),this.cell.style.paddingLeft=this.paddingLeftNum+"px",this.cell.style.paddingRight=this.paddingRightNum+"px"),"hideSelf"===e)return a;var s=[this];return 0===a.length&&"hideChildrenHeight"!==this.hideType&&("hideChildrenHeight"===e&&(s=[]),this.$rootParent&&!this.isRootParent&&0===o&&this.$rootParent.$leafIndexList.push(this)),s},e.prototype.changeEveryChildProperty=function(t){this.setContainerData(t),this.children.forEach(function(e){e.changeEveryChildProperty(t)})},e.prototype.innerContainerRender=function(){this.treeContainer.$parent=this,this.treeContainer.resize(),this.paddingLeftNum=this.treeContainer.widthNum},e.prototype.selfContainerRender=function(){var t=this;this.paddingRightNum=0,this.selfContainers.forEach(function(e){e.resize(),e.show&&(t.paddingRightNum=e.widthNum>t.paddingRightNum?e.widthNum:t.paddingRightNum)})},e.prototype.getTopList=function(t,e){var n=this;try{this.position=k(e),this.position.colStr=X(e.colNum),this.position.rowStr=e.rowNum+1;var i=this.clone(void 0,/\$|userData|treeContainer/,!0);this.$positionManager.setPositionMap(this.position,this,"source"),this.$positionManager.setPositionMap(this.position,i,"clone"),t[0].push(i);var o=k(e);0!==this.$resizeChildren.length&&this.$resizeChildren.forEach(function(i){var r=k(e);r.rowNum=e.rowNum+n.span2,r.colNum=o.colNum,i.getTopList(A(t),r),o.colNum+=i.side1})}catch(t){}},e.prototype.getLeftList=function(t,e){var n=this.$rootParent.$tableHeadLeft;this.position=k(e),this.position.colStr=X(e.colNum),this.position.rowStr=e.rowNum+1;var i=this.clone(void 0,/\$|userData|treeContainer/,!0);this.$positionManager.setPositionMap(this.position,this,"source"),this.$positionManager.setPositionMap(this.position,i,"clone"),n[t].push(i);var o=k(e);o.colNum=o.colNum+this.span2,this.$resizeChildren.forEach(function(e){var n=k(o);e.getLeftList(t,n),o.rowNum=o.rowNum+e.side1,t+=e.side1})},e.prototype.createContain=function(t){var n=k(t,/\$/);V(n,{type:this.type,side1:1,side2:1,$rootTable:this.$rootTable,$rootParent:this.$rootParent,$groupId:this.$groupId},"union",/\$/);var i=new e(n);return i},e.prototype.onMouseMove=function(t){if(this.$rootTable.canDragResize&&"none"===this.$dragType){var e=t.currentTarget;ut.removeBorder(e);var n=ut.checkBearing(t,{bottom:10,right:10});"right"===n&&"left-index"!==this.type&&1===this.side1?(e.style.cursor="e-resize",ut.addBorder(e,n),this.canDragResize=!0,this.draggable=!1):"bottom"===n&&"top-index"!==this.type&&1===this.side2?(e.style.cursor="s-resize",ut.addBorder(e,n),this.canDragResize=!0,this.draggable=!1):(e.style.cursor="auto",this.canDragResize=!1,this.draggable=!0),e=null}},e.prototype.onMouseOut=function(t){t.currentTarget.style.cursor="auto",ut.removeBorder(t.currentTarget),this.canDragResize=!1,this.draggable=!0},e.prototype.onMouseDown=function(e){var n=this,i=e.currentTarget;if(1===e.which&&this.$rootTable.canDragResize&&this.canDragResize){this.$dragType="e-resize"===i.style.cursor?"width":"height",this.draggable=!1,this.$rootTable.$selectBoxEntity.clear();var o={};o.initMouseLeftX=e.pageX,o.initMouseTopY=e.pageY,o.initWidth=e.target.clientWidth,o.initHeight=e.target.clientHeight,o.initLeft=e.pageX-o.initWidth,o.initTop=e.pageY-o.initHeight,o.x=o.initLeft,o.y=o.initTop;var r,a=0,s="width"===this.$dragType?"width":"height",l=function(t){var e=t.pageX-o.initMouseLeftX;if(!(-1*e>n.style.minWidth)){var i=t.pageY-o.initMouseTopY;if(!(-1*i>o.initHeight)){"width"===n.$dragType?(a=e,r=n.getColObj(n.position,"clone")):"height"===n.$dragType&&(a=i,r=n.getRowObj(n.position,"clone"));var l=function(t){if(r.hasOwnProperty(t)){var e=r[t];if(e){var n=e[s+"SelfNum"];if(e.style[s]=n+a+"px",e.cell.style[s]=n+a+"px","height"===s){e.cell.style.lineHeight=n+a+"px";var i=e.treeContainer;i&&(i.style.height=e.cell.style.lineHeight),(e.selfContainers||[]).forEach(function(t){t.style.height=e.cell.style.lineHeight})}}}};for(var c in r)l(c)}}},c=function(t){document.removeEventListener("mouseup",c),document.removeEventListener("mousemove",l);var e=n[n.$dragType+"SelfNum"]+a;n.setWidthOrHeight(n.$dragType,e),n.draggable=!0,n.canDragResize=!1,n.$dragType="none",i.style.cursor="auto",i=null};document.addEventListener("mousemove",l),document.addEventListener("mouseup",c)}t.prototype.onMouseDown.call(this,e)},e.prototype.dragStart=function(t){var e={operationType:"move",containerData:this},n=this.$rootParent,i=this.checkStatus("draggable");n&&i&&(n.dragStartData=e,t.dataTransfer.setData("dragStartData",JSON.stringify(k(e,/\$/))),this.rootParentSendMsg({ev_type:"dragStart",event:t,data:{object:e,objectName:"dragStartData"}}))},e.prototype.dragOver=function(t){var e=this.rootParentSendMsg({ev_type:"dragOver",event:t,data:{object:this,objectName:"TheadContainer"}});if(!/cancel/.test(e.join("-"))){var n=this.checkStatus("draggable"),i=this.$rootParent;if(i&&n&&(!i.dragStartData||i.dragStartData.containerData!==this)){var o=t.currentTarget;this.resetDragOverStyle(o);var r=ut.checkBearing(t);-1!==this.$positionCheck.indexOf(r)&&("inner"===r&&ut.addBackgroundColor(o,"red"),ut.addBorder(o,r,3,"#000"),t.preventDefault())}}},e.prototype.drop=function(t){var e=this.$rootParent;try{var n=t.dataTransfer.getData("dragStartData"),i=e.dragStartData?e.dragStartData:JSON.parse(n||"{}"),o=void 0,r=this;if(this.$positionCheck&&0!==this.$positionCheck.length){var a=ut.checkBearing(t);r=this.getContainerByTheadPosition(this.theadPosition),o={target:{containerData:r},targetBearing:a,source:{containerData:i.containerData,withChildren:i.withChildren},operationType:i.operationType}}else o={target:{containerData:r},targetBearing:"other",source:{containerData:i.containerData},operationType:i.operationType};var s=t.currentTarget;this.resetDragOverStyle(s),this.rootParentSendMsg({ev_type:"drop",event:t,data:{object:o,objectName:"DragTsData"}}),e.dragStartData=null,s=null}catch(t){console.error(t)}},e.prototype.dragEnd=function(t){var e=this.$rootParent;e&&(e.dragStartData=null,this.rootParentSendMsg({ev_type:"dragEnd",event:t,data:{object:this,objectName:"TheadContainer"}}))},e.prototype.dragLeave=function(t){var e=this.rootParentSendMsg({ev_type:"dragLeave",event:t,data:{object:this,objectName:"TheadContainer"}});if(!/cancel/.test(e.join("-"))){var n=t.currentTarget;ut.addBackgroundColor(n,this.style.background),this.resetDragOverStyle(n)}},e.prototype.dragEnter=function(t){var e=this.rootParentSendMsg({ev_type:"dragEnter",event:t,data:{object:this,objectName:"TheadContainer"}});/cancel/.test(e.join("-"))},e.prototype.getContainerByTheadPosition=function(t){var e=this.$rootParent;if(e){var n=e;return(t||[]).forEach(function(t){n=n.children[t]}),n}},e.prototype.clone=function(e,n,i){var o=t.prototype.clone.call(this,e,n,i),r=[];return o.children.forEach(function(t){t.addByTree||r.push(t)}),o.children=r,o},e.prototype.resetByIndexContainer=function(){if("top-left"!==this.id){var t=this.$positionManager.getTopIndexContainer(this.position,"last");t?this.widthNum=this.widthSelfNum=t.widthNum:(this.widthSelfNum=this.config.widthSelfNum,this.widthNum=this.widthSelfNum);var e=this.$positionManager.getLeftIndexContainer(this.position,"last");e?this.heightNum=this.heightSelfNum=e.heightNum:(this.heightSelfNum=this.config.heightSelfNum,this.heightNum=this.heightSelfNum),this.span1=this.config.span1,this.span2=this.config.span2,this.side1=this.config.side1,this.side2=this.config.side2}},e.prototype.increaseTheLeafChildHeight=function(t,e){if(0!==this.$resizeChildren.length)this.$resizeChildren.forEach(function(n){n.increaseTheLeafChildHeight(t,e)}),this.side2+=t;else if(0!==this.side2){var n=Number(this.style[this.side2Name].replace("px",""));this.style[this.side2Name]=n+e+"px",this[this.side2Name+"SelfNum"]=n+e,this[this.side2Name+"Num"]=n+e,this.treeContainer&&this.innerContainerRender(),this.selfContainerRender(),this.span2+=t,this.cell.render(),this.side2+=t}},e.prototype.makeChildrenSameSide2=function(t,e){this.$resizeChildren.forEach(function(n){var i=t-n.side2,o=e-n[n.side2Name+"Num"];(i>0||o>0)&&n.increaseTheLeafChildHeight(i,o)})},e.prototype.resetDragOverStyle=function(t){ut.removeBorder(t),ut.removeBackgroundColor(t),ut.addBackgroundColor(t,this.style.background)},e}(dt),vt=function(t){function e(e){var n=t.call(this,e)||this;return n.$tableHeadTop=new Array,n.$tableHeadLeft=new Array,n}return D(e,t),e.prototype.initBeforeSetData=function(e){t.prototype.initBeforeSetData.call(this,e),this.cell=null,this.dragStartData=null,this.$rootParent=this,V(this.config,this.$dragTableConfig.BaseTheadConfig,"union"),"top"===this.type?V(e,this.$dragTableConfig.topThead,"union"):"left"===this.type&&V(e,this.$dragTableConfig.leftThead,"union")},e.prototype.resize=function(){var e;this.$leafIndexList=[],this.$leafIndexList2=[],t.prototype.resize.call(this),this.$leafIndexList.forEach(function(t){e=e?t.theadPosition.length>e.theadPosition.length&&0!==t.span2?t:e:t});var n=!0;if(e)do{1==e.span2&&this.$leafIndexList2.splice(0,0,e),e.$parent?e=e.$parent:n=!1}while(n)},e.prototype.convert2TheadTopList=function(t){var e=this;this.$tableHeadTop=[];for(var n=0;n<this.side2;n++)this.$tableHeadTop.push([]);var i=k(t);return this.$resizeChildren.forEach(function(t){t.getTopList(e.$tableHeadTop,i),i.rowNum=i.rowNum,i.colNum=i.colNum+t.side1}),this.$tableHeadTop},e.prototype.convert2TheadLeftList=function(t){var e=0;this.$tableHeadLeft=[];for(var n=0;n<this.side1;n++)this.$tableHeadLeft.push([]);var i=k(t);return this.side1>0&&this.$resizeChildren.forEach(function(t,n){t.getLeftList(e,i),i.rowNum=i.rowNum+t.side1,i.colNum=i.colNum,e+=t.side1}),this.$tableHeadLeft},e}(bt),gt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return D(e,t),e.prototype.initBeforeSetData=function(e){t.prototype.initBeforeSetData.call(this,e),this.config=k(this.$dragTableConfig.TbodyContainerConfig),V(e,this.$dragTableConfig.tbodyContainer,"union"),this.renderByThead=!0},e.prototype.setContainerData=function(e,n,i,o,r){t.prototype.setContainerData.call(this,e,n,i,o,r)},e}(dt),mt=function(t){function e(e){var n=t.call(this,e)||this;return n.separator="_",n.$rootParent=n,n.cell=null,n}return D(e,t),e.prototype.initBeforeSetData=function(e){t.prototype.initBeforeSetData.call(this,e),V(this.config,this.$dragTableConfig.BaseTbodyConfig,"union"),V(e,this.$dragTableConfig.baseTbody,"union")},e.prototype.setRowData=function(t,e){var n=this;try{t=t||"tbody_"+q();var i=e||{};if(Array.isArray(i))i.forEach(function(e,i){if(n.topIndexList[i]){var o=n.topIndexList[i].renderId;n.setData(t+n.separator+o,e)}});else if("object"===typeof i)for(var o in i)if(i.hasOwnProperty(o)){var r=i[o];this.setData(t+this.separator+o,r)}return t}catch(t){return console.error("setRowData数据有误"),console.error(t),null}},e.prototype.setColData=function(t,e){var n=this;try{t=t||"tbody_"+q();var i=e||{};if(Array.isArray(i))i.forEach(function(e,i){if(n.leftIndexList[i]){var o=n.leftIndexList[i].renderId;n.setData(o+n.separator+t,e)}});else if("object"===typeof i)for(var o in i)if(i.hasOwnProperty(o)){var r=i[o];this.setData(o+this.separator+t,r)}return t}catch(t){return console.error("setColData"),console.error(t),null}},e.prototype.setTbodyData=function(t){var e=this;this.$rootTable.render();try{if(Array.isArray(t))t.forEach(function(t,n){if(e.leftIndexList[n]){var i=e.leftIndexList[n].renderId;e.setRowData(i,t)}else e.$rootTable.addOneRow({data:t,render:!1})});else if("object"===typeof t)for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];this.setData(n,i)}}catch(t){console.error(t),console.error("输入数据格式有误")}this.subjectSend({ev_type:"beforeRender",render:!0,event:null,data:{objectName:"setTbodyData",object:null}})},e.prototype.setData=function(t,e){var n;try{n=this.bodyData.hasOwnProperty(t)?this.bodyData[t]:this.createContain(),-1!==["string","number"].indexOf(typeof e)?n.cell.value=e:"object"===typeof e&&n.setContainerData(e)}catch(t){console.error(t)}return n},e.prototype.setContainerData=function(e,n,i,o,r){var a=this,s=function(t,e){"bodyData"!==t?a.setProperty(t,e):a.setTbodyData(e)};for(var l in t.prototype.setContainerData.call(this,e,n,i,o,s),e)if(e.hasOwnProperty(l)){var c=e[l];if("bodyData"===l){for(var h in c)if(c.hasOwnProperty(h)){var d=c[h];this.setRowData(h,d)}}else"object"!==typeof c||Array.isArray(c)||-1!==l.indexOf("$")?this.setProperty(l,c):V(this[l],c,"union")}},e.prototype.resize=function(){this.side1=this.topIndexList.length,this.side2=this.leftIndexList.length},e.prototype.createContain=function(t){var e=this.$groupId,n=new gt({type:"tbody",side1:1,side2:1,$groupId:e,$rootTable:this.$rootTable,$rootParent:this,config:this.$rootParent.config});return t&&n.setContainerData(t),n},e.prototype.render=function(){var t=this,e=this.leftIndexList,n=this.topIndexList;this.resize(),e.forEach(function(e){n.forEach(function(n){var i=e.renderId+t.separator+n.renderId,o=t.createContain();t.bodyData.hasOwnProperty(i)?o=t.bodyData[i]:t.bodyData[i]=o,o.position={table:t.$rootTable.position.table,colNum:n.theadPosition[0],rowNum:e.theadPosition[0],colStr:X(n.theadPosition[0]),rowStr:e.theadPosition[0]+1},o.id=i,t.$positionManager.setPositionMap(o.position,o,"source");var r,a=e.$theadContainer,s=n.$theadContainer,l=e.tbodyConfig.container||{},c=n.tbodyConfig.container||{};if(/sum/.test(e.renderId)?(c={},r=a):/sum/.test(n.renderId)&&(l={},r=s),(/sum/.test(n.renderId)||/sum/.test(e.renderId))&&(e.canSum||void 0===s)&&(n.canSum||void 0===a)){for(var h=r.$rootParent.getContainerByTheadPosition(z(r.theadPosition)),d=new Array,u=0,p=0;p<H(r.theadPosition);p++)u+=h.children[p].side1;for(p=0;p<u;p++)if("top"===r.type&&p){var f=X(r.position.colNum-p-1)+o.position.rowStr;d.push(f)}else{f=o.position.colStr+(r.position.rowNum-p);d.push(f)}o.renderByThead&&(o.cell.value="="+d.join("+"))}var y=t.getDataByWeight("renderByThead",l,c,e.tbodyConfig.weight,n.tbodyConfig.weight);o.renderByThead=void 0===y?o.renderByThead:y,1==o.renderByThead&&o.setContainerData(l,c,e.tbodyConfig.weight,n.tbodyConfig.weight),o.style.width=n.style.width,o.style.height=e.style.height,o.widthSelfNum=n.widthNum,o.heightSelfNum=n.heightNum,o.cell.render()})})},e.prototype.convert=function(){var t=this,e=new Array;return this.leftIndexList.forEach(function(n){var i=new Array;t.topIndexList.forEach(function(e){var o=n.renderId+t.separator+e.renderId;if(t.bodyData.hasOwnProperty(o)){var r=t.bodyData[o];i.push(r),t.$positionManager.setPositionMap(r.position,r,"clone")}}),e.push(i)}),e},e.prototype.output=function(t){var e=this,n={},i=[],o=[];return this.leftIndexList.forEach(function(r){var a={},s=[];e.topIndexList.forEach(function(i){var o=r.renderId+e.separator+i.renderId;if(e.bodyData.hasOwnProperty(o)){var l=e.bodyData[o];"content"===t?(n[o]=l.cell.content,a[i.renderId]=l.cell.content,s.push(l.cell.content)):"container"===t&&(n[o]=l,a[i.renderId]=l,s.push(l))}}),i.push(a),o.push(s)}),{objectData:n,arrayObjectData:i,arrayArrayData:o}},e.prototype.outputByObject=function(){var t=this,e={};return this.leftIndexList.forEach(function(n){if(t.bodyData.hasOwnProperty(n.renderId)){var i=t.bodyData[n.renderId],o={};t.topIndexList.forEach(function(t){i.hasOwnProperty(t.renderId)&&(o[t.renderId]=i[t.renderId].clone())}),e[n.renderId]=o}}),e},e.prototype.cleanTimeOutTbody=function(){var t=this,e={};this.leftIndexList.forEach(function(n){t.topIndexList.forEach(function(i){var o=n.renderId+t.separator+i.renderId;t.bodyData.hasOwnProperty(o)&&(e[o]=t.bodyData[o])})}),this.bodyData=e},e.prototype.clone=function(e,n,i){return this.cleanTimeOutTbody(),t.prototype.clone.call(this,e,n,i)},e}(gt),Ct=function(t){function e(e){var n=t.call(this,e)||this;return n.treeContainer=null,n}return D(e,t),e.prototype.initBeforeSetData=function(e){t.prototype.initBeforeSetData.call(this,e),this.config=k(this.$dragTableConfig.IndexContainerConfig),/top-index/.test(this.type)?V(e,this.$dragTableConfig.topIndexContainer,"union"):/left-index/.test(this.type)&&V(e,this.$dragTableConfig.leftIndexContainer,"union")},e.prototype.update=function(t){t&&(this.tbodyConfig=t.tbodyConfig,this.canSum=t.canSum,this.renderId=t.id,this.$theadContainer=t,/left/.test(this.type)?(this.style.height=t.style.height,this.heightNum=this.heightSelfNum=t.heightSelfNum,/top/.test(t.type)&&(this.style.zIndex=100)):/top/.test(this.type)&&(this.style.width=t.style.width,this.widthNum=this.widthSelfNum=t.widthSelfNum,/left/.test(t.type)&&(this.style.zIndex=100)))},e.prototype.resetByIndexContainer=function(){"top-left"!==this.id&&(this.widthNum=this.widthSelfNum,this.heightNum=this.heightSelfNum,this.span1=this.config.span1,this.span2=this.config.span2,this.side1=this.config.side1,this.side2=this.config.side2)},e}(bt),Tt=function(t){function e(e){return t.call(this,e)||this}return D(e,t),e.prototype.initBeforeSetData=function(e){t.prototype.initBeforeSetData.call(this,e),this.cell=null,this.$rootParent=this,V(this.config,this.$dragTableConfig.IndexTheadConfig,"union"),/top-index/.test(this.type)?V(e,this.$dragTableConfig.topIndexThead,"union"):/left-index/.test(this.type)&&(V(e,this.$dragTableConfig.leftIndexThead,"union"),this.config.style.width="80px")},e.prototype.resize=function(){this.$leafIndexList=[],this.$leafIndexList2=[],t.prototype.resize.call(this)},e.prototype.replaceChild=function(e,n,i){t.prototype.replaceChild.call(this,e,n,i),this.$positionManager.setPositionMap(e.position,e,"last")},e.prototype.render=function(){var t=this;this.resize(),this.children.forEach(function(e,n){e.position.table=t.$rootTable.position.table,e.cell&&(-1!==e.type.indexOf("top")?(e.position.colNum=n,e.position.colStr=X(n),e.position.rowStr=0,e.cell.value=X(n)):-1!==e.type.indexOf("left")&&(e.position.colStr="@",e.position.rowNum=n,e.position.rowStr=n+1,e.cell.value=n+1),e.id=e.cell.value,1===t.$rootTable.debugLevel?e.cell.value=e.renderId:t.$rootTable.debugLevel,t.$positionManager.setPositionMap(e.position,e,"source"),e.cell.render())})},e.prototype.createContain=function(t){var e=this.$groupId,n=new Ct({type:this.type,side1:1,side2:1,$rootParent:this.$rootParent,$rootTable:this.$rootTable,$groupId:e});if(t&&n.setContainerData(t),!n.cell){var i=new st({$parent:n});n.setCell(i)}return n},e.prototype.fastAddChild=function(){var t=this.createContain();this.addChild(t)},e.prototype.convert=function(){var t=this,e=new Array;return this.children.forEach(function(n){var i=n.clone(void 0,void 0,!0);t.$positionManager.setPositionMap(i.position,i,"clone"),e.push(i)}),e},e}(Ct),$t=function(t){function e(e){var n=t.call(this,e)||this;return n.tableName="",n.$colNumber=new Array,n.$rowNumber=new Array,n.$tableHeadTop=new Array,n.$tableHeadLeft=new Array,n.$tableBody=new Array,n.$keyDownSet=new Set,n}return D(e,t),e.prototype.initBeforeSetData=function(e){t.prototype.initBeforeSetData.call(this,e)},e.prototype.onKeyUp=function(t){this.$keyDownSet.delete(t.key)},e.prototype.onKeyDown=function(t){this.$keyDownSet.add(t.key)},e.prototype.onClick=function(t){this.subjectSend({ev_type:"click",event:t,data:{objectName:"TableContainer",object:this}})},e.prototype.getEntity=function(t){switch(t){case"top":return this.theadTopEntity;case"left":return this.theadLeftEntity;case"top-index":return this.theadTopIndexEntity;case"left-index":return this.theadLeftIndexEntity;case"tbody":return this.tbodyEntity;default:return console.log("getEntity-default"),this.theadTopEntity}},e}(ht),wt=function(){function t(t,e){this.selectMap=new Map,this.selectList=new Array,this.size=0,this.stlye={position:"absolute",zIndex:98},this.type=t,this.$TableContainer=e}return t.getInstance=function(e,n){var i=this.instances[e];return i||(this.instances[e]=i=new t(e,n)),i},t.prototype.createSelectContainer=function(t,e){var n=e.$rootTable,i=e.clone();i.selectBoxType="main";var o=98;switch(e.type){case"top":case"top-index":if(o=100,i.selectBoxType=n.hasTopFixedTable?"top":"main",n.hasTopFixedTable&&n.hasLeftFixedTable){var r=e.$theadContainer;r&&!new RegExp(r.type).test(e.type)&&(i.selectBoxType="top-left",o=101)}break;case"left":case"left-index":if(o=100,i.selectBoxType=n.hasLeftFixedTable?"left":"main",n.hasTopFixedTable&&n.hasLeftFixedTable){r=e.$theadContainer;r&&!new RegExp(r.type).test(e.type)&&(i.selectBoxType="top-left",o=101)}break;case"tbody":o=96,i.selectBoxType="main";break}var a=t.offsetWidth-2,s=t.clientHeight-2;i.topStyle={position:"absolute",left:"0px",top:"0px",width:a+"px",borderBottom:"2px solid blue",boxSizing:"border-box",zIndex:o},i.bottomStyle={position:"absolute",left:"0px",top:s+"px",width:a+"px",boxSizing:"border-box",borderTop:"2px solid blue",zIndex:o},i.leftStyle={position:"absolute",left:"0px",top:"0px",height:s+"px",borderLeft:"2px solid blue",boxSizing:"border-box",zIndex:o},i.rightStyle={position:"absolute",left:a-1+"px",top:"0px",height:s+"px",borderLeft:"2px solid blue",boxSizing:"border-box",zIndex:o};var l=i.style={};return l.left=t.offsetLeft,l.top=t.offsetTop,l.position="relative",l.zIndex=o,i},t.prototype.add=function(t){this.currentCotanier=t;var e=this.selectMap.set(t.id,t);return this.render(),e},t.prototype.has=function(t){var e=!1;return this.selectList.forEach(function(n){JSON.stringify(n.id)===JSON.stringify(t.id)&&(e=!0)}),e},t.prototype.delete=function(t){var e=this.selectMap.delete(t.id);return this.render(),e},t.prototype.clear=function(){this.currentCotanier=null;var t=this.selectMap.clear();return this.render(),t},t.prototype.forEach=function(t,e){this.selectMap.forEach(t,e)},t.prototype.render=function(){var t=this;this.selectList=[],this.selectMap.forEach(function(e,n){t.selectList.push(e)}),this.size=this.selectMap.size},t.prototype.convert=function(){return this.selectList},t.instances={},t}(),xt=function(t){function e(e){var n=t.call(this,e)||this;return n.setExpandedContainer(),n}return D(e,t),e.prototype.setExpandedContainer=function(t){this.defaultExpandedIds=t||this.defaultExpandedIds;var e=this.$positionManager.treeContainerMap;e.forEach(function(t,e){t.$openStatus="close"}),this.defaultExpandedIds.forEach(function(t){var n=!0,i=e.get(t);if(i){do{i.$openStatus="open",i.$treeParent,i.$treeParent?i=i.$treeParent:n=!1}while(n);i.resize(),i.loop(i.$openStatus)}}),this.render()},e.prototype.getAllHideContainer=function(){return this.$positionManager.hideContainerMap},e.prototype.initBeforeSetData=function(e){t.prototype.initBeforeSetData.call(this,e),V(this.config,this.$dragTableConfig.BaseTableConfig,"union"),V(e,this.$dragTableConfig.table,"union");var n=this.$groupId;this.$selectBoxEntity=wt.getInstance(this.$groupId,this),this.tableHeadTopLeft=new bt({id:"top-left",side1:1,side2:1,style:{backgroundColor:"#fff"},$groupId:n,$rootTable:this}),this.theadTopEntity=new vt({id:"topThead",type:"top",$groupId:n,$rootTable:this,side1:0,side2:0}),this.theadLeftEntity=new vt({id:"leftThead",type:"left",$groupId:n,$rootTable:this,side1:0,side2:0}),this.theadTopIndexEntity=new Tt({id:"topIndexThead",type:"top-index",$groupId:n,$rootTable:this,side1:0,side2:0}),this.theadLeftIndexEntity=new Tt({id:"leftIndexThead",type:"left-index",$groupId:n,$rootTable:this,side1:0,side2:0}),this.tbodyEntity=new mt({id:"baseTbody",type:"tbody",$groupId:n,$rootTable:this,side1:0,side2:0}),this.initSubject(this)},e.prototype.setConfig=function(t){V(this.config,t.table,"union"),V(this.theadTopEntity.config,t.topThead,"union"),V(this.theadLeftEntity.config,t.leftThead,"union"),V(this.theadTopIndexEntity.config,t.topIndexThead,"union"),V(this.theadLeftIndexEntity.config,t.leftIndexThead,"union"),V(this.tbodyEntity.config,t.baseTbody,"union"),this.render()},e.prototype.setContainerData=function(e){var n=this;try{var i=j(e),o=function(t,e){return"theadTopEntity"===t?(V(e,n.$dragTableConfig.topThead),void n.theadTopEntity.setContainerData(e)):"theadLeftEntity"===t?(V(e,n.$dragTableConfig.leftThead),void n.theadLeftEntity.setContainerData(e)):"theadTopIndexEntity"===t?(V(e,n.$dragTableConfig.topIndexThead),void n.theadTopIndexEntity.setContainerData(e)):"theadLeftIndexEntity"===t?(V(e,n.$dragTableConfig.leftIndexThead),void n.theadLeftIndexEntity.setContainerData(e)):"tbodyEntity"===t?(V(e,n.$dragTableConfig.baseTbody),void n.tbodyEntity.setContainerData(e)):void n.setProperty(t,e)};t.prototype.setContainerData.call(this,i,void 0,void 0,void 0,o)}catch(t){console.error("setContainerData 中出现出错"),console.error(t)}this.initAfterSetData(),this.subjectSend({ev_type:"beforeRender",render:!0,event:null,data:{objectName:"setContainerData",object:this}})},e.prototype.onDestroy=function(){var t=this;t.theadTopEntity.$subject.unsubscribe(t.onReceiveMsg,t),t.theadLeftEntity.$subject.subscribe(t.onReceiveMsg,t),t.tbodyEntity.$subject.subscribe(t.onReceiveMsg,t)},e.prototype.initTable=function(t,e){for(var n=0;n<t;n++)this.theadTopIndexEntity.fastAddChild(),this.theadAdd({type:"top",targetParentPosition:[]});e=void 0===e?1:e;for(var i=0;i<e;i++)this.addOneRow();this.render()},e.prototype.addOneRow=function(t){var e,n=t?t.param:void 0,i=t?t.data:void 0,o=t?t.render:void 0,r=null,a=!1,s=this.$selectBoxEntity.currentCotanier;if(n?(e={type:"left",targetParentPosition:n.targetParentPosition,insertIndex:n.insertIndex,sourceContainerData:n.sourceContainerData},a=!0):0!==this.$tableHeadLeft.length&&(a=!0),s){var l=void 0;if(/^left$/.test(s.type))l={type:"left",targetParentPosition:z(s.theadPosition),insertIndex:H(s.theadPosition)+1};else{var c=this.getLeftIndexContainer(s.position);if(c&&c.$theadContainer){var h=c.$theadContainer;l={type:"left",targetParentPosition:z(h.theadPosition),insertIndex:H(h.theadPosition)+1}}}e=V(l,e,"union")}else{var d={type:"left",targetParentPosition:[]};e=V(d,e,"union")}if(a){var u=this.theadAdd(e);r=u.id}var p=this.theadLeftIndexEntity.createContain();return this.theadLeftIndexEntity.addChild(p),r=this.tbodyEntity.setRowData(r,i||{}),p.renderId=r,!1!==o&&this.render(),r},e.prototype.addOneCol=function(t){var e,n=t?t.param:void 0,i=t?t.data:void 0,o=t?t.render:void 0,r=null,a=!1,s=this.$selectBoxEntity.currentCotanier;if(n?(e={type:"top",targetParentPosition:n.targetParentPosition,insertIndex:n.insertIndex,sourceContainerData:n.sourceContainerData},a=!0):0!==this.$tableHeadTop.length&&(a=!0),s){var l=void 0;if(/^top$/.test(s.type))l={type:"top",targetParentPosition:z(s.theadPosition),insertIndex:H(s.theadPosition)+1};else if(/^tbody$/.test(s.type)){var c=this.getTopIndexContainer(s.position);if(c&&c.$theadContainer){var h=c.$theadContainer;l={type:"top",targetParentPosition:z(h.theadPosition),insertIndex:H(h.theadPosition)+1}}}e=V(l,e,"union")}else{var d={type:"top",targetParentPosition:[]};e=V(d,e,"union")}if(a){var u=this.theadAdd(e);r=u.id}var p=this.theadTopIndexEntity.createContain();return r=this.tbodyEntity.setColData(r,i||{}),p.renderId=r,this.theadTopIndexEntity.addChild(p),!1!==o&&this.render(),r},e.prototype.setTbodyData=function(t){this.tbodyEntity.setTbodyData(t)},e.prototype.theadAddReplace=function(t,e){var n=t.targetContainerPosition,i=this.getEntity(t.type),o=H(n),r=z(n),a=i.getContainerByTheadPosition(r);if(t.sourceContainerData){0==t.withChildren&&(t.sourceContainerData.children=new Array);var s=i.createContain(t.sourceContainerData);a.replaceChild(s,o,t.targetWithChildren)}if(t.sourceContainerData){s=i.createContain(t.sourceContainerData);a.replaceChild(s,o,t.withChildren)}this.onReceiveMsg({ev_type:"theadAddReplace",event:null,render:e,data:{objectName:"ParamTheadAddReplace",object:t}})},e.prototype.theadAdd=function(t,e){var n;try{t.sourceContainerData||(t.sourceContainerData={cell:{value:""}}),0==t.withChildren&&(t.sourceContainerData.children=new Array);var i=this.getEntity(t.type),o=i.getContainerByTheadPosition(t.targetParentPosition);n=i.createContain(t.sourceContainerData),o.addChild(n,t.insertIndex),this.onReceiveMsg({ev_type:"theadAdd",event:null,render:e,data:{objectName:"ParamTheadAdd",object:t}})}catch(t){console.error(t),this.onReceiveMsg({ev_type:"error",event:null,data:{objectName:"error",object:t}})}return n},e.prototype.theadMove=function(t,e){try{var n=H(t.sourceContainerData.theadPosition),i=z(t.sourceContainerData.theadPosition);if(t.sourceContainerData){var o=this.getEntity(t.type),r=o.getContainerByTheadPosition(t.targetParentPosition),a=this.getEntity(t.sourceContainerData.type),s=a.getContainerByTheadPosition(i),l=a.getContainerByTheadPosition(t.sourceContainerData.theadPosition);JSON.stringify(i)===JSON.stringify(t.targetParentPosition)&&n>t.insertIndex?(s.deletChild(n,1,t.withChildren),r.addChild(l,t.insertIndex)):(r.addChild(l,t.insertIndex),s.deletChild(n,1,t.withChildren)),t.withChildren||(l.children=new Array),o.resize(),a.resize()}this.onReceiveMsg({ev_type:"theadMove",render:e,event:null,data:{objectName:"ParamTheadMove",object:t}})}catch(t){this.onReceiveMsg({ev_type:"error",event:null,data:{objectName:"theadMove",object:t}})}},e.prototype.theadDelete=function(t,e){try{var n=void 0,i=void 0,o=void 0,r=void 0,a=!1,s=!1,l=this.$selectBoxEntity.currentCotanier;if(t&&(i=H(t.targetContainerPosition),o=z(t.targetContainerPosition),n=t.targetContainerPosition,r=t.type,a=t.withChildren,s=!0),l&&(i=void 0!==i?i:H(l.theadPosition),o=void 0!==o?o:z(l.theadPosition),n=void 0!==n?n:l.theadPosition,r=r||l.type,s=!0),s){var c=this.getEntity(r),h=(c.getContainerByTheadPosition(n),c.getContainerByTheadPosition(o));h.deletChild(i,1,a),c.resize(),this.onReceiveMsg({ev_type:"theadDelete",render:e,event:null,data:{objectName:"ParamTheadDelete",object:t}})}else console.error("theadDelete 未传入参数")}catch(t){this.onReceiveMsg({ev_type:"error",event:null,data:{objectName:"theadDelete",object:t}})}},e.prototype.theadMoveReplace=function(t,e){try{var n=t.targetContainerPosition,i=H(n),o=z(n),r=this.getEntity(t.type),a=r.getContainerByTheadPosition(o),s=H(t.sourceContainerData.theadPosition),l=z(t.sourceContainerData.theadPosition),c=this.getEntity(t.sourceContainerData.type),h=c.getContainerByTheadPosition(l);if(t.sourceContainerData){t.withChildren||(t.sourceContainerData.children=new Array);var d=r.createContain(t.sourceContainerData);a.replaceChild(d,i,!1),h.deletChild(s,1,t.withChildren),r.resize(),c!==r&&c.resize(),this.onReceiveMsg({ev_type:"theadMoveReplace",event:null,render:e,data:{objectName:"ParamTheadMoveReplace",object:t}})}}catch(t){this.onReceiveMsg({ev_type:"error",event:null,data:{objectName:"theadMoveReplace",object:t}})}},e.prototype.addSum=function(t,e){var n={tbodyConfig:{container:{cell:{displayClass:{normal:{displayType:"text"},dbclick:{displayType:"text"}}}}},id:"sum_"+q(),canSum:!0},i={sourceContainerData:{cell:{value:"合计"}}};V(i.sourceContainerData,t,"union"),e&&V(i,e,"union");var o=this.$selectBoxEntity.currentCotanier;if(o&&/^top$|^left$/.test(o.type)){var r={type:o.type,targetParentPosition:z(o.theadPosition),sourceContainerData:i.sourceContainerData};V(i,r,"union")}V(i.sourceContainerData,n,"union"),this.theadAdd(i),this.subjectSend({ev_type:"beforeRender",render:!0,event:null,data:{objectName:"addSum",object:null}})},e.prototype.delOneRowCol=function(t,e){var n=this,i=this.$selectBoxEntity.currentCotanier;e=e||i;var o,r=function(t){var e=n.getEntity(t.type),i=e.getContainerByTheadPosition(z(t.theadPosition));n.theadDelete({type:t.type,targetContainerPosition:t.theadPosition,withChildren:!0}),0!==i.children.length||i.isRootParent||r(i)},a="row"===t?"left":"top";if("tbody"===e.type){var s=this.getContainer(e.position),l="left"===a?s.position.rowNum:s.position.colNum,c=this.getEntity(a+"-index"),h=c.getContainerByTheadPosition([l]);o=h.$theadContainer,o||this.theadDelete({type:a+"-index",targetContainerPosition:h.theadPosition})}else{o=e;var d=e.position,u=this.$positionManager.getColObj(d);for(var p in u)u.hasOwnProperty(p);var f=o.getTopIndexContainer(o.position),y=o.getLeftIndexContainer(o.position);f&&"col"===t&&this.theadDelete({type:"top-index",targetContainerPosition:f.theadPosition}),y&&"row"===t&&this.theadDelete({type:"left-index",targetContainerPosition:y.theadPosition})}o&&r(o),this.subjectSend({ev_type:"delOneRowCol",event:null,render:!0,data:{objectName:"delOneRowCol",object:null}})},e.prototype.getTbodyData=function(t,e){t=t||"arrayObjectData",e=e||"content";var n=this.tbodyEntity.output(e)[t];return n},e.prototype.render=function(){this.$positionManager.hideContainerMap.clear(),this.resizeTable(),this.indexTheadRender();var t=this.theadTopEntity.side2,e=this.theadLeftEntity.side2;if(this.theadTopEntity){var n=k(this.position);n.colNum=e,n.rowNum=0,this.$tableHeadTop=this.theadTopEntity.convert2TheadTopList(n)}if(this.theadLeftEntity){var i=k(this.position);i.colNum=0,i.rowNum=t,this.$tableHeadLeft=this.theadLeftEntity.convert2TheadLeftList(i)}var o=new st({value:this.id,$parent:this.tableHeadTopLeft});this.tableHeadTopLeft.widthSelfNum=this.theadLeftEntity.widthNum,this.tableHeadTopLeft.heightSelfNum=this.theadTopEntity.heightNum,this.tableHeadTopLeft.resize(),this.tableHeadTopLeft.setCell(o),o.render(),t>0&&e>0&&(this.$positionManager.setPositionMap(this.tableHeadTopLeft.position,this.tableHeadTopLeft,"source"),this.$positionManager.setPositionMap(this.tableHeadTopLeft.position,this.tableHeadTopLeft,"clone")),this.renderTBody(),this.$selectBoxEntity.clear(),this.saveLastPositionMap(this.position)},e.prototype.clone=function(){var e={};try{e=t.prototype.clone.call(this,/\$/,/userData/)}catch(t){console.error("clone 中出现出错"),console.error(t)}return e},e.prototype.addParent=function(t){var e,n=this,i=this.$selectBoxEntity.selectList;if(this.onReceiveMsg({ev_type:"addParent",event:null,data:{objectName:"selectContainer",object:i}}),this.$selectBoxEntity.size>0){e=i[0];var o=this.isSameParent(i);if(o&&e){var r=this.getEntity(e.type);if(null===r)return;var a=new Array;this.$selectBoxEntity.forEach(function(t){a.push(n.getContainer(t.position))}),a.sort(function(t,e){return H(e.theadPosition)-H(t.theadPosition)}),e=H(a);var s=z(e.theadPosition,1);t=t||{cell:{value:"新建合计",data:""}};var l=r.createContain(t);a.forEach(function(t){l.addChild(t,0),n.theadDelete({type:e.type,targetContainerPosition:t.theadPosition,withChildren:!0})}),this.theadAdd({type:e.type,targetParentPosition:s,insertIndex:H(e.theadPosition),sourceContainerData:l}),this.subjectSend({ev_type:"beforeRender",render:!0,event:null,data:{objectName:"addParent",object:this}})}}this.$selectBoxEntity.clear()},e.prototype.getTheadLeavesList1=function(t){var e=null;try{var n=this.getEntity(t);n.resize(),e=n.$leafIndexList}catch(t){console.error("获取错误")}return e},e.prototype.merge=function(){var t=this;if(this.canMerge()){var e=window.confirm("合并单元格时只保留左上单元格，删除其他单元格，确定合并？");if(!0!==e)return;this.$selectBoxEntity.selectList.sort(function(t,e){return H(e.theadPosition)-H(t.theadPosition)}),this.$selectBoxEntity.selectList.forEach(function(e,n){n<t.$selectBoxEntity.selectList.length-1&&t.theadDelete({targetContainerPosition:e.theadPosition,type:e.type})}),this.subjectSend({ev_type:"beforeRender",render:!0,event:null,data:{objectName:"merge",object:this}})}},e.prototype.disMerge=function(){},e.prototype.canMerge=function(){var t=this.$selectBoxEntity.selectList,e=this.isSameParent(t);return e},e.prototype.renderTBody=function(){this.tbodyEntity.topIndexList=this.$colNumber.slice(0+this.theadLeftEntity.side2,this.$colNumber.length),this.tbodyEntity.leftIndexList=this.$rowNumber.slice(0+this.theadTopEntity.side2,this.$rowNumber.length),this.tbodyEntity.render(),this.$tableBody=this.tbodyEntity.convert()},e.prototype.resizeTable=function(){var t,e,n=this;this.theadTopEntity.resize(),this.theadLeftEntity.resize(),this.theadTopIndexEntity.resize(),this.theadLeftIndexEntity.resize();var i=this.theadTopEntity.side1,o=this.theadTopEntity.side2,r=this.theadLeftEntity.side1,a=this.theadLeftEntity.side2,s=this.theadTopIndexEntity.side1,l=this.theadLeftIndexEntity.side1,c=function(){i>0?(n.theadTopIndexEntity.deletChild(a,s,!0),n.theadTopIndexEntity.resize(),s=n.theadTopIndexEntity.side1,n.theadTopEntity.$leafIndexList.forEach(function(t,e){var i=e+a,o=n.theadTopIndexEntity.createContain(),r=n.theadTopEntity.getContainerByTheadPosition(t.theadPosition);o.update(t),r.$IndexContainer=o,i+1>s?n.theadTopIndexEntity.addChild(o):n.theadTopIndexEntity.replaceChild(o,i)})):n.theadTopIndexEntity.children.forEach(function(t,e){if(e+1<=a){var i=n.theadLeftEntity.$leafIndexList2[e],o=n.theadTopIndexEntity.createContain();o.update(i),/tbody/.test(t.renderId)?n.theadTopIndexEntity.addChild(o,e):n.theadTopIndexEntity.replaceChild(o,e)}else e+1>a&&!/tbody/.test(t.renderId)&&n.theadTopIndexEntity.deletChild(e,1,!0)})},h=function(){r>0?(n.theadLeftIndexEntity.deletChild(o,l,!0),n.theadLeftIndexEntity.resize(),l=n.theadLeftIndexEntity.side1,n.theadLeftEntity.$leafIndexList.forEach(function(t,e){var i=e+o,r=n.theadLeftIndexEntity.createContain(),a=n.theadLeftEntity.getContainerByTheadPosition(t.theadPosition);a.$IndexContainer=r,r.update(t),i+1>l?n.theadLeftIndexEntity.addChild(r):n.theadLeftIndexEntity.replaceChild(r,i)})):n.theadLeftIndexEntity.children.forEach(function(t,e){if(e+1<=o){var i=n.theadTopEntity.$leafIndexList2[e],r=n.theadLeftIndexEntity.createContain();r.update(i),/tbody/.test(t.renderId)?n.theadLeftIndexEntity.addChild(r,e):n.theadLeftIndexEntity.replaceChild(r,e)}else e+1>o&&!/tbody/.test(t.renderId)&&n.theadLeftIndexEntity.deletChild(e,1,!0)})};if(s<=i+a){if(t=i+a,t){for(var d=0;d<a;d++){var u=this.theadTopIndexEntity.getContainerByTheadPosition([d]),p=this.theadLeftEntity.$leafIndexList2[d],f=this.theadTopIndexEntity.createContain();f.update(p),d+1>s||/tbody/.test(u.renderId)?this.theadTopIndexEntity.addChild(f,d):this.theadTopIndexEntity.replaceChild(f,d)}c()}}else t=s,c();if(this.theadLeftIndexEntity.render(),l=this.theadLeftIndexEntity.side1,l<=r+o){if(e=r+o,e){for(var y=0;y<o;y++){var b=this.theadLeftIndexEntity.getContainerByTheadPosition([y]);p=this.theadTopEntity.$leafIndexList2[y],f=this.theadLeftIndexEntity.createContain();f.update(p),y+1>l||/tbody/.test(b.renderId)?this.theadLeftIndexEntity.addChild(f,y):this.theadLeftIndexEntity.replaceChild(f,y)}h()}}else e=l,h()},e.prototype.dropHandle=function(t){var e=this;if(t){var n=[],i=null,o=t.target.withChildren,r=t.source.withChildren,a=t.target.containerData,s=t.source.containerData,l=t.operationType;if(void 0===r&&s.children&&0!==s.children.length){var c=window.confirm("整组移动？");r=!0===c}var h=function(){if(/replace/.test(l));else if(a.cell&&a.cell.value){var t=window.confirm("该单元格已有数据,替换请按确定，放弃请按取消");if(!0!==t)return!1;l+="-replace"}else l+="-replace";if(void 0===o&&a.children&&a.children.length>0){t=window.confirm("是否删除该单元格的子节点");if(!0!==t)return;o=!0}n=z(a.theadPosition,1),i=H(a.theadPosition)},d=function(){var t=k(a.theadPosition),o=e.getContainer(s.position,"source");n=z(a.theadPosition,1),i=H(a.theadPosition);var c=z(a.theadPosition,1),h=H(a.theadPosition);e.processThead({operationType:l,param:{type:a.type,targetParentPosition:c,insertIndex:h,withChildren:r,sourceContainerData:s}}),e.getEntity(a.type).resize();var d=o?o.theadPosition:t;if(r){var u=s;if(u){var p=(u.children||[]).length>0;while(p)u=u.children[0],p=(u.children||[]).length>0,d.push(0)}}l="move",n=d,s=a,i=0,r=!0};if(/top/.test(a.type))switch(t.targetBearing){case"left":n=z(a.theadPosition,1),i=H(a.theadPosition);break;case"right":n=z(a.theadPosition,1),i=H(a.theadPosition)+1;break;case"top":d();break;case"bottom":n=a.theadPosition,i=null;break;case"inner":var u=h();if(!1===u)return;break;default:a=this.theadTopEntity,n=a.theadPosition,i=null;break}else if(/left/.test(a.type))switch(t.targetBearing){case"top":n=z(a.theadPosition,1),i=H(a.theadPosition);break;case"bottom":n=z(a.theadPosition,1),i=H(a.theadPosition)+1;break;case"left":d();break;case"right":n=a.theadPosition,i=null;break;case"inner":u=h();if(!1===u)return;break;default:a=this.theadLeftEntity,n=a.theadPosition,i=null;break}this.processThead({operationType:l,param:{type:a.type,insertIndex:i,withChildren:r,targetWithChildren:o,targetParentPosition:n,sourceContainerData:s,targetContainerPosition:a.theadPosition}}),this.onReceiveMsg({ev_type:"beforeRender",event:null,render:!0,data:{objectName:"BaseTable",object:this}})}},e.prototype.mutiPaste=function(t){},e.prototype.isSameParent=function(t){var e,n=!0;return t.forEach(function(t){e?e.type!==t.type?n=!1:JSON.stringify(z(t.theadPosition,1))!==JSON.stringify(z(e.theadPosition,1))&&(n=!1):e=t}),n},e.prototype.indexTheadRender=function(){this.theadLeftIndexEntity.render(),this.theadTopIndexEntity.render(),this.$colNumber=this.theadTopIndexEntity.convert(),this.$rowNumber=this.theadLeftIndexEntity.convert()},e.prototype.onReceiveMsg=function(t){var e=this.subjectSend(t);if(/cancel/.test(e.join("-")))return e;switch(!this.$parent&&t.render&&this.render(),t.ev_type){case"drop":this.dropHandle(t.data.object);break;case"click":this.afterContainerClick(t.event,t.data.object);break;case"rightClick":this.afterContainerRClick(t.event,t.data.object);break;default:}return e},e.prototype.processThead=function(t){var e=t.param;switch(t.operationType){case"add":this.theadAdd(e,!1);break;case"move":this.theadMove(e,!1);break;case"add-replace":this.theadAddReplace(e,!1);break;case"move-replace":this.theadMoveReplace(e,!1);break;case"delete":this.theadDelete(e,!1);break;default:}},e.prototype.afterContainerClick=function(t,e){var n=t.currentTarget,i=this.$selectBoxEntity.createSelectContainer(n,e);this.$keyDownSet.has("Control")||this.$selectBoxEntity.clear(),this.$selectBoxEntity.add(i);var o=this.$positionManager.$editContainer;if(o&&o.cell&&o.cell.formula.canClickAdd&&o.id!==e.id){var r=o.cell.formula.tmpValue,a=r.split(""),s="";this.$positionManager.$editContainer.position.table!==this.position.table&&(s=e.position.table+"!"),s+=e.position.colStr+e.position.rowStr,a.splice(o.cell.selectionStart,0,s);var l=document.activeElement;o.cell.value=a.join(""),l.value=a.join(""),l.selectionStart=o.cell.selectionStart+s.length,l.selectionEnd=o.cell.selectionStart+s.length}focus()},e.prototype.afterContainerRClick=function(t,e){var n=t.currentTarget,i=this.$selectBoxEntity.createSelectContainer(n,e);this.$selectBoxEntity.has(i)||(this.$selectBoxEntity.clear(),this.$selectBoxEntity.add(i)),focus()},e.prototype.initSubject=function(t){t=t||this,t.theadTopEntity&&t.theadTopEntity.$subject.subscribe(t.onReceiveMsg,t),t.theadLeftEntity&&t.theadLeftEntity.$subject.subscribe(t.onReceiveMsg,t),t.tbodyEntity&&t.tbodyEntity.$subject.subscribe(t.onReceiveMsg,t),t.theadTopIndexEntity.$subject.subscribe(t.onReceiveMsg,t),t.theadLeftIndexEntity.$subject.subscribe(t.onReceiveMsg,t)},e.prototype.initAfterSetData=function(){this.position.table=this.id;var t={table:this.position.table,colStr:"A",rowStr:1};this.tableHeadTopLeft.position=t;var e={mainTable:{position:"relative",float:"left",overflowX:this.isOverflowX?"auto":"visible",overflowY:this.isOverflowY?"auto":"visible",maxWidth:this.isOverflowX?this.maxWidth:"auto",maxHeight:this.isOverflowY?this.maxHeight:"auto"},leftTable:{position:"absolute",overflowX:this.isOverflowX?"hidden":"visible",overflowY:this.isOverflowY?"hidden":"visible",maxHeight:this.isOverflowY?"calc("+this.maxHeight+" - "+this.scrollBarHeight+")":"auto"},topTable:{overflowX:this.isOverflowX?"hidden":"visible",overflowY:this.isOverflowY?"hidden":"visible",maxWidth:this.isOverflowX?"calc("+this.maxWidth+" - "+this.scrollBarWidth+")":"auto"}};V(this.style,e,"union")},e}($t),Nt=a.a.component("MyTable",{components:{TopLeftFixTable:m,TopFixTable:p,LeftFixTable:N,SelectBox:I},props:{inputTable:Object},data:function(){return{myTable:this.inputTable||new xt({id:"test"})}},watch:{inputTable:function(t,e){this.myTable=t||e}},created:function(){console.log(this.myTable.id)}}),St=Nt,Pt=(n("24c9"),d(St,i,o,!1,null,"5f04bc67",null));Pt.options.__file="TableCom.vue";var Et=Pt.exports,_t=function(){function t(t,e){this.id=null,this.$subject=new ct,this.$config={},this.version="0.2.6",this.tableList=[],this.tableMap=new Map,this.id=t,this.$config=at.getInstance(t),this.setConfig(e),this.$positionManager=lt.getInstance(t)}return t.prototype.addTable=function(t){return this.tableMap.has(t.id)&&(this.deleteTable(t.id),console.log("重复表格id:"+t.id)),t.$groupId=this.id,this.tableMap.set(t.id,t),t.$parent=this,this.currentTable=t,this.resize(),t.$subject.subscribe(this.ontableChange,this),t.position},t.prototype.createTable=function(t){var e=j(t);e.$groupId=this.id,V(e,this.$config.table);var n=new xt(e);return n},t.prototype.deleteTable=function(t){try{this.tableMap.delete(t),this.$positionManager.clearPositionMapById(t)}catch(t){console.error(t)}this.resize()},t.prototype.setConfig=function(t){try{t&&V(this.$config,t,"union")}catch(t){console.error("initDefaultConfig error")}},t.prototype.render=function(){this.tableList.forEach(function(t){t.render()})},t.prototype.serialize=function(){var t=new Array;return this.tableList.forEach(function(e,n){t.push(e.clone())}),t},t.prototype.deserialize=function(t){var e=this;t.forEach(function(t,n){var i=e.createTable(t);e.addTable(i)})},t.prototype.getContainer=function(t,e){return this.$positionManager.getContainer(t,e)},t.prototype.getTopIndexContainer=function(t,e){return this.$positionManager.getTopIndexContainer(t,e)},t.prototype.getLeftIndexContainer=function(t,e){return this.$positionManager.getLeftIndexContainer(t,e)},t.prototype.getRowObj=function(t,e){return this.$positionManager.getRowObj(t,e)},t.prototype.getColObj=function(t,e){return this.$positionManager.getColObj(t,e)},t.prototype.saveLastPositionMap=function(t){return this.$positionManager.saveLastPositionMap(t)},t.prototype.ontableChange=function(t){return t.render&&this.render(),this.$subject.sendMsg(t)},t.prototype.resize=function(){var t=this;this.tableList=[],this.tableMap.forEach(function(e,n){t.tableList.push(e)})},t}();n.d(e,"TableCom",function(){return Et}),n.d(e,"DragTable",function(){return _t})}})});
//# sourceMappingURL=drag-table.umd.min.js.map